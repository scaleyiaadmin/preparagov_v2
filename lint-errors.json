[{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\CronogramaLicitacoes\\CronogramaItemsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[743,746],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[743,746],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2473,2476],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2473,2476],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\nimport { formatCurrency, getPriorityColor, formatDate } from '../../utils/pcaConsolidation';\r\nimport { Building2, Package, FileText } from 'lucide-react';\r\nimport DFDPreviewModal from './DFDPreviewModal';\r\n\r\ninterface CronogramaItemsModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  licitacao: any;\r\n}\r\n\r\nconst CronogramaItemsModal = ({ isOpen, onClose, licitacao }: CronogramaItemsModalProps) => {\r\n  const [showDFDPreview, setShowDFDPreview] = useState(false);\r\n  const [selectedDFDId, setSelectedDFDId] = useState<string>('');\r\n\r\n  console.log('Dados da licita√ß√£o:', licitacao);\r\n\r\n  const handleDFDClick = (dfdId: string) => {\r\n    setSelectedDFDId(dfdId);\r\n    setShowDFDPreview(true);\r\n  };\r\n\r\n  // Garantir que itensConsolidados sempre seja um array v√°lido - SEMPRE executar o hook\r\n  const itensConsolidados = React.useMemo(() => {\r\n    if (!licitacao || !licitacao.itensConsolidados || !Array.isArray(licitacao.itensConsolidados)) {\r\n      console.log('Criando itens consolidados a partir dos dados dispon√≠veis');\r\n      // Fallback: criar a partir dos dados b√°sicos da licita√ß√£o se dispon√≠vel\r\n      if (licitacao) {\r\n        return [{\r\n          descricao: `Item consolidado - ${licitacao.tipoDFD || 'Tipo n√£o informado'}`,\r\n          unidadeMedida: licitacao.unidadeMedida || 'Unidade',\r\n          quantidadeTotal: licitacao.quantidadeTotal || 0,\r\n          valorTotal: typeof licitacao.valorTotal === 'string' \r\n            ? parseFloat(licitacao.valorTotal.replace(/[^\\d,]/g, '').replace(',', '.')) || 0\r\n            : licitacao.valorTotal || 0\r\n        }];\r\n      }\r\n      return [];\r\n    }\r\n    \r\n    return licitacao.itensConsolidados;\r\n  }, [licitacao]);\r\n\r\n  // Mapear DFDs para suas respectivas secretarias - SEMPRE executar o hook\r\n  const dfdSecretariaMap = React.useMemo(() => {\r\n    const map = new Map();\r\n    \r\n    if (licitacao && licitacao.secretariasData && typeof licitacao.secretariasData === 'object') {\r\n      Object.entries(licitacao.secretariasData).forEach(([secretaria, dados]: [string, any]) => {\r\n        if (dados && dados.dfdId) {\r\n          map.set(dados.dfdId, secretaria);\r\n        }\r\n      });\r\n    }\r\n    \r\n    // Fallback: mapear usando arrays paralelos\r\n    if (licitacao && licitacao.dfdIds && licitacao.secretariasNomes) {\r\n      licitacao.dfdIds.forEach((dfdId: string, index: number) => {\r\n        if (!map.has(dfdId)) {\r\n          map.set(dfdId, licitacao.secretariasNomes[index] || 'Secretaria n√£o identificada');\r\n        }\r\n      });\r\n    }\r\n    \r\n    return map;\r\n  }, [licitacao]);\r\n\r\n  // Renderiza√ß√£o condicional AP√ìS todos os hooks\r\n  if (!licitacao) {\r\n    return (\r\n      <Dialog open={isOpen} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center\">\r\n              <Package size={20} className=\"mr-2\" />\r\n              Detalhes da Licita√ß√£o\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"text-center py-8\">\r\n            <Package size={48} className=\"mx-auto text-gray-400 mb-4\" />\r\n            <p className=\"text-gray-500\">Nenhuma licita√ß√£o selecionada</p>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <TooltipProvider>\r\n      <Dialog open={isOpen} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center\">\r\n              <Package size={20} className=\"mr-2\" />\r\n              Detalhes da Licita√ß√£o: {licitacao.tipoDFD || 'Tipo n√£o informado'}\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-6\">\r\n            {/* Bloco Superior - Informa√ß√µes Gerais */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg\">\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-700\">Tipo de DFD</label>\r\n                <p className=\"text-sm text-gray-900 font-medium\">{licitacao.tipoDFD || 'N√£o informado'}</p>\r\n              </div>\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-700\">Prioridade</label>\r\n                <div className=\"mt-1\">\r\n                  <Badge className={getPriorityColor(licitacao.prioridade || 'M√©dia')}>\r\n                    {licitacao.prioridade || 'N√£o informada'}\r\n                  </Badge>\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-700\">Data de Contrata√ß√£o</label>\r\n                <p className=\"text-sm text-gray-900\">{formatDate(licitacao.dataContratacao)}</p>\r\n              </div>\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-700\">Data Sugerida de Abertura</label>\r\n                <p className=\"text-sm text-gray-900\">{formatDate(licitacao.dataSugeridaAbertura)}</p>\r\n              </div>\r\n              <div className=\"md:col-span-2\">\r\n                <label className=\"text-sm font-medium text-gray-700\">Valor Total da Licita√ß√£o</label>\r\n                <p className=\"text-lg text-gray-900 font-bold\">{licitacao.valorTotal || 'R$ 0,00'}</p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Secretarias Envolvidas */}\r\n            <div>\r\n              <h3 className=\"text-lg font-medium text-gray-900 mb-3 flex items-center\">\r\n                <Building2 size={18} className=\"mr-2\" />\r\n                Secretarias Envolvidas ({licitacao.secretariasNomes?.length || 0})\r\n              </h3>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n                {licitacao.secretariasNomes?.map((secretaria: string, index: number) => (\r\n                  <div key={secretaria} className=\"flex items-center space-x-3 p-3 bg-blue-50 rounded-lg\">\r\n                    <Badge variant=\"outline\" className=\"font-mono font-bold\">\r\n                      {licitacao.secretariasSiglas?.[index] || 'N/A'}\r\n                    </Badge>\r\n                    <span className=\"text-sm text-gray-700 flex-1\">{secretaria}</span>\r\n                  </div>\r\n                )) || (\r\n                  <div className=\"col-span-full\">\r\n                    <p className=\"text-gray-500 text-sm\">Nenhuma secretaria encontrada</p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            {/* DFDs Envolvidos */}\r\n            {licitacao.dfdIds && licitacao.dfdIds.length > 0 && (\r\n              <div>\r\n                <h3 className=\"text-lg font-medium text-gray-900 mb-3 flex items-center\">\r\n                  <FileText size={18} className=\"mr-2\" />\r\n                  DFDs Envolvidos ({licitacao.dfdIds.length})\r\n                </h3>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {licitacao.dfdIds.map((dfdId: string, index: number) => (\r\n                    <Tooltip key={index}>\r\n                      <TooltipTrigger asChild>\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleDFDClick(dfdId)}\r\n                          className=\"text-blue-600 hover:bg-blue-50\"\r\n                        >\r\n                          {dfdId}\r\n                        </Button>\r\n                      </TooltipTrigger>\r\n                      <TooltipContent>\r\n                        <p>{dfdSecretariaMap.get(dfdId) || 'Secretaria n√£o identificada'}</p>\r\n                      </TooltipContent>\r\n                    </Tooltip>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            {/* Tabela de Itens Consolidados */}\r\n            <div>\r\n              <h3 className=\"text-lg font-medium text-gray-900 mb-3\">\r\n                Itens Consolidados ({itensConsolidados.length})\r\n              </h3>\r\n              {itensConsolidados.length === 0 ? (\r\n                <div className=\"text-center py-8\">\r\n                  <Package size={48} className=\"mx-auto text-gray-400 mb-4\" />\r\n                  <p className=\"text-gray-500\">Nenhum item consolidado encontrado</p>\r\n                </div>\r\n              ) : (\r\n                <div className=\"overflow-x-auto\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Item</TableHead>\r\n                        <TableHead>Unidade</TableHead>\r\n                        <TableHead className=\"text-right\">Quantidade Total</TableHead>\r\n                        <TableHead className=\"text-right\">Valor Total</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {itensConsolidados.map((item, index) => (\r\n                        <TableRow key={index}>\r\n                          <TableCell>\r\n                            <div>\r\n                              <p className=\"font-medium\">{item.descricao || 'Descri√ß√£o n√£o informada'}</p>\r\n                              {item.detalhamentoTecnico && (\r\n                                <p className=\"text-sm text-gray-500\">{item.detalhamentoTecnico}</p>\r\n                              )}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <Badge variant=\"outline\" className=\"font-mono\">\r\n                              {item.unidadeMedida || 'N/A'}\r\n                            </Badge>\r\n                          </TableCell>\r\n                          <TableCell className=\"text-right font-medium\">\r\n                            {item.quantidadeTotal || 0}\r\n                          </TableCell>\r\n                          <TableCell className=\"text-right font-medium\">\r\n                            {formatCurrency(item.valorTotal || 0)}\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Resumo Final */}\r\n            <div className=\"p-4 bg-orange-50 rounded-lg border border-orange-200\">\r\n              <h4 className=\"font-medium text-orange-900 mb-2\">Resumo da Licita√ß√£o</h4>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\r\n                <div>\r\n                  <span className=\"text-orange-700\">Total de Secretarias:</span>\r\n                  <span className=\"ml-2 font-medium\">{licitacao.secretariasNomes?.length || 0}</span>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-orange-700\">Total de DFDs:</span>\r\n                  <span className=\"ml-2 font-medium\">{licitacao.dfdIds?.length || 0}</span>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-orange-700\">Total de Itens:</span>\r\n                  <span className=\"ml-2 font-medium\">{itensConsolidados.length}</span>\r\n                </div>\r\n                <div className=\"md:col-span-3\">\r\n                  <span className=\"text-orange-700\">Valor Total:</span>\r\n                  <span className=\"ml-2 font-medium text-lg\">{licitacao.valorTotal || 'R$ 0,00'}</span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* DFD Preview Modal */}\r\n      <DFDPreviewModal\r\n        isOpen={showDFDPreview}\r\n        onClose={() => setShowDFDPreview(false)}\r\n        dfdId={selectedDFDId}\r\n      />\r\n    </TooltipProvider>\r\n  );\r\n};\r\n\r\nexport default CronogramaItemsModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\DFD\\AISuggestionsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1196,1199],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1196,1199],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":216,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":216,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6525,6528],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6525,6528],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Sparkles, CheckCircle2, Edit, X } from 'lucide-react';\r\n\r\ninterface DFDItem {\r\n  id: string;\r\n  codigo: string;\r\n  descricao: string;\r\n  unidade: string;\r\n  quantidade: number;\r\n  valorReferencia: number;\r\n  tabelaReferencia: string;\r\n}\r\n\r\ninterface AISuggestionsModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  objeto: string;\r\n  onAddItems: (items: DFDItem[]) => void;\r\n}\r\n\r\nconst AISuggestionsModal = ({ open, onClose, objeto, onAddItems }: AISuggestionsModalProps) => {\r\n  const [selectedItems, setSelectedItems] = useState<string[]>([]);\r\n  const [editingQuantity, setEditingQuantity] = useState<string | null>(null);\r\n  const [tempQuantities, setTempQuantities] = useState<Record<string, number>>({});\r\n\r\n  // Mock de itens sugeridos pela IA baseado no objeto\r\n  const getSuggestedItems = () => {\r\n    const suggestions: Record<string, any[]> = {\r\n      'Aquisi√ß√£o de G√™neros Aliment√≠cios': [\r\n        {\r\n          codigo: 'BRP001',\r\n          descricao: 'Arroz branco polido tipo 1, pacote 5kg',\r\n          unidade: 'kg',\r\n          quantidade: 500,\r\n          valorReferencia: 4.50,\r\n          tabelaReferencia: 'BPS'\r\n        },\r\n        {\r\n          codigo: 'BRP002',\r\n          descricao: 'Feij√£o carioca tipo 1, pacote 1kg',\r\n          unidade: 'kg',\r\n          quantidade: 200,\r\n          valorReferencia: 7.20,\r\n          tabelaReferencia: 'BPS'\r\n        },\r\n        {\r\n          codigo: 'BRP003',\r\n          descricao: '√ìleo de soja refinado, garrafa 900ml',\r\n          unidade: 'litro',\r\n          quantidade: 50,\r\n          valorReferencia: 5.80,\r\n          tabelaReferencia: 'BPS'\r\n        },\r\n        {\r\n          codigo: 'CES001',\r\n          descricao: 'Banana prata primeira qualidade',\r\n          unidade: 'kg',\r\n          quantidade: 300,\r\n          valorReferencia: 3.50,\r\n          tabelaReferencia: 'CEASA'\r\n        },\r\n        {\r\n          codigo: 'CES002',\r\n          descricao: 'Tomate salada primeira qualidade',\r\n          unidade: 'kg',\r\n          quantidade: 100,\r\n          valorReferencia: 6.80,\r\n          tabelaReferencia: 'CEASA'\r\n        }\r\n      ],\r\n      'Aquisi√ß√£o de Material de Limpeza': [\r\n        {\r\n          codigo: 'PNC001',\r\n          descricao: 'Desinfetante uso geral, frasco 1 litro',\r\n          unidade: 'litro',\r\n          quantidade: 100,\r\n          valorReferencia: 8.50,\r\n          tabelaReferencia: 'PNCP'\r\n        },\r\n        {\r\n          codigo: 'PNC002',\r\n          descricao: 'Detergente neutro concentrado, frasco 500ml',\r\n          unidade: 'unidade',\r\n          quantidade: 200,\r\n          valorReferencia: 3.20,\r\n          tabelaReferencia: 'PNCP'\r\n        },\r\n        {\r\n          codigo: 'PNC003',\r\n          descricao: 'Papel higi√™nico folha dupla, pacote c/ 4 rolos',\r\n          unidade: 'pacote',\r\n          quantidade: 150,\r\n          valorReferencia: 12.50,\r\n          tabelaReferencia: 'PNCP'\r\n        },\r\n        {\r\n          codigo: 'PNC004',\r\n          descricao: 'Saco para lixo 100 litros, pacote c/ 50 unidades',\r\n          unidade: 'pacote',\r\n          quantidade: 80,\r\n          valorReferencia: 25.00,\r\n          tabelaReferencia: 'PNCP'\r\n        }\r\n      ],\r\n      'Aquisi√ß√£o de Medicamentos': [\r\n        {\r\n          codigo: 'MED001',\r\n          descricao: 'Paracetamol 500mg, comprimido',\r\n          unidade: 'comprimido',\r\n          quantidade: 5000,\r\n          valorReferencia: 0.15,\r\n          tabelaReferencia: 'CMED'\r\n        },\r\n        {\r\n          codigo: 'MED002',\r\n          descricao: 'Ibuprofeno 600mg, comprimido',\r\n          unidade: 'comprimido',\r\n          quantidade: 2000,\r\n          valorReferencia: 0.35,\r\n          tabelaReferencia: 'CMED'\r\n        },\r\n        {\r\n          codigo: 'MED003',\r\n          descricao: 'Dipirona s√≥dica 500mg, comprimido',\r\n          unidade: 'comprimido',\r\n          quantidade: 3000,\r\n          valorReferencia: 0.12,\r\n          tabelaReferencia: 'CMED'\r\n        },\r\n        {\r\n          codigo: 'MED004',\r\n          descricao: 'Omeprazol 20mg, c√°psula',\r\n          unidade: 'c√°psula',\r\n          quantidade: 1500,\r\n          valorReferencia: 0.25,\r\n          tabelaReferencia: 'CMED'\r\n        }\r\n      ],\r\n      'Aquisi√ß√£o de Material Hospitalar': [\r\n        {\r\n          codigo: 'SIG001',\r\n          descricao: 'Seringa descart√°vel 10ml com agulha',\r\n          unidade: 'unidade',\r\n          quantidade: 1000,\r\n          valorReferencia: 0.85,\r\n          tabelaReferencia: 'SIGTAP'\r\n        },\r\n        {\r\n          codigo: 'SIG002',\r\n          descricao: 'Luva de procedimento n√£o cir√∫rgico, par',\r\n          unidade: 'par',\r\n          quantidade: 2000,\r\n          valorReferencia: 0.45,\r\n          tabelaReferencia: 'SIGTAP'\r\n        },\r\n        {\r\n          codigo: 'SIG003',\r\n          descricao: 'Gaze est√©ril 7,5x7,5cm, pacote c/ 10 unidades',\r\n          unidade: 'pacote',\r\n          quantidade: 500,\r\n          valorReferencia: 3.20,\r\n          tabelaReferencia: 'SIGTAP'\r\n        },\r\n        {\r\n          codigo: 'PNC005',\r\n          descricao: '√Ålcool gel 70% antiss√©ptico, frasco 500ml',\r\n          unidade: 'frasco',\r\n          quantidade: 200,\r\n          valorReferencia: 8.50,\r\n          tabelaReferencia: 'PNCP'\r\n        }\r\n      ]\r\n    };\r\n\r\n    return suggestions[objeto] || [];\r\n  };\r\n\r\n  const suggestedItems = getSuggestedItems();\r\n\r\n  const handleItemToggle = (itemCodigo: string) => {\r\n    setSelectedItems(prev => \r\n      prev.includes(itemCodigo) \r\n        ? prev.filter(id => id !== itemCodigo)\r\n        : [...prev, itemCodigo]\r\n    );\r\n  };\r\n\r\n  const handleSelectAll = () => {\r\n    if (selectedItems.length === suggestedItems.length) {\r\n      setSelectedItems([]);\r\n    } else {\r\n      setSelectedItems(suggestedItems.map(item => item.codigo));\r\n    }\r\n  };\r\n\r\n  const handleEditQuantity = (itemCodigo: string, currentQuantity: number) => {\r\n    setEditingQuantity(itemCodigo);\r\n    setTempQuantities(prev => ({ ...prev, [itemCodigo]: currentQuantity }));\r\n  };\r\n\r\n  const handleSaveQuantity = (itemCodigo: string) => {\r\n    setEditingQuantity(null);\r\n  };\r\n\r\n  const handleCancelEditQuantity = () => {\r\n    setEditingQuantity(null);\r\n    setTempQuantities({});\r\n  };\r\n\r\n  const getItemQuantity = (item: any) => {\r\n    return tempQuantities[item.codigo] || item.quantidade;\r\n  };\r\n\r\n  const handleAddSelected = () => {\r\n    const itemsToAdd = suggestedItems\r\n      .filter(item => selectedItems.includes(item.codigo))\r\n      .map(item => ({\r\n        ...item,\r\n        quantidade: getItemQuantity(item),\r\n        id: Date.now().toString() + Math.random()\r\n      }));\r\n    \r\n    onAddItems(itemsToAdd);\r\n    setSelectedItems([]);\r\n    setTempQuantities({});\r\n    onClose();\r\n  };\r\n\r\n  const getTotalValue = () => {\r\n    return suggestedItems\r\n      .filter(item => selectedItems.includes(item.codigo))\r\n      .reduce((total, item) => total + (getItemQuantity(item) * item.valorReferencia), 0);\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-5xl h-[90vh] flex flex-col\">\r\n        <DialogHeader className=\"flex-shrink-0\">\r\n          <DialogTitle className=\"flex items-center space-x-2\">\r\n            <Sparkles className=\"text-orange-500\" size={20} />\r\n            <span>Itens Sugeridos pela IA</span>\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        {/* Informa√ß√µes contextuais */}\r\n        <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-2 flex-shrink-0\">\r\n          <p className=\"text-sm text-blue-800\">\r\n            üìå <strong>Estes itens foram sugeridos com base no objeto selecionado:</strong> {objeto}\r\n          </p>\r\n          <p className=\"text-sm text-blue-700\">\r\n            üß† Voc√™ pode ajustar as quantidades ou recusar os itens e inserir manualmente.\r\n          </p>\r\n        </div>\r\n        \r\n        {/* Conte√∫do principal com scroll */}\r\n        <div className=\"flex-1 overflow-y-auto space-y-4\">\r\n          {/* Controles de sele√ß√£o */}\r\n          <div className=\"flex items-center justify-between p-3 bg-orange-50 rounded-lg\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Checkbox \r\n                checked={selectedItems.length === suggestedItems.length}\r\n                onCheckedChange={handleSelectAll}\r\n              />\r\n              <span className=\"font-medium\">Selecionar todos os itens</span>\r\n            </div>\r\n            <div className=\"flex items-center space-x-4\">\r\n              <span className=\"text-sm text-gray-600\">\r\n                üî¢ {selectedItems.length} itens selecionados de {suggestedItems.length}\r\n              </span>\r\n              <Badge className=\"bg-orange-100 text-orange-800\">\r\n                {suggestedItems.length} itens sugeridos\r\n              </Badge>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Lista de itens */}\r\n          <div className=\"space-y-3\">\r\n            {suggestedItems.map((item) => (\r\n              <div\r\n                key={item.codigo}\r\n                className={`border rounded-lg p-4 transition-colors ${\r\n                  selectedItems.includes(item.codigo) \r\n                    ? 'border-orange-300 bg-orange-50' \r\n                    : 'border-gray-200 hover:border-gray-300'\r\n                }`}\r\n              >\r\n                <div className=\"flex items-start space-x-3\">\r\n                  <Checkbox\r\n                    checked={selectedItems.includes(item.codigo)}\r\n                    onCheckedChange={() => handleItemToggle(item.codigo)}\r\n                  />\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"flex items-center justify-between mb-2\">\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <Badge variant=\"outline\">{item.codigo}</Badge>\r\n                        <Badge className=\"bg-blue-100 text-blue-800\">\r\n                          {item.tabelaReferencia}\r\n                        </Badge>\r\n                      </div>\r\n                      <div className=\"text-right\">\r\n                        <p className=\"font-semibold text-green-600\">\r\n                          R$ {item.valorReferencia.toFixed(2)} / {item.unidade}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <h4 className=\"font-medium text-gray-900 mb-3\">{item.descricao}</h4>\r\n                    \r\n                    {/* Se√ß√£o de quantidade edit√°vel */}\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <span className=\"text-sm text-gray-600\">Quantidade sugerida:</span>\r\n                        {editingQuantity === item.codigo ? (\r\n                          <div className=\"flex items-center space-x-2\">\r\n                            <Input\r\n                              type=\"number\"\r\n                              min=\"1\"\r\n                              value={tempQuantities[item.codigo] || item.quantidade}\r\n                              onChange={(e) => setTempQuantities(prev => ({\r\n                                ...prev,\r\n                                [item.codigo]: parseInt(e.target.value) || item.quantidade\r\n                              }))}\r\n                              className=\"w-20 h-8\"\r\n                            />\r\n                            <span className=\"text-sm text-gray-500\">{item.unidade}</span>\r\n                            <Button \r\n                              size=\"sm\" \r\n                              variant=\"ghost\"\r\n                              onClick={() => handleSaveQuantity(item.codigo)}\r\n                              className=\"h-6 w-6 p-0\"\r\n                            >\r\n                              <CheckCircle2 size={14} className=\"text-green-600\" />\r\n                            </Button>\r\n                            <Button \r\n                              size=\"sm\" \r\n                              variant=\"ghost\"\r\n                              onClick={handleCancelEditQuantity}\r\n                              className=\"h-6 w-6 p-0\"\r\n                            >\r\n                              <X size={14} className=\"text-red-600\" />\r\n                            </Button>\r\n                          </div>\r\n                        ) : (\r\n                          <div className=\"flex items-center space-x-2\">\r\n                            <span className=\"font-semibold text-orange-600\">\r\n                              {getItemQuantity(item)} {item.unidade}\r\n                            </span>\r\n                            <Button\r\n                              size=\"sm\"\r\n                              variant=\"ghost\"\r\n                              onClick={() => handleEditQuantity(item.codigo, getItemQuantity(item))}\r\n                              className=\"h-6 w-6 p-0\"\r\n                            >\r\n                              <Edit size={12} className=\"text-gray-500\" />\r\n                            </Button>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <span className=\"font-medium text-gray-900\">\r\n                        Total: R$ {(getItemQuantity(item) * item.valorReferencia).toFixed(2)}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Resumo de sele√ß√£o */}\r\n          {selectedItems.length > 0 && (\r\n            <div className=\"border-t pt-4\">\r\n              <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center space-x-2\">\r\n                    <CheckCircle2 size={20} className=\"text-green-600\" />\r\n                    <span className=\"font-medium text-green-800\">\r\n                      {selectedItems.length} itens selecionados\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-lg font-bold text-green-800\">\r\n                      Total Estimado: R$ {getTotalValue().toFixed(2)}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Bot√µes de a√ß√£o fixos */}\r\n        <div className=\"flex justify-end space-x-2 pt-4 border-t flex-shrink-0\">\r\n          <Button variant=\"outline\" onClick={onClose}>\r\n            <X size={16} className=\"mr-2\" />\r\n            Cancelar\r\n          </Button>\r\n          <Button \r\n            onClick={handleAddSelected}\r\n            disabled={selectedItems.length === 0}\r\n            className=\"bg-orange-500 hover:bg-orange-600\"\r\n          >\r\n            <CheckCircle2 size={16} className=\"mr-2\" />\r\n            Inserir {selectedItems.length} Itens Selecionados no DFD\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default AISuggestionsModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\DFD\\ActionConfirmModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":8,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":11,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[471,474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[471,474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { AlertTriangle, X, Trash2 } from 'lucide-react';\r\n\r\ninterface ActionConfirmModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  actionType: 'cancel' | 'delete' | 'remove-pca';\r\n  dfd: any;\r\n  justification: string;\r\n  onJustificationChange: (value: string) => void;\r\n  onConfirm: () => void;\r\n}\r\n\r\nconst ActionConfirmModal = ({ \r\n  open, \r\n  onClose, \r\n  actionType, \r\n  dfd, \r\n  justification, \r\n  onJustificationChange, \r\n  onConfirm \r\n}: ActionConfirmModalProps) => {\r\n  const getModalConfig = () => {\r\n    switch (actionType) {\r\n      case 'cancel':\r\n        return {\r\n          title: 'Cancelar DFD',\r\n          icon: <X size={24} className=\"text-red-500\" />,\r\n          description: 'Voc√™ est√° prestes a cancelar este DFD. Esta a√ß√£o pode ser revertida posteriormente.',\r\n          requiresJustification: true,\r\n          confirmText: 'Cancelar DFD',\r\n          confirmVariant: 'destructive' as const\r\n        };\r\n      case 'delete':\r\n        return {\r\n          title: 'Excluir DFD',\r\n          icon: <Trash2 size={24} className=\"text-red-500\" />,\r\n          description: 'Voc√™ est√° prestes a excluir permanentemente este DFD. Esta a√ß√£o n√£o pode ser desfeita.',\r\n          requiresJustification: true,\r\n          confirmText: 'Excluir Permanentemente',\r\n          confirmVariant: 'destructive' as const\r\n        };\r\n      case 'remove-pca':\r\n        return {\r\n          title: 'Solicitar Retirada do PCA',\r\n          icon: <AlertTriangle size={24} className=\"text-orange-500\" />,\r\n          description: 'Voc√™ est√° solicitando a retirada deste DFD do Programa de Contrata√ß√µes Anuais (PCA).',\r\n          requiresJustification: true,\r\n          confirmText: 'Enviar Solicita√ß√£o',\r\n          confirmVariant: 'default' as const\r\n        };\r\n      default:\r\n        return {\r\n          title: 'Confirmar A√ß√£o',\r\n          icon: <AlertTriangle size={24} className=\"text-gray-500\" />,\r\n          description: 'Confirme esta a√ß√£o.',\r\n          requiresJustification: false,\r\n          confirmText: 'Confirmar',\r\n          confirmVariant: 'default' as const\r\n        };\r\n    }\r\n  };\r\n\r\n  const config = getModalConfig();\r\n  const canConfirm = !config.requiresJustification || justification.trim().length > 0;\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onClose}>\r\n      <DialogContent className=\"sm:max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center space-x-3\">\r\n            {config.icon}\r\n            <span>{config.title}</span>\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        <div className=\"space-y-4\">\r\n          {dfd && (\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <h4 className=\"font-semibold text-gray-900 mb-1\">{dfd.objeto}</h4>\r\n              <p className=\"text-sm text-gray-600\">Tipo: {dfd.tipoDFD}</p>\r\n              <p className=\"text-sm text-gray-600\">Status: {dfd.status}</p>\r\n              <p className=\"text-sm text-gray-600\">Valor: {dfd.valor}</p>\r\n            </div>\r\n          )}\r\n          \r\n          <p className=\"text-gray-700\">{config.description}</p>\r\n          \r\n          {config.requiresJustification && (\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"justification\">\r\n                Justificativa *\r\n              </Label>\r\n              <Textarea\r\n                id=\"justification\"\r\n                value={justification}\r\n                onChange={(e) => onJustificationChange(e.target.value)}\r\n                placeholder=\"Descreva o motivo desta a√ß√£o...\"\r\n                rows={3}\r\n                className=\"resize-none\"\r\n              />\r\n              <p className=\"text-xs text-gray-500\">\r\n                A justificativa √© obrigat√≥ria e ser√° registrada no hist√≥rico do DFD.\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n        \r\n        <div className=\"flex justify-end space-x-2 pt-4\">\r\n          <Button variant=\"outline\" onClick={onClose}>\r\n            Cancelar\r\n          </Button>\r\n          <Button \r\n            variant={config.confirmVariant}\r\n            onClick={onConfirm}\r\n            disabled={!canConfirm}\r\n          >\r\n            {config.confirmText}\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ActionConfirmModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\DFD\\DFDCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[595,598],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[595,598],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\nimport { Eye, Pencil, X, Trash2, AlertTriangle } from 'lucide-react';\r\n\r\ninterface DFDCardProps {\r\n  dfd: {\r\n    id: number;\r\n    objeto: string;\r\n    tipoDFD: string;\r\n    valor: string;\r\n    status: string;\r\n    data: string;\r\n    prioridade: string;\r\n    anoContratacao: string;\r\n  };\r\n  onAction: (dfd: any, action: 'cancel' | 'delete' | 'remove-pca' | 'view' | 'edit') => void;\r\n}\r\n\r\nconst DFDCard = ({ dfd, onAction }: DFDCardProps) => {\r\n  console.log('DFDCard rendering for:', dfd.id, dfd.objeto);\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'Pendente Aprova√ß√£o':\r\n        return 'bg-orange-100 text-orange-800';\r\n      case 'Em Elabora√ß√£o':\r\n        return 'bg-blue-100 text-blue-800';\r\n      case 'Aprovado':\r\n        return 'bg-green-100 text-green-800';\r\n      case 'Cancelado':\r\n        return 'bg-red-100 text-red-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getTipoDFDColor = (tipo: string) => {\r\n    const colors: Record<string, string> = {\r\n      'MATERIAIS DE CONSUMO': 'bg-purple-100 text-purple-800',\r\n      'MATERIAIS PERMANENTES': 'bg-indigo-100 text-indigo-800',\r\n      'SERVI√áO CONTINUADO': 'bg-cyan-100 text-cyan-800',\r\n      'SERVI√áO N√ÉO CONTINUADO': 'bg-teal-100 text-teal-800',\r\n      'SERVI√áO DE ENGENHARIA': 'bg-amber-100 text-amber-800',\r\n      'TERMO ADITIVO': 'bg-pink-100 text-pink-800'\r\n    };\r\n    return colors[tipo] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  const getActionsForStatus = (status: string) => {\r\n    switch (status) {\r\n      case 'Pendente Aprova√ß√£o':\r\n        return ['view', 'edit', 'cancel'];\r\n      case 'Em Elabora√ß√£o':\r\n        return ['view', 'edit', 'delete'];\r\n      case 'Aprovado':\r\n        return ['view', 'remove-pca'];\r\n      case 'Cancelado':\r\n        return ['view', 'edit', 'delete'];\r\n      default:\r\n        return ['view'];\r\n    }\r\n  };\r\n\r\n  const actions = getActionsForStatus(dfd.status);\r\n  console.log('Available actions for DFD', dfd.id, ':', actions);\r\n\r\n  try {\r\n    return (\r\n      <TooltipProvider>\r\n        <Card className=\"hover:shadow-lg transition-shadow\">\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex-1\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">{dfd.objeto}</h3>\r\n                <div className=\"flex items-center flex-wrap gap-2 mb-2\">\r\n                  <Badge className={getTipoDFDColor(dfd.tipoDFD)}>{dfd.tipoDFD}</Badge>\r\n                  <Badge className={getStatusColor(dfd.status)}>{dfd.status}</Badge>\r\n                  <Badge variant=\"outline\">Prioridade {dfd.prioridade}</Badge>\r\n                  <span className=\"text-sm text-gray-500\">\r\n                    Criado em {new Date(dfd.data).toLocaleDateString('pt-BR')}\r\n                  </span>\r\n                </div>\r\n                <p className=\"text-gray-600\">Valor: {dfd.valor}</p>\r\n              </div>\r\n              <div className=\"flex items-center space-x-2\">\r\n                {actions.includes('view') && (\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        size=\"sm\" \r\n                        onClick={() => {\r\n                          console.log('View action clicked for DFD:', dfd.id);\r\n                          onAction(dfd, 'view');\r\n                        }}\r\n                      >\r\n                        <Eye size={16} />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p>Visualizar DFD</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                )}\r\n                {actions.includes('edit') && (\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        size=\"sm\" \r\n                        onClick={() => {\r\n                          console.log('Edit action clicked for DFD:', dfd.id);\r\n                          onAction(dfd, 'edit');\r\n                        }}\r\n                      >\r\n                        <Pencil size={16} />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p>Editar DFD</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                )}\r\n                {actions.includes('cancel') && (\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        size=\"sm\" \r\n                        onClick={() => {\r\n                          console.log('Cancel action clicked for DFD:', dfd.id);\r\n                          onAction(dfd, 'cancel');\r\n                        }}\r\n                      >\r\n                        <X size={16} />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p>Cancelar DFD</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                )}\r\n                {actions.includes('delete') && (\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        size=\"sm\" \r\n                        onClick={() => {\r\n                          console.log('Delete action clicked for DFD:', dfd.id);\r\n                          onAction(dfd, 'delete');\r\n                        }}\r\n                      >\r\n                        <Trash2 size={16} />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p>Excluir DFD</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                )}\r\n                {actions.includes('remove-pca') && (\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Button \r\n                        variant=\"ghost\" \r\n                        size=\"sm\" \r\n                        onClick={() => {\r\n                          console.log('Remove PCA action clicked for DFD:', dfd.id);\r\n                          onAction(dfd, 'remove-pca');\r\n                        }}\r\n                      >\r\n                        <AlertTriangle size={16} />\r\n                      </Button>\r\n                    </TooltipTrigger>\r\n                    <TooltipContent>\r\n                      <p>Solicitar Retirada do PCA</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </TooltipProvider>\r\n    );\r\n  } catch (error) {\r\n    console.error('Error rendering DFDCard:', error);\r\n    return (\r\n      <Card className=\"border-red-200\">\r\n        <CardContent className=\"p-6\">\r\n          <p className=\"text-red-500\">Erro ao renderizar DFD: {dfd.objeto}</p>\r\n        </CardContent>\r\n      </Card>\r\n    );\r\n  }\r\n};\r\n\r\nexport default DFDCard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\DFD\\DFDFilters.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[468,471],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[468,471],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Button } from '@/components/ui/button';\r\n\r\ninterface DFDFiltersProps {\r\n  filters: {\r\n    tipoDFD: string;\r\n    prioridade: string;\r\n    anoContratacao: string;\r\n    status: string;\r\n  };\r\n  onFilterChange: (filters: any) => void;\r\n  tipoDFDOptions: string[];\r\n  prioridadeOptions: string[];\r\n}\r\n\r\nconst DFDFilters = ({ \r\n  filters, \r\n  onFilterChange, \r\n  tipoDFDOptions, \r\n  prioridadeOptions \r\n}: DFDFiltersProps) => {\r\n  console.log('DFDFilters rendering with filters:', filters);\r\n\r\n  const statusOptions = ['Pendente Aprova√ß√£o', 'Em Elabora√ß√£o', 'Aprovado', 'Cancelado'];\r\n  const anoOptions = ['2024', '2023', '2022'];\r\n\r\n  const handleFilterChange = (key: string, value: string) => {\r\n    console.log('Filter change:', key, value);\r\n    onFilterChange({\r\n      ...filters,\r\n      [key]: value\r\n    });\r\n  };\r\n\r\n  const clearFilters = () => {\r\n    console.log('Clearing all filters');\r\n    onFilterChange({\r\n      tipoDFD: '',\r\n      prioridade: '',\r\n      anoContratacao: '',\r\n      status: ''\r\n    });\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardContent className=\"p-4\">\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 lg:grid-cols-5 gap-4 items-end\">\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"tipoDFD\">Tipo de DFD</Label>\r\n            <Select value={filters.tipoDFD} onValueChange={(value) => handleFilterChange('tipoDFD', value)}>\r\n              <SelectTrigger>\r\n                <SelectValue placeholder=\"Todos os tipos\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">Todos os tipos</SelectItem>\r\n                {tipoDFDOptions.map((tipo) => (\r\n                  <SelectItem key={tipo} value={tipo}>\r\n                    {tipo}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"prioridade\">Prioridade</Label>\r\n            <Select value={filters.prioridade} onValueChange={(value) => handleFilterChange('prioridade', value)}>\r\n              <SelectTrigger>\r\n                <SelectValue placeholder=\"Todas\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">Todas</SelectItem>\r\n                {prioridadeOptions.map((prioridade) => (\r\n                  <SelectItem key={prioridade} value={prioridade}>\r\n                    {prioridade}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"ano\">Ano de Contrata√ß√£o</Label>\r\n            <Select value={filters.anoContratacao} onValueChange={(value) => handleFilterChange('anoContratacao', value)}>\r\n              <SelectTrigger>\r\n                <SelectValue placeholder=\"Todos os anos\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">Todos os anos</SelectItem>\r\n                {anoOptions.map((ano) => (\r\n                  <SelectItem key={ano} value={ano}>\r\n                    {ano}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"status\">Status</Label>\r\n            <Select value={filters.status} onValueChange={(value) => handleFilterChange('status', value)}>\r\n              <SelectTrigger>\r\n                <SelectValue placeholder=\"Todos os status\" />\r\n              </SelectTrigger>\r\n              <SelectContent>\r\n                <SelectItem value=\"all\">Todos os status</SelectItem>\r\n                {statusOptions.map((status) => (\r\n                  <SelectItem key={status} value={status}>\r\n                    {status}\r\n                  </SelectItem>\r\n                ))}\r\n              </SelectContent>\r\n            </Select>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Button variant=\"outline\" onClick={clearFilters} className=\"w-full\">\r\n              Limpar Filtros\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default DFDFilters;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\DFD\\DFDForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":55,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1570,1573],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1570,1573],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":129,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4220,4223],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4220,4223],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":292,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16419,16422],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16419,16422],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":372,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":372,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[19467,19470],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[19467,19470],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport {\r\n  Save,\r\n  Sparkles,\r\n  Send,\r\n  ArrowLeft,\r\n  Plus,\r\n  Eye,\r\n  FileText,\r\n  Loader2,\r\n  Lightbulb,\r\n  Edit\r\n} from 'lucide-react';\r\nimport ItemSearchModal from './ItemSearchModal';\r\nimport DFDPreview from './DFDPreview';\r\nimport ItemsTable from './ItemsTable';\r\nimport AISuggestionsModal from './AISuggestionsModal';\r\nimport ItemEditModal from './ItemEditModal';\r\nimport ItemJustificationForm from './ItemJustificationForm';\r\nimport { dfdService } from '@/services/dfdService';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { DbDFDItem } from '@/types/database';\r\n\r\ninterface DFDItem {\r\n  id: string;\r\n  codigo: string;\r\n  descricao: string;\r\n  unidade: string;\r\n  quantidade: number;\r\n  valorReferencia: number;\r\n  tabelaReferencia: string;\r\n}\r\n\r\ninterface DFDFormData {\r\n  objeto: string;\r\n  tipoDFD: string;\r\n  descricaoSucinta: string;\r\n  descricaoDemanda: string;\r\n  justificativa: string;\r\n  dataPrevista: string;\r\n  prioridade: string;\r\n  justificativaPrioridade: string;\r\n  itens: DFDItem[];\r\n}\r\n\r\ninterface DFDFormProps {\r\n  onBack: () => void;\r\n  editingDFD?: any;\r\n}\r\n\r\nconst DFDForm = ({ onBack, editingDFD }: DFDFormProps) => {\r\n  const [showItemModal, setShowItemModal] = useState(false);\r\n  const [showPreview, setShowPreview] = useState(false);\r\n  const [showAISuggestions, setShowAISuggestions] = useState(false);\r\n  const [showItemEdit, setShowItemEdit] = useState(false);\r\n  const [editingItem, setEditingItem] = useState<DFDItem | null>(null);\r\n  const [loadingAI, setLoadingAI] = useState(false);\r\n  const [aiGenerated, setAiGenerated] = useState(false);\r\n  const [isEditingAI, setIsEditingAI] = useState(false);\r\n  const [globalQuantityJustification, setGlobalQuantityJustification] = useState('');\r\n  const [formData, setFormData] = useState<DFDFormData>({\r\n    objeto: editingDFD?.objeto || '',\r\n    tipoDFD: editingDFD?.tipoDFD || '',\r\n    descricaoSucinta: editingDFD?.descricaoSucinta || '',\r\n    descricaoDemanda: editingDFD?.descricaoDemanda || '',\r\n    justificativa: editingDFD?.justificativa || '',\r\n    dataPrevista: editingDFD?.dataPrevista || '',\r\n    prioridade: editingDFD?.prioridade || '',\r\n    justificativaPrioridade: editingDFD?.justificativaPrioridade || '',\r\n    itens: editingDFD?.itens || []\r\n  });\r\n\r\n  const { toast } = useToast();\r\n  const { user } = useAuth();\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  const objetoOptions = [\r\n    'Aquisi√ß√£o de G√™neros Aliment√≠cios',\r\n    'Aquisi√ß√£o de Material de Limpeza',\r\n    'Aquisi√ß√£o de Medicamentos',\r\n    'Aquisi√ß√£o de Material Hospitalar',\r\n    'Aquisi√ß√£o de Material de Expediente',\r\n    'Aquisi√ß√£o de Equipamentos de Inform√°tica',\r\n    'Aquisi√ß√£o de Mobili√°rio',\r\n    'Aquisi√ß√£o de Ve√≠culos',\r\n    'Aquisi√ß√£o de Uniformes e EPIs',\r\n    'Contrata√ß√£o de Servi√ßos de Manuten√ß√£o Predial',\r\n    'Contrata√ß√£o de Servi√ßos de Limpeza e Conserva√ß√£o',\r\n    'Contrata√ß√£o de Servi√ßos de Tecnologia',\r\n    'Contrata√ß√£o de Obras e Engenharia'\r\n  ];\r\n\r\n  const tipoDFDOptions = [\r\n    'MATERIAIS DE CONSUMO',\r\n    'MATERIAIS PERMANENTES',\r\n    'SERVI√áO CONTINUADO',\r\n    'SERVI√áO N√ÉO CONTINUADO',\r\n    'SERVI√áO DE ENGENHARIA',\r\n    'OBRAS',\r\n    'SOLU√á√ïES DE TIC',\r\n    'TERMO ADITIVO'\r\n  ];\r\n\r\n  const prioridadeOptions = ['Baixo', 'M√©dio', 'Alto'];\r\n\r\n  const handleInputChange = (field: keyof DFDFormData, value: string) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const isAIButtonEnabled = () => {\r\n    return formData.objeto && formData.prioridade && formData.dataPrevista && formData.tipoDFD;\r\n  };\r\n\r\n  const generateWithAI = async () => {\r\n    setLoadingAI(true);\r\n\r\n    // Simular delay da IA\r\n    setTimeout(() => {\r\n      const suggestions: Record<string, any> = {\r\n        'Aquisi√ß√£o de G√™neros Aliment√≠cios': {\r\n          descricaoDemanda: 'Atender √†s necessidades nutricionais dos alunos da rede escolar municipal, fornecendo alimenta√ß√£o balanceada e de qualidade conforme diretrizes do PNAE (Programa Nacional de Alimenta√ß√£o Escolar), garantindo o desenvolvimento adequado dos estudantes e o cumprimento das metas educacionais.',\r\n          justificativa: 'A aquisi√ß√£o de g√™neros aliment√≠cios √© fundamental para garantir a alimenta√ß√£o escolar adequada, conforme estabelecido na Lei n¬∫ 11.947/2009 e nas diretrizes do PNAE. A contrata√ß√£o visa assegurar a continuidade do fornecimento de merenda escolar, contribuindo para a perman√™ncia dos alunos na escola e seu desenvolvimento nutricional. A demanda foi calculada com base no n√∫mero de estudantes matriculados e no card√°pio nutricional aprovado por nutricionista respons√°vel t√©cnico.'\r\n        },\r\n        'Aquisi√ß√£o de Material de Limpeza': {\r\n          descricaoDemanda: 'Manter as instala√ß√µes p√∫blicas municipais em condi√ß√µes adequadas de higiene e limpeza, garantindo um ambiente saud√°vel e seguro para servidores, mun√≠cipes e visitantes, em conformidade com as normas sanit√°rias vigentes.',\r\n          justificativa: 'A aquisi√ß√£o de material de limpeza √© essencial para manter as condi√ß√µes de higiene e salubridade das instala√ß√µes p√∫blicas, atendendo √†s normas da ANVISA e demais √≥rg√£os reguladores. A contrata√ß√£o visa garantir a continuidade dos servi√ßos de limpeza e conserva√ß√£o, prevenindo riscos √† sa√∫de p√∫blica e mantendo a qualidade do ambiente de trabalho. A estimativa de consumo foi baseada no hist√≥rico de utiliza√ß√£o e na √°rea total das instala√ß√µes.'\r\n        },\r\n        'Aquisi√ß√£o de Medicamentos': {\r\n          descricaoDemanda: 'Garantir o fornecimento cont√≠nuo de medicamentos essenciais para atendimento b√°sico da popula√ß√£o atrav√©s da farm√°cia municipal, complementando as a√ß√µes de aten√ß√£o prim√°ria √† sa√∫de e assegurando o acesso universal aos medicamentos.',\r\n          justificativa: 'A aquisi√ß√£o de medicamentos √© fundamental para garantir o direito constitucional √† sa√∫de, conforme Art. 196 da CF/88 e Lei n¬∫ 8.080/90 (SUS). A contrata√ß√£o visa manter o estoque adequado da farm√°cia municipal para atendimento √† popula√ß√£o carente, seguindo a Rela√ß√£o Nacional de Medicamentos Essenciais (RENAME) e o Componente B√°sico da Assist√™ncia Farmac√™utica. A demanda foi calculada com base no perfil epidemiol√≥gico local e consumo hist√≥rico.'\r\n        },\r\n        'Aquisi√ß√£o de Material Hospitalar': {\r\n          descricaoDemanda: 'Garantir o funcionamento adequado das unidades de sa√∫de municipais com materiais hospitalares de qualidade, assegurando a continuidade dos servi√ßos de sa√∫de e o atendimento digno √† popula√ß√£o usu√°ria do Sistema √önico de Sa√∫de.',\r\n          justificativa: 'A aquisi√ß√£o de material hospitalar √© indispens√°vel para o funcionamento das unidades de sa√∫de, garantindo a qualidade e seguran√ßa dos procedimentos m√©dicos realizados. A contrata√ß√£o visa manter o estoque adequado conforme padr√µes t√©cnicos da ANVISA e Minist√©rio da Sa√∫de, assegurando a continuidade dos servi√ßos de sa√∫de p√∫blica. A demanda foi estimada com base no hist√≥rico de consumo e na capacidade de atendimento das unidades.'\r\n        },\r\n        'Aquisi√ß√£o de Material de Expediente': {\r\n          descricaoDemanda: 'Suprir as necessidades administrativas das secretarias e demais √≥rg√£os municipais com materiais de expediente adequados, garantindo o fluxo normal dos trabalhos burocr√°ticos e o atendimento ao cidad√£o.',\r\n          justificativa: 'A aquisi√ß√£o de material de expediente √© essencial para a manuten√ß√£o das atividades administrativas do munic√≠pio. A falta destes itens pode comprometer a efici√™ncia do servi√ßo p√∫blico e o atendimento √† popula√ß√£o. A estimativa quantitativa baseou-se no consumo m√©dio dos √∫ltimos exerc√≠cios.'\r\n        },\r\n        'Aquisi√ß√£o de Equipamentos de Inform√°tica': {\r\n          descricaoDemanda: 'Modernizar o parque tecnol√≥gico da administra√ß√£o municipal atrav√©s da aquisi√ß√£o de equipamentos de inform√°tica, visando aumentar a produtividade dos servidores e a qualidade dos servi√ßos digitais oferecidos aos cidad√£os.',\r\n          justificativa: 'A atualiza√ß√£o dos equipamentos de inform√°tica √© necess√°ria devido √† obsolesc√™ncia natural dos dispositivos atuais e √† necessidade de suportar sistemas mais modernos. A contrata√ß√£o trar√° ganhos de efici√™ncia e agilidade nos processos administrativos.'\r\n        },\r\n        'Aquisi√ß√£o de Mobili√°rio': {\r\n          descricaoDemanda: 'Prover as reparti√ß√µes p√∫blicas de mobili√°rio adequado e ergon√¥mico, proporcionando condi√ß√µes dignas de trabalho aos servidores e conforto ao atendimento do p√∫blico externo.',\r\n          justificativa: 'A aquisi√ß√£o de mobili√°rio visa substituir itens danificados e mobiliar novos espa√ßos, atendendo √†s normas de ergonomia (NR-17) e garantindo um ambiente de trabalho adequado. A demanda foi levantada atrav√©s de invent√°rio f√≠sico realizado nas unidades.'\r\n        },\r\n        'Aquisi√ß√£o de Ve√≠culos': {\r\n          descricaoDemanda: 'Renovar e ampliar a frota municipal para atender √†s demandas de transporte de servidores, materiais e fiscaliza√ß√£o, reduzindo custos com manuten√ß√£o e garantindo a efici√™ncia log√≠stica.',\r\n          justificativa: 'A aquisi√ß√£o de novos ve√≠culos justifica-se pelo alto custo de manuten√ß√£o da frota antiga e pela necessidade de expans√£o dos servi√ßos. A compra de ve√≠culos pr√≥prios demonstra-se economicamente vantajosa em compara√ß√£o √† loca√ß√£o a longo prazo para este perfil de utiliza√ß√£o.'\r\n        },\r\n        'Aquisi√ß√£o de Uniformes e EPIs': {\r\n          descricaoDemanda: 'Fornecer uniformes e Equipamentos de Prote√ß√£o Individual (EPIs) aos servidores, garantindo sua identifica√ß√£o, seguran√ßa e conformidade com as normas regulamentadoras de seguran√ßa do trabalho.',\r\n          justificativa: 'A aquisi√ß√£o √© obrigat√≥ria conforme legisla√ß√£o trabalhista e normas de seguran√ßa. Visa proteger a integridade f√≠sica dos servidores no exerc√≠cio de suas fun√ß√µes, bem como padronizar a identifica√ß√£o visual das equipes municipais.'\r\n        },\r\n        'Contrata√ß√£o de Servi√ßos de Manuten√ß√£o Predial': {\r\n          descricaoDemanda: 'Garantir a conserva√ß√£o e o funcionamento adequado dos pr√©dios p√∫blicos municipais atrav√©s de servi√ßos de manuten√ß√£o preventiva e corretiva, preservando o patrim√¥nio p√∫blico e a seguran√ßa dos usu√°rios.',\r\n          justificativa: 'A contrata√ß√£o de servi√ßos de manuten√ß√£o √© imprescind√≠vel para evitar a deteriora√ß√£o dos im√≥veis p√∫blicos, garantindo sua vida √∫til e a seguran√ßa de servidores e cidad√£os. A terceiriza√ß√£o destes servi√ßos permite maior agilidade e especializa√ß√£o t√©cnica nas interven√ß√µes necess√°rias.'\r\n        },\r\n        'Contrata√ß√£o de Servi√ßos de Limpeza e Conserva√ß√£o': {\r\n          descricaoDemanda: 'Assegurar a limpeza, conserva√ß√£o e higieniza√ß√£o das √°reas internas e externas das unidades municipais, proporcionando um ambiente salubre e agrad√°vel para o desenvolvimento das atividades p√∫blicas.',\r\n          justificativa: 'A terceiriza√ß√£o dos servi√ßos de limpeza visa garantir a continuidade e qualidade da higieniza√ß√£o dos espa√ßos p√∫blicos, atividade meio essencial para o funcionamento da administra√ß√£o. A demanda foi dimensionada com base na √°rea f√≠sica e frequ√™ncia de utiliza√ß√£o dos espa√ßos.'\r\n        },\r\n        'Contrata√ß√£o de Servi√ßos de Tecnologia': {\r\n          descricaoDemanda: 'Contratar servi√ßos especializados em Tecnologia da Informa√ß√£o para suporte, desenvolvimento e manuten√ß√£o de sistemas, garantindo a disponibilidade e seguran√ßa das informa√ß√µes municipais.',\r\n          justificativa: 'A contrata√ß√£o justifica-se pela necessidade de conhecimento t√©cnico especializado e pela criticidade dos sistemas de governo. Visa assegurar a continuidade dos servi√ßos digitais, a seguran√ßa de dados e a moderniza√ß√£o administrativa.'\r\n        },\r\n        'Contrata√ß√£o de Obras e Engenharia': {\r\n          descricaoDemanda: 'Executar obras de constru√ß√£o, reforma ou amplia√ß√£o de infraestrutura p√∫blica, visando atender √†s demandas da popula√ß√£o por melhores equipamentos urbanos e sociais.',\r\n          justificativa: 'A realiza√ß√£o da obra √© necess√°ria para atender ao interesse p√∫blico, melhorando a infraestrutura municipal. O projeto b√°sico e o or√ßamento estimativo demonstram a viabilidade t√©cnica e econ√¥mica da interven√ß√£o, que trar√° benef√≠cios diretos √† comunidade.'\r\n        }\r\n      };\r\n\r\n      const suggestion = suggestions[formData.objeto];\r\n\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        descricaoDemanda: suggestion?.descricaoDemanda || '',\r\n        justificativa: suggestion?.justificativa || '',\r\n        justificativaPrioridade: formData.prioridade === 'Alto' ?\r\n          'Esta demanda possui car√°ter urgente devido √† natureza essencial do servi√ßo p√∫blico prestado, podendo causar descontinuidade nas atividades caso n√£o seja atendida tempestivamente. O n√£o atendimento pode comprometer a qualidade dos servi√ßos oferecidos √† popula√ß√£o.' : ''\r\n      }));\r\n\r\n      setAiGenerated(true);\r\n      setIsEditingAI(false); // Reseta para modo de visualiza√ß√£o caso j√° tenha gerado antes\r\n      setLoadingAI(false);\r\n\r\n      toast({\r\n        title: \"Conte√∫do gerado por IA\",\r\n        description: \"Os campos foram preenchidos automaticamente com sugest√µes inteligentes.\",\r\n      });\r\n    }, 3000);\r\n  };\r\n\r\n  const handleAddItem = (item: DFDItem) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      itens: [...prev.itens, { ...item, id: Date.now().toString() }]\r\n    }));\r\n    setShowItemModal(false);\r\n    toast({\r\n      title: \"Item adicionado\",\r\n      description: \"Item inclu√≠do na demanda com sucesso.\",\r\n    });\r\n  };\r\n\r\n  const handleRemoveItem = (itemId: string) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      itens: prev.itens.filter(item => item.id !== itemId)\r\n    }));\r\n\r\n    toast({\r\n      title: \"Item removido\",\r\n      description: \"Item removido da demanda.\",\r\n    });\r\n  };\r\n\r\n  const handleEditItem = (item: DFDItem) => {\r\n    setEditingItem(item);\r\n    setShowItemEdit(true);\r\n  };\r\n\r\n  const handleSaveEditedItem = (updatedItem: DFDItem) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      itens: prev.itens.map(item =>\r\n        item.id === updatedItem.id ? updatedItem : item\r\n      )\r\n    }));\r\n    toast({\r\n      title: \"Item atualizado\",\r\n      description: \"Altera√ß√µes salvas com sucesso.\",\r\n    });\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    try {\r\n      setIsSubmitting(true);\r\n      const dfdData = {\r\n        objeto: formData.objeto,\r\n        tipo_dfd: formData.tipoDFD,\r\n        descricao_sucinta: formData.descricaoSucinta,\r\n        descricao_demanda: formData.descricaoDemanda,\r\n        justificativa: formData.justificativa,\r\n        justificativa_quantidade: globalQuantityJustification,\r\n        data_prevista_contratacao: formData.dataPrevista,\r\n        prioridade: formData.prioridade as 'Baixo' | 'M√©dio' | 'Alto',\r\n        justificativa_prioridade: formData.justificativaPrioridade,\r\n        status: 'Rascunho' as const,\r\n        ano_contratacao: new Date().getFullYear(),\r\n        valor_estimado_total: formData.itens.reduce((acc, item) => acc + (Number(item.quantidade) * Number(item.valorReferencia)), 0),\r\n        created_by: user?.id,\r\n        prefeitura_id: user?.prefeituraId,\r\n        secretaria_id: user?.secretariaId\r\n      };\r\n\r\n      const itemsData = formData.itens.map(item => ({\r\n        descricao_item: item.descricao,\r\n        codigo_item: item.codigo,\r\n        unidade: item.unidade,\r\n        quantidade: Number(item.quantidade),\r\n        valor_unitario: Number(item.valorReferencia),\r\n        // valor_total √© gerado automaticamente no banco\r\n        tabela_referencia: item.tabelaReferencia\r\n      }));\r\n\r\n      if (editingDFD) {\r\n        await dfdService.update(editingDFD.id, dfdData, itemsData);\r\n        toast({\r\n          title: \"Rasunho Atualizado\",\r\n          description: \"As altera√ß√µes foram salvas como rascunho.\",\r\n        });\r\n      } else {\r\n        await dfdService.create(dfdData, itemsData);\r\n        toast({\r\n          title: \"Rascunho Salvo\",\r\n          description: \"Documento salvo como rascunho com sucesso.\",\r\n        });\r\n      }\r\n      onBack();\r\n    } catch (error: any) {\r\n      console.error(error);\r\n      toast({\r\n        title: \"Erro ao salvar\",\r\n        description: error.message || \"N√£o foi poss√≠vel salvar o DFD. Tente novamente.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const validateGlobalJustification = () => {\r\n    return formData.itens.length === 0 || globalQuantityJustification.trim() !== '';\r\n  };\r\n\r\n  const handleSubmit = () => {\r\n    if (!formData.objeto || !formData.tipoDFD || !formData.descricaoDemanda || !formData.dataPrevista || formData.itens.length === 0) {\r\n      toast({\r\n        title: \"Campos obrigat√≥rios\",\r\n        description: \"Preencha todos os campos obrigat√≥rios, incluindo o Tipo de DFD, e adicione pelo menos um item.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!validateGlobalJustification()) {\r\n      toast({\r\n        title: \"Justificativa obrigat√≥ria\",\r\n        description: \"√â necess√°rio justificar as quantidades dos itens antes de enviar o DFD.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    const submitDFD = async () => {\r\n      try {\r\n        setIsSubmitting(true);\r\n        const dfdData = {\r\n          objeto: formData.objeto,\r\n          tipo_dfd: formData.tipoDFD,\r\n          descricao_sucinta: formData.descricaoSucinta,\r\n          descricao_demanda: formData.descricaoDemanda,\r\n          justificativa: formData.justificativa,\r\n          justificativa_quantidade: globalQuantityJustification,\r\n          data_prevista_contratacao: formData.dataPrevista,\r\n          prioridade: formData.prioridade as 'Baixo' | 'M√©dio' | 'Alto',\r\n          justificativa_prioridade: formData.justificativaPrioridade,\r\n          status: 'Pendente' as const, // Envia como Pendente para aprova√ß√£o\r\n          ano_contratacao: new Date().getFullYear(),\r\n          valor_estimado_total: formData.itens.reduce((acc, item) => acc + (Number(item.quantidade) * Number(item.valorReferencia)), 0),\r\n          created_by: user?.id,\r\n          prefeitura_id: user?.prefeituraId,\r\n          secretaria_id: user?.secretariaId\r\n        };\r\n\r\n        const itemsData = formData.itens.map(item => ({\r\n          descricao_item: item.descricao,\r\n          codigo_item: item.codigo,\r\n          unidade: item.unidade,\r\n          quantidade: Number(item.quantidade),\r\n          valor_unitario: Number(item.valorReferencia),\r\n          // valor_total √© coluna gerada automaticamente no banco\r\n          tabela_referencia: item.tabelaReferencia\r\n        }));\r\n\r\n        if (editingDFD) {\r\n          await dfdService.update(editingDFD.id, dfdData, itemsData);\r\n          toast({\r\n            title: \"DFD Atualizado\",\r\n            description: \"DFD enviado para aprova√ß√£o com sucesso.\",\r\n          });\r\n        } else {\r\n          await dfdService.create(dfdData, itemsData);\r\n          toast({\r\n            title: \"DFD Enviado\",\r\n            description: \"Documento enviado para aprova√ß√£o com sucesso.\",\r\n          });\r\n        }\r\n        onBack();\r\n      } catch (error: any) {\r\n        console.error(error);\r\n        toast({\r\n          title: \"Erro ao enviar\",\r\n          description: error.message || \"N√£o foi poss√≠vel enviar o DFD. Tente novamente.\",\r\n          variant: \"destructive\"\r\n        });\r\n      } finally {\r\n        setIsSubmitting(false);\r\n      }\r\n    };\r\n\r\n    submitDFD();\r\n  };\r\n\r\n  const handleGeneratePDF = () => {\r\n    if (!formData.objeto || !formData.tipoDFD || !formData.descricaoDemanda || formData.itens.length === 0) {\r\n      toast({\r\n        title: \"Campos obrigat√≥rios\",\r\n        description: \"Preencha todos os campos obrigat√≥rios e adicione pelo menos um item antes de gerar o PDF.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (!validateGlobalJustification()) {\r\n      toast({\r\n        title: \"Justificativa obrigat√≥ria\",\r\n        description: \"√â necess√°rio justificar as quantidades dos itens antes de gerar o PDF.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    toast({\r\n      title: \"PDF Gerado\",\r\n      description: \"Documento PDF foi gerado com sucesso.\",\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center space-x-4\">\r\n          <Button variant=\"ghost\" onClick={onBack}>\r\n            <ArrowLeft size={20} />\r\n          </Button>\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">{editingDFD ? 'Editar DFD' : 'Novo DFD'}</h1>\r\n            <p className=\"text-gray-600\">Documento de Formaliza√ß√£o da Demanda</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <Button variant=\"outline\" onClick={() => setShowPreview(true)}>\r\n            <Eye size={16} className=\"mr-2\" />\r\n            Preview\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Bot√£o Gerar com IA - Destaque no topo */}\r\n      <Card className=\"bg-gradient-to-r from-orange-50 to-orange-100 border-orange-200\">\r\n        <CardContent className=\"p-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-orange-500 rounded-lg\">\r\n                <Sparkles size={20} className=\"text-white\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-semibold text-gray-900\">Gera√ß√£o Inteligente</h3>\r\n                <p className=\"text-sm text-gray-600\">\r\n                  Preencha os campos obrigat√≥rios e deixe a IA completar sua demanda\r\n                </p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Button\r\n                onClick={generateWithAI}\r\n                disabled={!isAIButtonEnabled() || loadingAI}\r\n                className=\"bg-orange-500 hover:bg-orange-600\"\r\n              >\r\n                {loadingAI ? (\r\n                  <Loader2 size={16} className=\"mr-2 animate-spin\" />\r\n                ) : (\r\n                  <Sparkles size={16} className=\"mr-2\" />\r\n                )}\r\n                Gerar com IA\r\n              </Button>\r\n              {aiGenerated && (\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => setShowAISuggestions(true)}\r\n                  className=\"border-orange-300 text-orange-700 hover:bg-orange-50\"\r\n                >\r\n                  <Lightbulb size={16} className=\"mr-2\" />\r\n                  Ver Sugest√µes de Itens\r\n                </Button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Informa√ß√µes da Demanda</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"objeto\">Descri√ß√£o Sucinta do Objeto *</Label>\r\n              <Select value={formData.objeto} onValueChange={(value) => handleInputChange('objeto', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione o tipo de objeto\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {objetoOptions.map((option) => (\r\n                    <SelectItem key={option} value={option}>{option}</SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"tipoDFD\">Tipo de DFD *</Label>\r\n              <Select value={formData.tipoDFD} onValueChange={(value) => handleInputChange('tipoDFD', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione o tipo de DFD\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {tipoDFDOptions.map((option) => (\r\n                    <SelectItem key={option} value={option}>{option}</SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"dataPrevista\">Data Prevista da Contrata√ß√£o *</Label>\r\n              <Input\r\n                id=\"dataPrevista\"\r\n                type=\"date\"\r\n                value={formData.dataPrevista}\r\n                onChange={(e) => handleInputChange('dataPrevista', e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label htmlFor=\"prioridade\">Grau de Prioridade *</Label>\r\n              <Select value={formData.prioridade} onValueChange={(value) => handleInputChange('prioridade', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione a prioridade\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  {prioridadeOptions.map((option) => (\r\n                    <SelectItem key={option} value={option}>{option}</SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            {formData.prioridade === 'Alto' && (\r\n              <div className=\"space-y-2 md:col-span-2\">\r\n                <Label htmlFor=\"justificativaPrioridade\">Justificativa da Prioridade *</Label>\r\n                <Textarea\r\n                  id=\"justificativaPrioridade\"\r\n                  value={formData.justificativaPrioridade}\r\n                  onChange={(e) => handleInputChange('justificativaPrioridade', e.target.value)}\r\n                  placeholder=\"Justifique por que esta demanda tem prioridade alta...\"\r\n                  rows={2}\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"space-y-2 md:col-span-2\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Label htmlFor=\"descricaoDemanda\">Descri√ß√£o da Demanda *</Label>\r\n                {aiGenerated && !isEditingAI && (\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    onClick={() => setIsEditingAI(true)}\r\n                    className=\"h-6 px-2 text-xs text-orange-600 hover:text-orange-700\"\r\n                  >\r\n                    <Edit size={12} className=\"mr-1\" />\r\n                    Editar Conte√∫do da IA\r\n                  </Button>\r\n                )}\r\n              </div>\r\n              <div className=\"relative\">\r\n                <Textarea\r\n                  id=\"descricaoDemanda\"\r\n                  value={formData.descricaoDemanda}\r\n                  onChange={(e) => handleInputChange('descricaoDemanda', e.target.value)}\r\n                  placeholder=\"Descreva a demanda que motiva a contrata√ß√£o...\"\r\n                  rows={4}\r\n                  readOnly={aiGenerated && !isEditingAI}\r\n                  className={aiGenerated && !isEditingAI ? \"bg-orange-50/50\" : \"\"}\r\n                />\r\n                {loadingAI && (\r\n                  <div className=\"absolute inset-0 bg-white/80 flex items-center justify-center\">\r\n                    <Loader2 size={20} className=\"animate-spin\" />\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"justificativa\">Justificativa da Contrata√ß√£o</Label>\r\n            <Textarea\r\n              id=\"justificativa\"\r\n              value={formData.justificativa}\r\n              onChange={(e) => handleInputChange('justificativa', e.target.value)}\r\n              placeholder=\"Descreva a justificativa legal e t√©cnica para a contrata√ß√£o...\"\r\n              rows={6}\r\n              readOnly={aiGenerated && !isEditingAI}\r\n              className={aiGenerated && !isEditingAI ? \"bg-orange-50/50\" : \"\"}\r\n            />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <div className=\"flex items-center justify-between\">\r\n            <CardTitle>Itens da Demanda</CardTitle>\r\n            <Button onClick={() => setShowItemModal(true)} className=\"bg-orange-500 hover:bg-orange-600\">\r\n              <Plus size={16} className=\"mr-2\" />\r\n              Adicionar Item\r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <ItemsTable\r\n            items={formData.itens}\r\n            onRemoveItem={handleRemoveItem}\r\n            onEditItem={handleEditItem}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Global quantity justification form - appears when items are added */}\r\n      {formData.itens.length > 0 && (\r\n        <ItemJustificationForm\r\n          items={formData.itens}\r\n          globalJustification={globalQuantityJustification}\r\n          onGlobalJustificationChange={setGlobalQuantityJustification}\r\n        />\r\n      )}\r\n\r\n      <div className=\"flex items-center justify-end space-x-4 pt-6 border-t\">\r\n        <Button variant=\"outline\" onClick={onBack}>\r\n          Cancelar\r\n        </Button>\r\n        <Button variant=\"outline\" onClick={handleSave}>\r\n          <Save size={16} className=\"mr-2\" />\r\n          Salvar Rascunho\r\n        </Button>\r\n        <Button variant=\"outline\" onClick={handleGeneratePDF}>\r\n          <FileText size={16} className=\"mr-2\" />\r\n          Gerar PDF\r\n        </Button>\r\n        <Button onClick={handleSubmit} className=\"bg-orange-500 hover:bg-orange-600\">\r\n          <Send size={16} className=\"mr-2\" />\r\n          {editingDFD ? 'Salvar Altera√ß√µes' : 'Enviar para Aprova√ß√£o'}\r\n        </Button>\r\n      </div>\r\n\r\n      <ItemSearchModal\r\n        open={showItemModal}\r\n        onClose={() => setShowItemModal(false)}\r\n        onAddItem={handleAddItem}\r\n      />\r\n\r\n      <AISuggestionsModal\r\n        open={showAISuggestions}\r\n        onClose={() => setShowAISuggestions(false)}\r\n        objeto={formData.objeto}\r\n        onAddItems={(items) => {\r\n          setFormData(prev => ({\r\n            ...prev,\r\n            itens: [...prev.itens, ...items.map(item => ({ ...item, id: Date.now().toString() + Math.random() }))]\r\n          }));\r\n          toast({\r\n            title: \"Itens adicionados\",\r\n            description: `${items.length} itens foram adicionados √† demanda.`,\r\n          });\r\n        }}\r\n      />\r\n\r\n      <ItemEditModal\r\n        open={showItemEdit}\r\n        onClose={() => setShowItemEdit(false)}\r\n        item={editingItem}\r\n        onSave={handleSaveEditedItem}\r\n      />\r\n\r\n      <DFDPreview\r\n        open={showPreview}\r\n        onClose={() => setShowPreview(false)}\r\n        formData={formData}\r\n        globalJustification={globalQuantityJustification}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DFDForm;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\DFD\\DFDList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[329,332],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[329,332],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[427,430],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[427,430],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[540,543],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[540,543],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport DFDCard from './DFDCard';\r\nimport DFDFilters from './DFDFilters';\r\nimport DFDListPagination from './DFDListPagination';\r\n\r\ninterface DFDListProps {\r\n  filters: {\r\n    tipoDFD: string;\r\n    prioridade: string;\r\n    anoContratacao: string;\r\n    status: string;\r\n  };\r\n  onFilterChange: (filters: any) => void;\r\n  currentPage: number;\r\n  onPageChange: (page: number) => void;\r\n  onAction: (dfd: any, action: 'cancel' | 'delete' | 'remove-pca' | 'view' | 'edit') => void;\r\n\r\n  currentFilter: string;\r\n  dfds: any[];\r\n}\r\n\r\nconst DFDList = ({\r\n  filters,\r\n  onFilterChange,\r\n  currentPage,\r\n  onPageChange,\r\n  onAction,\r\n\r\n  currentFilter,\r\n  dfds\r\n}: DFDListProps) => {\r\n  console.log('DFDList rendering with props:', { filters, currentPage, currentFilter });\r\n\r\n  const tipoDFDOptions = [\r\n    'MATERIAIS DE CONSUMO',\r\n    'MATERIAIS PERMANENTES',\r\n    'SERVI√áO CONTINUADO',\r\n    'SERVI√áO N√ÉO CONTINUADO',\r\n    'SERVI√áO DE ENGENHARIA',\r\n    'TERMO ADITIVO'\r\n  ];\r\n\r\n  const prioridadeOptions = ['Baixo', 'M√©dio', 'Alto'];\r\n\r\n  const allDFDs = dfds;\r\n\r\n  console.log('allDFDs loaded:', allDFDs.length, 'items');\r\n\r\n  const filteredDFDs = allDFDs.filter(dfd => {\r\n    const matchesTipo = !filters.tipoDFD || filters.tipoDFD === 'all' || dfd.tipoDFD === filters.tipoDFD;\r\n    const matchesPrioridade = !filters.prioridade || filters.prioridade === 'all' || dfd.prioridade === filters.prioridade;\r\n    const matchesAno = !filters.anoContratacao || filters.anoContratacao === 'all' || dfd.anoContratacao === filters.anoContratacao;\r\n    const matchesStatus = !filters.status || filters.status === 'all' || dfd.status === filters.status;\r\n\r\n    return matchesTipo && matchesPrioridade && matchesAno && matchesStatus;\r\n  });\r\n\r\n  const statusFilteredDFDs = filteredDFDs.filter(dfd => {\r\n    switch (currentFilter) {\r\n      case 'em-elaboracao':\r\n        return dfd.status === 'Em Elabora√ß√£o';\r\n      case 'aprovados':\r\n        return dfd.status === 'Aprovado';\r\n      case 'pendentes':\r\n        return dfd.status === 'Pendente Aprova√ß√£o';\r\n      default:\r\n        return true;\r\n    }\r\n  });\r\n\r\n  console.log('statusFilteredDFDs:', statusFilteredDFDs.length, 'items');\r\n\r\n  const itemsPerPage = 5;\r\n  const totalPages = Math.ceil(statusFilteredDFDs.length / itemsPerPage);\r\n  const startIndex = (currentPage - 1) * itemsPerPage;\r\n  const paginatedDFDs = statusFilteredDFDs.slice(startIndex, startIndex + itemsPerPage);\r\n\r\n  console.log('paginatedDFDs:', paginatedDFDs.length, 'items for page', currentPage);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <DFDFilters\r\n        filters={filters}\r\n        onFilterChange={onFilterChange}\r\n        tipoDFDOptions={tipoDFDOptions}\r\n        prioridadeOptions={prioridadeOptions}\r\n      />\r\n\r\n      <div className=\"grid gap-6\">\r\n        {paginatedDFDs.length > 0 ? (\r\n          paginatedDFDs.map((dfd) => {\r\n            console.log('Rendering DFD card:', dfd.id, dfd.objeto);\r\n            return (\r\n              <DFDCard\r\n                key={dfd.id}\r\n                dfd={dfd}\r\n                onAction={onAction}\r\n              />\r\n            );\r\n          })\r\n        ) : (\r\n          <div className=\"text-center py-8\">\r\n            <p className=\"text-gray-500\">\r\n              {currentFilter === 'all'\r\n                ? 'Nenhum DFD encontrado com os filtros aplicados.'\r\n                : `Nenhum DFD ${currentFilter === 'em-elaboracao' ? 'em elabora√ß√£o' :\r\n                  currentFilter === 'aprovados' ? 'aprovado' :\r\n                    'pendente'} encontrado.`}\r\n            </p>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {totalPages > 1 && (\r\n        <DFDListPagination\r\n          currentPage={currentPage}\r\n          totalPages={totalPages}\r\n          onPageChange={onPageChange}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DFDList;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\DFD\\DFDListPagination.tsx","messages":[{"ruleId":"prefer-const","severity":2,"message":"'end' is never reassigned. Use 'const' instead.","line":31,"column":11,"nodeType":"Identifier","messageId":"useConst","endLine":31,"endColumn":14,"fix":{"range":[742,797],"text":"const end = Math.min(totalPages, start + maxVisible - 1);"}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport {\r\n  Pagination,\r\n  PaginationContent,\r\n  PaginationItem,\r\n  PaginationLink,\r\n  PaginationNext,\r\n  PaginationPrevious,\r\n} from '@/components/ui/pagination';\r\n\r\ninterface DFDListPaginationProps {\r\n  currentPage: number;\r\n  totalPages: number;\r\n  onPageChange: (page: number) => void;\r\n}\r\n\r\nconst DFDListPagination = ({ currentPage, totalPages, onPageChange }: DFDListPaginationProps) => {\r\n  if (totalPages <= 1) return null;\r\n\r\n  const getVisiblePages = () => {\r\n    const pages = [];\r\n    const maxVisible = 5;\r\n    \r\n    if (totalPages <= maxVisible) {\r\n      for (let i = 1; i <= totalPages; i++) {\r\n        pages.push(i);\r\n      }\r\n    } else {\r\n      let start = Math.max(1, currentPage - 2);\r\n      let end = Math.min(totalPages, start + maxVisible - 1);\r\n      \r\n      if (end - start < maxVisible - 1) {\r\n        start = Math.max(1, end - maxVisible + 1);\r\n      }\r\n      \r\n      for (let i = start; i <= end; i++) {\r\n        pages.push(i);\r\n      }\r\n    }\r\n    \r\n    return pages;\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex items-center justify-center\">\r\n      <Pagination>\r\n        <PaginationContent>\r\n          <PaginationItem>\r\n            <PaginationPrevious \r\n              href=\"#\"\r\n              onClick={(e) => {\r\n                e.preventDefault();\r\n                if (currentPage > 1) onPageChange(currentPage - 1);\r\n              }}\r\n              className={currentPage === 1 ? 'pointer-events-none opacity-50' : ''}\r\n            />\r\n          </PaginationItem>\r\n          \r\n          {getVisiblePages().map((page) => (\r\n            <PaginationItem key={page}>\r\n              <PaginationLink\r\n                href=\"#\"\r\n                isActive={page === currentPage}\r\n                onClick={(e) => {\r\n                  e.preventDefault();\r\n                  onPageChange(page);\r\n                }}\r\n              >\r\n                {page}\r\n              </PaginationLink>\r\n            </PaginationItem>\r\n          ))}\r\n          \r\n          <PaginationItem>\r\n            <PaginationNext \r\n              href=\"#\"\r\n              onClick={(e) => {\r\n                e.preventDefault();\r\n                if (currentPage < totalPages) onPageChange(currentPage + 1);\r\n              }}\r\n              className={currentPage === totalPages ? 'pointer-events-none opacity-50' : ''}\r\n            />\r\n          </PaginationItem>\r\n        </PaginationContent>\r\n      </Pagination>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DFDListPagination;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\DFD\\ItemDetailsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[640,643],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[640,643],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Plus, X } from 'lucide-react';\r\n\r\ninterface DFDItem {\r\n  id: string;\r\n  codigo: string;\r\n  descricao: string;\r\n  unidade: string;\r\n  quantidade: number;\r\n  valorReferencia: number;\r\n  tabelaReferencia: string;\r\n}\r\n\r\ninterface ItemDetailsModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  item: any;\r\n  onAddItem: (item: DFDItem) => void;\r\n}\r\n\r\nconst ItemDetailsModal = ({ open, onClose, item, onAddItem }: ItemDetailsModalProps) => {\r\n  const [quantidade, setQuantidade] = useState('');\r\n\r\n  if (!item) return null;\r\n\r\n  const handleAddItem = () => {\r\n    if (!quantidade || parseInt(quantidade) <= 0) {\r\n      return;\r\n    }\r\n\r\n    const newItem: DFDItem = {\r\n      id: Date.now().toString(),\r\n      codigo: item.codigo,\r\n      descricao: item.descricao,\r\n      unidade: item.unidade,\r\n      quantidade: parseInt(quantidade),\r\n      valorReferencia: item.valor,\r\n      tabelaReferencia: item.tabelaReferencia\r\n    };\r\n\r\n    onAddItem(newItem);\r\n    setQuantidade('');\r\n  };\r\n\r\n  const getTotalValue = () => {\r\n    if (!quantidade) return 0;\r\n    return parseInt(quantidade) * item.valor;\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-2xl\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center justify-between\">\r\n            <span>Detalhes do Item</span>\r\n            <Button variant=\"ghost\" size=\"sm\" onClick={onClose}>\r\n              <X size={16} />\r\n            </Button>\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n        \r\n        <div className=\"space-y-6\">\r\n          {/* Informa√ß√µes do item */}\r\n          <div className=\"border rounded-lg p-4 bg-gray-50\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">C√≥digo</Label>\r\n                <p className=\"font-mono text-lg font-semibold\">{item.codigo}</p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Fonte</Label>\r\n                <Badge className=\"bg-blue-100 text-blue-800 mt-1\">\r\n                  {item.tabelaReferencia}\r\n                </Badge>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"mt-4\">\r\n              <Label className=\"text-sm font-medium text-gray-600\">Descri√ß√£o Completa</Label>\r\n              <p className=\"text-gray-900 mt-1 leading-relaxed\">{item.descricao}</p>\r\n            </div>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4\">\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Unidade de Medida</Label>\r\n                <p className=\"text-gray-900 font-medium\">{item.unidade}</p>\r\n              </div>\r\n              <div>\r\n                <Label className=\"text-sm font-medium text-gray-600\">Valor de Refer√™ncia</Label>\r\n                <p className=\"text-green-600 font-bold text-lg\">\r\n                  R$ {item.valor.toFixed(2)} <span className=\"text-sm font-normal\">/ {item.unidade}</span>\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Input de quantidade */}\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"quantidade\" className=\"text-base font-medium\">\r\n                Quantidade Necess√°ria *\r\n              </Label>\r\n              <Input\r\n                id=\"quantidade\"\r\n                type=\"number\"\r\n                min=\"1\"\r\n                placeholder=\"Digite a quantidade desejada\"\r\n                value={quantidade}\r\n                onChange={(e) => setQuantidade(e.target.value)}\r\n                className=\"mt-2\"\r\n              />\r\n            </div>\r\n            \r\n            {quantidade && parseInt(quantidade) > 0 && (\r\n              <div className=\"border rounded-lg p-4 bg-green-50 border-green-200\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <p className=\"text-sm text-green-700\">C√°lculo do Valor Total</p>\r\n                    <p className=\"text-green-800\">\r\n                      {quantidade} {item.unidade} √ó R$ {item.valor.toFixed(2)}\r\n                    </p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-sm text-green-700\">Total Estimado</p>\r\n                    <p className=\"text-2xl font-bold text-green-800\">\r\n                      R$ {getTotalValue().toFixed(2)}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"flex justify-end space-x-2 pt-4 border-t\">\r\n          <Button variant=\"outline\" onClick={onClose}>\r\n            <X size={16} className=\"mr-2\" />\r\n            Cancelar\r\n          </Button>\r\n          <Button \r\n            onClick={handleAddItem}\r\n            disabled={!quantidade || parseInt(quantidade) <= 0}\r\n            className=\"bg-orange-500 hover:bg-orange-600\"\r\n          >\r\n            <Plus size={16} className=\"mr-2\" />\r\n            Inserir Item no DFD\r\n          </Button>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default ItemDetailsModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\DFD\\ItemSearchModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1467,1470],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1467,1470],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Search, Plus, Eye, Loader2 } from 'lucide-react';\r\nimport ItemDetailsModal from './ItemDetailsModal';\r\nimport { referenciaService, ReferenciaItem } from '@/services/referenciaService';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { useDebounce } from '../../hooks/use-debounce';\r\n\r\ninterface DFDItem {\r\n  id: string;\r\n  codigo: string;\r\n  descricao: string;\r\n  unidade: string;\r\n  quantidade: number;\r\n  valorReferencia: number;\r\n  tabelaReferencia: string;\r\n}\r\n\r\ninterface ItemSearchModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onAddItem: (item: DFDItem) => void;\r\n}\r\n\r\nconst ItemSearchModal = ({ open, onClose, onAddItem }: ItemSearchModalProps) => {\r\n  const { toast } = useToast();\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const debouncedSearch = useDebounce(searchTerm, 500);\r\n  const [activeTab, setActiveTab] = useState('PNCP');\r\n  const [items, setItems] = useState<ReferenciaItem[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [selectedItem, setSelectedItem] = useState<any>(null);\r\n  const [showItemDetails, setShowItemDetails] = useState(false);\r\n\r\n  const tabelas = [\r\n    { id: 'PNCP', name: 'PNCP' },\r\n    { id: 'BPS', name: 'BPS' },\r\n    { id: 'CMED', name: 'CMED' },\r\n    { id: 'SINAPI', name: 'SINAPI' },\r\n    { id: 'CATSER', name: 'CATSER' },\r\n    { id: 'SETOP', name: 'SETOP' },\r\n    { id: 'SIMPRO', name: 'SIMPRO' },\r\n    { id: 'CEASA', name: 'CEASA' },\r\n    { id: 'SIGTAP', name: 'SIGTAP' },\r\n    { id: 'LICITAR', name: 'LICITAR DIGITAL' }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    const fetchItems = async () => {\r\n      // Especial para PNCP ou se tiver busca, trazer algo\r\n      if (!debouncedSearch && activeTab !== 'PNCP') {\r\n        setItems([]);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        setLoading(true);\r\n        setItems([]); // Limpa itens anteriores para feedback visual melhor\r\n        const results = await referenciaService.searchAll(debouncedSearch, activeTab);\r\n        setItems(results || []);\r\n      } catch (error) {\r\n        console.error('Erro ao buscar itens:', error);\r\n        toast({\r\n          title: \"Erro na busca\",\r\n          description: \"N√£o foi poss√≠vel conectar ao banco de refer√™ncia.\",\r\n          variant: \"destructive\"\r\n        });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (open) {\r\n      fetchItems();\r\n    }\r\n  }, [debouncedSearch, activeTab, open]);\r\n\r\n  const handleSelectItem = (item: ReferenciaItem) => {\r\n    setSelectedItem({\r\n      codigo: item.codigo,\r\n      descricao: item.descricao,\r\n      unidade: item.unidade,\r\n      valor: item.valor,\r\n      tabelaReferencia: item.fonte\r\n    });\r\n    setShowItemDetails(true);\r\n  };\r\n\r\n  const handleAddItemFromDetails = (itemWithQuantity: DFDItem) => {\r\n    onAddItem(itemWithQuantity);\r\n    setShowItemDetails(false);\r\n    setSelectedItem(null);\r\n    setSearchTerm('');\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={open} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-5xl max-h-[85vh] overflow-hidden flex flex-col\">\r\n          <DialogHeader>\r\n            <DialogTitle>Buscar Itens nas Tabelas de Refer√™ncia</DialogTitle>\r\n            <p className=\"text-sm text-gray-600\">\r\n              Selecione a fonte de dados e busque pelos itens necess√°rios\r\n            </p>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-4 overflow-hidden flex flex-col flex-1\">\r\n            {/* Campo de busca global */}\r\n            <div className=\"space-y-2\">\r\n              <Label>Buscar Item</Label>\r\n              <div className=\"relative\">\r\n                <Search size={16} className=\"absolute left-3 top-3 text-gray-400\" />\r\n                <Input\r\n                  placeholder=\"Digite para buscar em todos os itens...\"\r\n                  value={searchTerm}\r\n                  onChange={(e) => setSearchTerm(e.target.value)}\r\n                  className=\"pl-10\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Abas das tabelas */}\r\n            <Tabs value={activeTab} onValueChange={setActiveTab} className=\"flex-1 overflow-hidden flex flex-col\">\r\n              <TabsList className=\"grid grid-cols-5 lg:grid-cols-10 w-full shrink-0\">\r\n                {tabelas.map((tabela) => (\r\n                  <TabsTrigger\r\n                    key={tabela.id}\r\n                    value={tabela.id}\r\n                    className=\"text-xs px-2\"\r\n                  >\r\n                    {tabela.name}\r\n                  </TabsTrigger>\r\n                ))}\r\n              </TabsList>\r\n\r\n              <div className=\"flex-1 overflow-hidden mt-4\">\r\n                {tabelas.map((tabela) => (\r\n                  <TabsContent\r\n                    key={tabela.id}\r\n                    value={tabela.id}\r\n                    className=\"h-full m-0 focus-visible:ring-0\"\r\n                  >\r\n                    <div className=\"border rounded-lg h-full flex flex-col overflow-hidden\">\r\n                      <div className=\"p-4 bg-gray-50 border-b shrink-0\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <h3 className=\"font-semibold\">Itens dispon√≠veis - {tabela.name}</h3>\r\n                          {!loading && (\r\n                            <Badge className=\"bg-blue-100 text-blue-800\">\r\n                              {items.length} itens encontrados\r\n                            </Badge>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"flex-1 overflow-y-auto\">\r\n                        {loading ? (\r\n                          <div className=\"flex flex-col items-center justify-center py-20\">\r\n                            <Loader2 className=\"h-8 w-8 animate-spin text-blue-600 mb-2\" />\r\n                            <p className=\"text-gray-500\">Buscando na base {tabela.name}...</p>\r\n                          </div>\r\n                        ) : (\r\n                          <>\r\n                            {items.map((item) => (\r\n                              <div\r\n                                key={item.id}\r\n                                className=\"p-4 border-b hover:bg-gray-50 cursor-pointer transition-colors\"\r\n                                onClick={() => handleSelectItem(item)}\r\n                              >\r\n                                <div className=\"flex justify-between items-start\">\r\n                                  <div className=\"flex-1\">\r\n                                    <div className=\"flex items-center space-x-2 mb-2\">\r\n                                      <Badge variant=\"outline\">{item.codigo}</Badge>\r\n                                      <Badge className=\"bg-orange-100 text-orange-800\">\r\n                                        {item.fonte}\r\n                                      </Badge>\r\n                                    </div>\r\n                                    <p className=\"font-medium text-gray-900 mb-1\">{item.descricao}</p>\r\n                                    <p className=\"text-sm text-gray-600\">Unidade: {item.unidade}</p>\r\n                                  </div>\r\n                                  <div className=\"text-right flex items-center space-x-2\">\r\n                                    <div>\r\n                                      <p className=\"font-semibold text-green-600\">\r\n                                        {item.valor > 0 ? (\r\n                                          new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(item.valor)\r\n                                        ) : (\r\n                                          'Sob consulta'\r\n                                        )}\r\n                                      </p>\r\n                                      <p className=\"text-xs text-gray-500\">por {item.unidade}</p>\r\n                                    </div>\r\n                                    <Button variant=\"ghost\" size=\"sm\">\r\n                                      <Eye size={14} />\r\n                                    </Button>\r\n                                  </div>\r\n                                </div>\r\n                              </div>\r\n                            ))}\r\n\r\n                            {items.length === 0 && (\r\n                              <div className=\"p-8 text-center text-gray-500\">\r\n                                <Search size={48} className=\"mx-auto mb-4 text-gray-300\" />\r\n                                <p className=\"text-lg mb-2\">Nenhum item encontrado</p>\r\n                                <p className=\"text-sm\">Tente digitar o nome do item para pesquisar</p>\r\n                              </div>\r\n                            )}\r\n                          </>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </TabsContent>\r\n                ))}\r\n              </div>\r\n            </Tabs>\r\n          </div>\r\n\r\n          <div className=\"flex justify-end space-x-2 pt-4 border-t shrink-0\">\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Fechar\r\n            </Button>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <ItemDetailsModal\r\n        open={showItemDetails}\r\n        onClose={() => {\r\n          setShowItemDetails(false);\r\n          setSelectedItem(null);\r\n        }}\r\n        item={selectedItem}\r\n        onAddItem={handleAddItemFromDetails}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ItemSearchModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Dashboard\\DFDCard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[992,995],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[992,995],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { FileText, TrendingUp } from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst DFDCard = () => {\r\n  const navigate = useNavigate();\r\n\r\n  const [dfdStats, setDfdStats] = React.useState({\r\n    total: 0,\r\n    status: {} as Record<string, number>,\r\n    tipos: {} as Record<string, number>,\r\n    prioridades: {} as Record<string, number>\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    const fetchStats = async () => {\r\n      const { supabase } = await import('@/lib/supabase');\r\n      const { data } = await supabase.from('dfd').select('*');\r\n\r\n      if (data) {\r\n        const stats = {\r\n          total: data.length,\r\n          status: {} as Record<string, number>,\r\n          tipos: {} as Record<string, number>,\r\n          prioridades: {} as Record<string, number>\r\n        };\r\n\r\n        data.forEach((dfd: any) => {\r\n          // Status\r\n          stats.status[dfd.status] = (stats.status[dfd.status] || 0) + 1;\r\n          // Tips\r\n          stats.tipos[dfd.tipo_dfd] = (stats.tipos[dfd.tipo_dfd] || 0) + 1;\r\n          // Prioridade\r\n          stats.prioridades[dfd.prioridade] = (stats.prioridades[dfd.prioridade] || 0) + 1;\r\n        });\r\n\r\n        setDfdStats(stats);\r\n      }\r\n    };\r\n    fetchStats();\r\n  }, []);\r\n\r\n  const getStatusColor = (status: string) => {\r\n    const colors = {\r\n      'Pendente Aprova√ß√£o': 'bg-orange-100 text-orange-800',\r\n      'Em Elabora√ß√£o': 'bg-blue-100 text-blue-800',\r\n      'Aprovado': 'bg-green-100 text-green-800',\r\n      'Cancelado': 'bg-gray-100 text-gray-800'\r\n    };\r\n    return colors[status as keyof typeof colors] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  const getPriorityColor = (priority: string) => {\r\n    const colors = {\r\n      'Alta': 'bg-red-100 text-red-800',\r\n      'M√©dia': 'bg-yellow-100 text-yellow-800',\r\n      'Baixa': 'bg-green-100 text-green-800'\r\n    };\r\n    return colors[priority as keyof typeof colors] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  const handleClick = () => {\r\n    navigate('/dfd');\r\n  };\r\n\r\n  return (\r\n    <Card\r\n      className=\"hover:shadow-lg transition-all duration-200 cursor-pointer hover:scale-105\"\r\n      onClick={handleClick}\r\n    >\r\n      <CardHeader className=\"pb-3\">\r\n        <CardTitle className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"p-2 rounded-full bg-orange-100\">\r\n              <FileText size={20} className=\"text-orange-600\" />\r\n            </div>\r\n            <span>Total de DFDs</span>\r\n          </div>\r\n          <TrendingUp size={16} className=\"text-green-500\" />\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        <div className=\"text-3xl font-bold text-gray-900\">{dfdStats.total}</div>\r\n\r\n        <div className=\"space-y-3\">\r\n          <div>\r\n            <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Por Status</h4>\r\n            <div className=\"flex flex-wrap gap-1\">\r\n              {Object.entries(dfdStats.status).map(([status, count]) => (\r\n                <Badge key={status} className={`${getStatusColor(status)} text-xs`}>\r\n                  {status}: {count}\r\n                </Badge>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Por Prioridade</h4>\r\n            <div className=\"flex flex-wrap gap-1\">\r\n              {Object.entries(dfdStats.prioridades).map(([priority, count]) => (\r\n                <Badge key={priority} className={`${getPriorityColor(priority)} text-xs`}>\r\n                  {priority}: {count}\r\n                </Badge>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Por Tipo</h4>\r\n            <div className=\"grid grid-cols-2 gap-1 text-xs\">\r\n              {Object.entries(dfdStats.tipos).map(([tipo, count]) => (\r\n                <div key={tipo} className=\"flex justify-between\">\r\n                  <span className=\"text-gray-600 truncate\">{tipo}:</span>\r\n                  <span className=\"font-medium\">{count}</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default DFDCard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Dashboard\\NewsSection.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[261,264],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[261,264],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { ExternalLink, Calendar } from 'lucide-react';\r\n\r\nconst NewsSection = () => {\r\n  const news: any[] = [];\r\n\r\n  const getTypeColor = (type: string) => {\r\n    const colors = {\r\n      'Jurisprud√™ncia': 'bg-blue-100 text-blue-800',\r\n      'Ac√≥rd√£o': 'bg-red-100 text-red-800',\r\n      'An√°lise': 'bg-green-100 text-green-800',\r\n      'Orienta√ß√£o': 'bg-purple-100 text-purple-800'\r\n    };\r\n    return colors[type as keyof typeof colors] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString('pt-BR');\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center space-x-2\">\r\n          <Calendar size={20} className=\"text-orange-600\" />\r\n          <span>Not√≠cias sobre Planejamento</span>\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"space-y-4\">\r\n          {news.length === 0 ? (\r\n            <p className=\"text-gray-500 text-center py-4\">Nenhuma not√≠cia dispon√≠vel no momento.</p>\r\n          ) : (\r\n            news.map((item) => (\r\n              <div key={item.id} className=\"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors\">\r\n                <div className=\"flex items-start justify-between mb-2\">\r\n                  <div className=\"flex-1\">\r\n                    <h3 className=\"font-semibold text-gray-900 mb-1 line-clamp-2\">\r\n                      {item.title}\r\n                    </h3>\r\n                    <div className=\"flex items-center space-x-2 mb-2\">\r\n                      <Badge className={getTypeColor(item.type)}>\r\n                        {item.type}\r\n                      </Badge>\r\n                      <span className=\"text-sm text-gray-500\">{item.source}</span>\r\n                      <span className=\"text-sm text-gray-400\">‚Ä¢</span>\r\n                      <span className=\"text-sm text-gray-500\">{formatDate(item.date)}</span>\r\n                    </div>\r\n                    <p className=\"text-sm text-gray-600 line-clamp-2 mb-2\">\r\n                      {item.summary}\r\n                    </p>\r\n                  </div>\r\n                  <button className=\"ml-4 p-2 hover:bg-gray-200 rounded-full transition-colors\">\r\n                    <ExternalLink size={16} className=\"text-gray-600\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            )))}\r\n        </div>\r\n        <div className=\"mt-4 text-center\">\r\n          <button className=\"text-sm text-orange-600 hover:text-orange-700 font-medium\">\r\n            Ver mais not√≠cias\r\n          </button>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default NewsSection;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Dashboard\\PCACard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[939,942],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[939,942],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1082,1085],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1082,1085],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Calendar, TrendingUp } from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nconst PCACard = () => {\r\n  const navigate = useNavigate();\r\n\r\n  const [pcaStats, setPcaStats] = React.useState({\r\n    valorTotal: 'R$ 0,00',\r\n    ano: new Date().getFullYear().toString(),\r\n    percentualAprovados: 0,\r\n    totalDFDs: 0,\r\n    dfdAprovados: 0\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    const fetchStats = async () => {\r\n      const { supabase } = await import('@/lib/supabase');\r\n      const currentYear = new Date().getFullYear();\r\n\r\n      const { data } = await supabase\r\n        .from('dfd')\r\n        .select('status, valor_estimado_total, ano_contratacao')\r\n        .eq('ano_contratacao', currentYear);\r\n\r\n      if (data) {\r\n        const totalDFDs = data.length;\r\n        const approved = data.filter((d: any) => d.status === 'Aprovado');\r\n        const approvedCount = approved.length;\r\n        const totalValue = approved.reduce((acc: number, d: any) => acc + (d.valor_estimado_total || 0), 0);\r\n\r\n        setPcaStats({\r\n          valorTotal: new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalValue),\r\n          ano: currentYear.toString(),\r\n          percentualAprovados: totalDFDs > 0 ? Math.round((approvedCount / totalDFDs) * 100) : 0,\r\n          totalDFDs: totalDFDs,\r\n          dfdAprovados: approvedCount\r\n        });\r\n      }\r\n    };\r\n    fetchStats();\r\n  }, []);\r\n\r\n  const handleClick = () => {\r\n    navigate('/pca');\r\n  };\r\n\r\n  return (\r\n    <Card\r\n      className=\"hover:shadow-lg transition-all duration-200 cursor-pointer hover:scale-105\"\r\n      onClick={handleClick}\r\n    >\r\n      <CardHeader className=\"pb-3\">\r\n        <CardTitle className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"p-2 rounded-full bg-green-100\">\r\n              <Calendar size={20} className=\"text-green-600\" />\r\n            </div>\r\n            <span>PCA {pcaStats.ano}</span>\r\n          </div>\r\n          <TrendingUp size={16} className=\"text-green-500\" />\r\n        </CardTitle>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-4\">\r\n        <div className=\"text-3xl font-bold text-gray-900\">{pcaStats.valorTotal}</div>\r\n\r\n        <div className=\"space-y-3\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <span className=\"text-sm text-gray-600\">Ano de Vig√™ncia:</span>\r\n            <span className=\"font-semibold text-gray-900\">{pcaStats.ano}</span>\r\n          </div>\r\n\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-sm text-gray-600\">DFDs Aprovados:</span>\r\n              <span className=\"font-semibold text-gray-900\">\r\n                {pcaStats.dfdAprovados}/{pcaStats.totalDFDs}\r\n              </span>\r\n            </div>\r\n\r\n            <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n              <div\r\n                className=\"bg-green-500 h-2 rounded-full transition-all duration-300\"\r\n                style={{ width: `${(pcaStats.dfdAprovados / pcaStats.totalDFDs) * 100}%` }}\r\n              ></div>\r\n            </div>\r\n\r\n            <div className=\"text-center\">\r\n              <span className=\"text-2xl font-bold text-green-600\">\r\n                {Math.round((pcaStats.dfdAprovados / pcaStats.totalDFDs) * 100)}%\r\n              </span>\r\n              <p className=\"text-xs text-gray-500\">de aprova√ß√£o</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default PCACard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\ETP\\DFDSelectionStep.tsx","messages":[{"ruleId":"prefer-const","severity":2,"message":"'filtered' is never reassigned. Use 'const' instead.","line":73,"column":9,"nodeType":"Identifier","messageId":"useConst","endLine":73,"endColumn":17,"fix":{"range":[2045,2844],"text":"const filtered = availableDFDs.filter(dfd => {\r\n      // Search term filter\r\n      if (filters.searchTerm) {\r\n        const searchLower = filters.searchTerm.toLowerCase();\r\n        const matchesSearch =\r\n          dfd.objeto.toLowerCase().includes(searchLower) ||\r\n          dfd.secretaria?.toLowerCase().includes(searchLower) ||\r\n          dfd.numeroDFD?.toLowerCase().includes(searchLower) ||\r\n          dfd.tipoDFD.toLowerCase().includes(searchLower);\r\n\r\n        if (!matchesSearch) return false;\r\n      }\r\n\r\n      // Other filters\r\n      if (filters.prioridade && filters.prioridade !== 'all' && dfd.prioridade !== filters.prioridade) return false;\r\n      if (filters.secretaria && filters.secretaria !== 'all' && dfd.secretaria !== filters.secretaria) return false;\r\n\r\n      return true;\r\n    });"}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useMemo } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { CheckCircle, Search, Filter, X } from 'lucide-react';\r\nimport {\r\n  Pagination,\r\n  PaginationContent,\r\n  PaginationItem,\r\n  PaginationLink,\r\n  PaginationNext,\r\n  PaginationPrevious,\r\n} from '@/components/ui/pagination';\r\n\r\ninterface DFD {\r\n  id: string;\r\n  objeto: string;\r\n  valorEstimado: string;\r\n  tipoDFD: string;\r\n  secretaria?: string;\r\n  prioridade: string;\r\n  dataContratacao?: string;\r\n  numeroDFD?: string;\r\n  status?: string;\r\n  usedInETP?: boolean;\r\n  secretario?: string;\r\n  responsavelDemanda?: string;\r\n}\r\n\r\ninterface DFDSelectionStepProps {\r\n  availableDFDs: DFD[];\r\n  selectedDFDs: DFD[];\r\n  onSelectDFDs: (dfds: DFD[]) => void;\r\n}\r\n\r\ninterface Filters {\r\n  dataContratacao: string;\r\n  prioridade: string;\r\n  numeroDFD: string;\r\n  secretaria: string;\r\n  searchTerm: string;\r\n}\r\n\r\nconst DFDSelectionStep = ({ availableDFDs, selectedDFDs, onSelectDFDs }: DFDSelectionStepProps) => {\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [filters, setFilters] = useState<Filters>({\r\n    dataContratacao: 'none',\r\n    prioridade: 'all',\r\n    numeroDFD: 'none',\r\n    secretaria: 'all',\r\n    searchTerm: ''\r\n  });\r\n\r\n  const itemsPerPage = 5;\r\n\r\n  // Get unique values for filter options\r\n  const secretarias = useMemo(() =>\r\n    [...new Set(availableDFDs.map(dfd => dfd.secretaria).filter(Boolean))],\r\n    [availableDFDs]\r\n  );\r\n\r\n  const prioridades = useMemo(() =>\r\n    [...new Set(availableDFDs.map(dfd => dfd.prioridade))],\r\n    [availableDFDs]\r\n  );\r\n\r\n  // Filter and sort DFDs\r\n  const filteredDFDs = useMemo(() => {\r\n    let filtered = availableDFDs.filter(dfd => {\r\n      // Search term filter\r\n      if (filters.searchTerm) {\r\n        const searchLower = filters.searchTerm.toLowerCase();\r\n        const matchesSearch =\r\n          dfd.objeto.toLowerCase().includes(searchLower) ||\r\n          dfd.secretaria?.toLowerCase().includes(searchLower) ||\r\n          dfd.numeroDFD?.toLowerCase().includes(searchLower) ||\r\n          dfd.tipoDFD.toLowerCase().includes(searchLower);\r\n\r\n        if (!matchesSearch) return false;\r\n      }\r\n\r\n      // Other filters\r\n      if (filters.prioridade && filters.prioridade !== 'all' && dfd.prioridade !== filters.prioridade) return false;\r\n      if (filters.secretaria && filters.secretaria !== 'all' && dfd.secretaria !== filters.secretaria) return false;\r\n\r\n      return true;\r\n    });\r\n\r\n    // Sort by selected criteria\r\n    if (filters.dataContratacao === 'asc') {\r\n      filtered.sort((a, b) => (a.dataContratacao || '').localeCompare(b.dataContratacao || ''));\r\n    } else if (filters.numeroDFD === 'asc') {\r\n      filtered.sort((a, b) => (a.numeroDFD || '').localeCompare(b.numeroDFD || ''));\r\n    }\r\n\r\n    return filtered;\r\n  }, [availableDFDs, filters]);\r\n\r\n  // Pagination\r\n  const totalPages = Math.ceil(filteredDFDs.length / itemsPerPage);\r\n  const startIndex = (currentPage - 1) * itemsPerPage;\r\n  const paginatedDFDs = filteredDFDs.slice(startIndex, startIndex + itemsPerPage);\r\n\r\n  const handleDFDToggle = (dfd: DFD, checked: boolean) => {\r\n    if (checked) {\r\n      onSelectDFDs([...selectedDFDs, dfd]);\r\n    } else {\r\n      onSelectDFDs(selectedDFDs.filter(selected => selected.id !== dfd.id));\r\n    }\r\n  };\r\n\r\n  const handleFilterChange = (key: keyof Filters, value: string) => {\r\n    setFilters(prev => ({ ...prev, [key]: value }));\r\n    setCurrentPage(1); // Reset to first page when filtering\r\n  };\r\n\r\n  const clearFilters = () => {\r\n    setFilters({\r\n      dataContratacao: 'none',\r\n      prioridade: 'all',\r\n      numeroDFD: 'none',\r\n      secretaria: 'all',\r\n      searchTerm: ''\r\n    });\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const getPriorityColor = (priority: string) => {\r\n    switch (priority) {\r\n      case 'Alta':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'M√©dia':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'Baixa':\r\n        return 'bg-green-100 text-green-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const hasActiveFilters = filters.searchTerm !== '' ||\r\n    filters.dataContratacao !== 'none' ||\r\n    filters.prioridade !== 'all' ||\r\n    filters.numeroDFD !== 'none' ||\r\n    filters.secretaria !== 'all';\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle className=\"flex items-center space-x-2\">\r\n          <span>Sele√ß√£o de DFDs</span>\r\n          {selectedDFDs.length > 0 && (\r\n            <CheckCircle size={20} className=\"text-green-500\" />\r\n          )}\r\n        </CardTitle>\r\n        <p className=\"text-gray-600\">\r\n          Selecione um ou mais DFDs aprovados para vincular ao ETP\r\n        </p>\r\n      </CardHeader>\r\n      <CardContent className=\"space-y-6\">\r\n        {/* Search and Filters */}\r\n        <div className=\"space-y-4\">\r\n          {/* Search */}\r\n          <div className=\"relative\">\r\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" size={16} />\r\n            <Input\r\n              placeholder=\"Buscar por nome, secretaria, n√∫mero do DFD ou palavra-chave...\"\r\n              value={filters.searchTerm}\r\n              onChange={(e) => handleFilterChange('searchTerm', e.target.value)}\r\n              className=\"pl-10\"\r\n            />\r\n          </div>\r\n\r\n          {/* Filters */}\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n            <div className=\"space-y-2\">\r\n              <Label>Data de Contrata√ß√£o</Label>\r\n              <Select value={filters.dataContratacao} onValueChange={(value) => handleFilterChange('dataContratacao', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Ordenar por data\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"none\">Sem ordena√ß√£o</SelectItem>\r\n                  <SelectItem value=\"asc\">Mais pr√≥xima primeiro</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>Prioridade</Label>\r\n              <Select value={filters.prioridade} onValueChange={(value) => handleFilterChange('prioridade', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Todas as prioridades\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">Todas</SelectItem>\r\n                  {prioridades.map((prioridade) => (\r\n                    <SelectItem key={prioridade} value={prioridade}>\r\n                      {prioridade}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>N√∫mero do DFD</Label>\r\n              <Select value={filters.numeroDFD} onValueChange={(value) => handleFilterChange('numeroDFD', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Ordenar por n√∫mero\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"none\">Sem ordena√ß√£o</SelectItem>\r\n                  <SelectItem value=\"asc\">Crescente</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>Secretaria</Label>\r\n              <Select value={filters.secretaria} onValueChange={(value) => handleFilterChange('secretaria', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Todas as secretarias\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">Todas</SelectItem>\r\n                  {secretarias.map((secretaria) => (\r\n                    <SelectItem key={secretaria} value={secretaria}>\r\n                      {secretaria}\r\n                    </SelectItem>\r\n                  ))}\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Clear Filters */}\r\n          {hasActiveFilters && (\r\n            <div className=\"flex justify-end\">\r\n              <Button variant=\"outline\" size=\"sm\" onClick={clearFilters}>\r\n                <X size={16} className=\"mr-2\" />\r\n                Limpar Filtros\r\n              </Button>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Results Info */}\r\n        <div className=\"flex items-center justify-between text-sm text-gray-600\">\r\n          <span>\r\n            Mostrando {paginatedDFDs.length} de {filteredDFDs.length} DFDs\r\n          </span>\r\n          {selectedDFDs.length > 0 && (\r\n            <span className=\"text-green-600 font-medium\">\r\n              {selectedDFDs.length} selecionado(s)\r\n            </span>\r\n          )}\r\n        </div>\r\n\r\n        {/* DFD List */}\r\n        <div className=\"space-y-4\">\r\n          {paginatedDFDs.map((dfd) => (\r\n            <div\r\n              key={dfd.id}\r\n              className={`border rounded-lg p-4 transition-colors ${selectedDFDs.some(selected => selected.id === dfd.id)\r\n                  ? 'border-orange-500 bg-orange-50'\r\n                  : dfd.usedInETP\r\n                    ? 'border-gray-300 bg-gray-50'\r\n                    : 'border-gray-200 hover:bg-gray-50'\r\n                }`}\r\n            >\r\n              <div className=\"flex items-start space-x-3\">\r\n                <Checkbox\r\n                  checked={selectedDFDs.some(selected => selected.id === dfd.id)}\r\n                  onCheckedChange={(checked) => handleDFDToggle(dfd, checked as boolean)}\r\n                  className=\"mt-1\"\r\n                />\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"space-y-1\">\r\n                      <h3 className=\"font-medium text-gray-900\">{dfd.objeto}</h3>\r\n                      {dfd.numeroDFD && (\r\n                        <p className=\"text-sm text-blue-600 font-medium\">DFD n¬∫ {dfd.numeroDFD}</p>\r\n                      )}\r\n                    </div>\r\n                    {dfd.usedInETP && (\r\n                      <Badge variant=\"secondary\" className=\"text-xs\">\r\n                        J√° utilizado\r\n                      </Badge>\r\n                    )}\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center space-x-4 mt-2\">\r\n                    <Badge variant=\"outline\">{dfd.tipoDFD}</Badge>\r\n                    <Badge className={getPriorityColor(dfd.prioridade)}>\r\n                      {dfd.prioridade}\r\n                    </Badge>\r\n                  </div>\r\n\r\n                  <div className=\"mt-3 space-y-1\">\r\n                    <p className=\"text-sm font-semibold text-gray-900\">\r\n                      {dfd.valorEstimado}\r\n                    </p>\r\n                    {dfd.secretaria && (\r\n                      <p className=\"text-sm text-gray-600\">{dfd.secretaria}</p>\r\n                    )}\r\n                    {dfd.secretario && (\r\n                      <p className=\"text-sm text-gray-600\">\r\n                        <span className=\"font-medium\">Secret√°rio:</span> {dfd.secretario}\r\n                      </p>\r\n                    )}\r\n                    {dfd.responsavelDemanda && (\r\n                      <p className=\"text-sm text-gray-600\">\r\n                        <span className=\"font-medium\">Respons√°vel:</span> {dfd.responsavelDemanda}\r\n                      </p>\r\n                    )}\r\n                    {dfd.dataContratacao && (\r\n                      <p className=\"text-sm text-gray-500\">\r\n                        <span className=\"font-medium\">Previs√£o:</span> {dfd.dataContratacao}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* No Results */}\r\n        {paginatedDFDs.length === 0 && (\r\n          <div className=\"text-center py-8 text-gray-500\">\r\n            <Filter size={48} className=\"mx-auto mb-4 text-gray-300\" />\r\n            <p>Nenhum DFD encontrado com os filtros aplicados</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Pagination */}\r\n        {totalPages > 1 && (\r\n          <Pagination>\r\n            <PaginationContent>\r\n              <PaginationItem>\r\n                <PaginationPrevious\r\n                  onClick={() => setCurrentPage(Math.max(1, currentPage - 1))}\r\n                  className={currentPage === 1 ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                />\r\n              </PaginationItem>\r\n\r\n              {Array.from({ length: Math.min(5, totalPages) }, (_, i) => {\r\n                const pageNum = i + 1;\r\n                return (\r\n                  <PaginationItem key={pageNum}>\r\n                    <PaginationLink\r\n                      onClick={() => setCurrentPage(pageNum)}\r\n                      isActive={currentPage === pageNum}\r\n                      className=\"cursor-pointer\"\r\n                    >\r\n                      {pageNum}\r\n                    </PaginationLink>\r\n                  </PaginationItem>\r\n                );\r\n              })}\r\n\r\n              {totalPages > 5 && (\r\n                <PaginationItem>\r\n                  <span className=\"px-4 py-2\">...</span>\r\n                </PaginationItem>\r\n              )}\r\n\r\n              <PaginationItem>\r\n                <PaginationNext\r\n                  onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))}\r\n                  className={currentPage === totalPages ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                />\r\n              </PaginationItem>\r\n            </PaginationContent>\r\n          </Pagination>\r\n        )}\r\n\r\n        {/* Selected DFDs Summary */}\r\n        {selectedDFDs.length > 0 && (\r\n          <div className=\"mt-6 p-4 bg-green-50 rounded-lg\">\r\n            <h4 className=\"font-medium text-green-800 mb-2\">\r\n              DFDs Selecionados ({selectedDFDs.length})\r\n            </h4>\r\n            <div className=\"space-y-2\">\r\n              {selectedDFDs.map((dfd) => (\r\n                <div key={dfd.id} className=\"text-sm text-green-700\">\r\n                  ‚Ä¢ {dfd.objeto} - {dfd.valorEstimado}\r\n                  {dfd.secretaria && ` (${dfd.secretaria})`}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default DFDSelectionStep;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\ETP\\ETPPreview.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[490,493],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[490,493],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { \r\n  Table, \r\n  TableBody, \r\n  TableCell, \r\n  TableHead, \r\n  TableHeader, \r\n  TableRow \r\n} from '@/components/ui/table';\r\nimport { Download, Printer } from 'lucide-react';\r\n\r\ninterface ETPFormData {\r\n  selectedDFDs: any[];\r\n  descricaoDemanda: string;\r\n  requisitosContratacao: string;\r\n  alternativasExistem: boolean;\r\n  alternativasDescricao: string;\r\n  descricaoSolucao: string;\r\n  justificativaParcelamento: string;\r\n  resultadosPretendidos: string;\r\n  providenciasExistem: boolean;\r\n  providenciasDescricao: string;\r\n  contratacoesCorrelatas: boolean;\r\n  contratacoesDescricao: string;\r\n  impactosAmbientais: boolean;\r\n  impactosDescricao: string;\r\n  observacoesGerais: string;\r\n  conclusaoTecnica: string;\r\n}\r\n\r\ninterface ETPPreviewProps {\r\n  formData: ETPFormData;\r\n  onGeneratePDF: () => void;\r\n}\r\n\r\nconst ETPPreview = ({ formData, onGeneratePDF }: ETPPreviewProps) => {\r\n  const getPriorityColor = (priority: string) => {\r\n    switch (priority) {\r\n      case 'Alta':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'M√©dia':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'Baixa':\r\n        return 'bg-green-100 text-green-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const formatCurrency = (value: string) => {\r\n    return value; // J√° vem formatado dos DFDs\r\n  };\r\n\r\n  const getCurrentDate = () => {\r\n    return new Date().toLocaleDateString('pt-BR', {\r\n      day: '2-digit',\r\n      month: 'long',\r\n      year: 'numeric'\r\n    });\r\n  };\r\n\r\n  const generateETPId = () => {\r\n    return `ETP-${new Date().getFullYear()}-${String(Math.floor(Math.random() * 1000)).padStart(3, '0')}`;\r\n  };\r\n\r\n  const etpId = generateETPId();\r\n\r\n  return (\r\n    <div className=\"space-y-6\" id=\"etp-preview\">\r\n      {/* Header */}\r\n      <Card>\r\n        <CardContent className=\"p-8\">\r\n          <div className=\"text-center space-y-4\">\r\n            <div className=\"text-2xl font-bold text-gray-900\">\r\n              ESTUDO T√âCNICO PRELIMINAR - ETP\r\n            </div>\r\n            <div className=\"text-lg text-gray-700\">\r\n              {etpId}\r\n            </div>\r\n            <div className=\"text-sm text-gray-600\">\r\n              Gerado em: {getCurrentDate()}\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Se√ß√µes do ETP */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Documento T√©cnico</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-8\">\r\n          {/* 1. Descri√ß√£o da Demanda */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              1. Descri√ß√£o da Demanda\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">{formData.descricaoDemanda}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 2. Requisitos da Contrata√ß√£o */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              2. Requisitos da Contrata√ß√£o\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">{formData.requisitosContratacao}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 3. Alternativas Poss√≠veis */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              3. Alternativas Poss√≠veis para Atender √† Demanda\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">\r\n                {formData.alternativasExistem \r\n                  ? formData.alternativasDescricao \r\n                  : 'N√£o h√° alternativas identificadas'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 4. Descri√ß√£o da Solu√ß√£o */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              4. Descri√ß√£o da Solu√ß√£o\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">{formData.descricaoSolucao}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 5. Justificativa do Parcelamento */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              5. Justificativa do Parcelamento (ou N√£o)\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">{formData.justificativaParcelamento}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 6. Resultados Pretendidos */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              6. Resultados Pretendidos\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">{formData.resultadosPretendidos}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 7. Provid√™ncias Pr√©vias */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              7. Provid√™ncias a Serem Tomadas Antes da Contrata√ß√£o\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">\r\n                {formData.providenciasExistem \r\n                  ? formData.providenciasDescricao \r\n                  : 'N√£o h√° provid√™ncias pr√©vias necess√°rias'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 8. Contrata√ß√µes Correlatas */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              8. Contrata√ß√µes Correlatas ou Interdependentes\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">\r\n                {formData.contratacoesCorrelatas \r\n                  ? formData.contratacoesDescricao \r\n                  : 'N√£o h√° contrata√ß√µes correlatas'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 9. Impactos Ambientais */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              9. Poss√≠veis Impactos Ambientais\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">\r\n                {formData.impactosAmbientais \r\n                  ? formData.impactosDescricao \r\n                  : 'N√£o h√° impactos ambientais significativos'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 10. Observa√ß√µes Gerais */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              10. Observa√ß√µes Gerais\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">{formData.observacoesGerais}</p>\r\n            </div>\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* 11. Conclus√£o T√©cnica */}\r\n          <div>\r\n            <h3 className=\"text-lg font-semibold mb-3 text-gray-900\">\r\n              11. Conclus√£o T√©cnica\r\n            </h3>\r\n            <div className=\"bg-gray-50 p-4 rounded-lg\">\r\n              <p className=\"text-gray-700 whitespace-pre-wrap\">{formData.conclusaoTecnica}</p>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* DFDs Vinculados - Anexo T√©cnico */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Anexo I - DFDs Vinculados</CardTitle>\r\n          <p className=\"text-sm text-gray-600\">\r\n            Detalhamento dos Documentos de Formaliza√ß√£o de Demanda vinculados a este ETP\r\n          </p>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <Table>\r\n            <TableHeader>\r\n              <TableRow>\r\n                <TableHead>Secretaria</TableHead>\r\n                <TableHead>Item</TableHead>\r\n                <TableHead>Tipo</TableHead>\r\n                <TableHead>Valor Estimado</TableHead>\r\n                <TableHead>Prioridade</TableHead>\r\n              </TableRow>\r\n            </TableHeader>\r\n            <TableBody>\r\n              {formData.selectedDFDs.map((dfd) => (\r\n                <TableRow key={dfd.id}>\r\n                  <TableCell className=\"font-medium\">\r\n                    {dfd.secretaria || 'N√£o informado'}\r\n                  </TableCell>\r\n                  <TableCell>{dfd.objeto}</TableCell>\r\n                  <TableCell>\r\n                    <Badge variant=\"outline\">{dfd.tipoDFD}</Badge>\r\n                  </TableCell>\r\n                  <TableCell className=\"font-semibold\">\r\n                    {formatCurrency(dfd.valorEstimado)}\r\n                  </TableCell>\r\n                  <TableCell>\r\n                    <Badge className={getPriorityColor(dfd.prioridade)}>\r\n                      {dfd.prioridade}\r\n                    </Badge>\r\n                  </TableCell>\r\n                </TableRow>\r\n              ))}\r\n            </TableBody>\r\n          </Table>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Rodap√© */}\r\n      <Card>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"text-center space-y-2\">\r\n            <div className=\"text-sm text-gray-600\">\r\n              Respons√°vel pela Elabora√ß√£o:\r\n            </div>\r\n            <div className=\"font-medium text-gray-900\">\r\n              [Nome do Respons√°vel]\r\n            </div>\r\n            <div className=\"text-sm text-gray-600\">\r\n              [Cargo/Fun√ß√£o]\r\n            </div>\r\n            <div className=\"text-sm text-gray-500 mt-4\">\r\n              Documento gerado automaticamente pelo Sistema em {getCurrentDate()}\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Bot√µes de A√ß√£o */}\r\n      <div className=\"flex justify-center space-x-4 print:hidden\">\r\n        <Button\r\n          variant=\"outline\"\r\n          onClick={() => window.print()}\r\n          size=\"lg\"\r\n        >\r\n          <Printer size={20} className=\"mr-2\" />\r\n          Imprimir\r\n        </Button>\r\n        <Button\r\n          onClick={onGeneratePDF}\r\n          className=\"bg-orange-500 hover:bg-orange-600\"\r\n          size=\"lg\"\r\n        >\r\n          <Download size={20} className=\"mr-2\" />\r\n          Gerar PDF\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ETPPreview;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\ETP\\SummaryStep.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[113,116],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[113,116],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport ETPPreview from './ETPPreview';\r\n\r\ninterface ETPFormData {\r\n  selectedDFDs: any[];\r\n  descricaoDemanda: string;\r\n  requisitosContratacao: string;\r\n  alternativasExistem: boolean;\r\n  alternativasDescricao: string;\r\n  descricaoSolucao: string;\r\n  justificativaParcelamento: string;\r\n  resultadosPretendidos: string;\r\n  providenciasExistem: boolean;\r\n  providenciasDescricao: string;\r\n  contratacoesCorrelatas: boolean;\r\n  contratacoesDescricao: string;\r\n  impactosAmbientais: boolean;\r\n  impactosDescricao: string;\r\n  observacoesGerais: string;\r\n  conclusaoTecnica: string;\r\n}\r\n\r\ninterface SummaryStepProps {\r\n  formData: ETPFormData;\r\n  onGeneratePDF: () => void;\r\n}\r\n\r\nconst SummaryStep = ({ formData, onGeneratePDF }: SummaryStepProps) => {\r\n  return <ETPPreview formData={formData} onGeneratePDF={onGeneratePDF} />;\r\n};\r\n\r\nexport default SummaryStep;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Edital\\EditalWizard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1239,1242],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1239,1242],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":92,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2586,2589],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2586,2589],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":242,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":242,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6342,6345],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6342,6345],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport {\r\n  X,\r\n  Save,\r\n  ArrowLeft,\r\n  ArrowRight,\r\n  CheckCircle,\r\n  AlertCircle,\r\n  FileText,\r\n  Calendar,\r\n  Paperclip,\r\n  Settings,\r\n  Eye,\r\n  Scale,\r\n  Users,\r\n  Clipboard,\r\n  DollarSign,\r\n  Clock,\r\n  Loader2\r\n} from 'lucide-react';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { editalService } from '@/services/editalService';\r\nimport { DbEdital, DbTermoReferencia } from '@/types/database';\r\nimport EditalStep1 from './steps/EditalStep1';\r\nimport EditalStep2 from './steps/EditalStep2';\r\nimport EditalStep3 from './steps/EditalStep3';\r\nimport EditalStep4 from './steps/EditalStep4';\r\nimport EditalStep5 from './steps/EditalStep5';\r\nimport EditalStep6 from './steps/EditalStep6';\r\nimport EditalStep7 from './steps/EditalStep7';\r\nimport EditalStep8 from './steps/EditalStep8';\r\n\r\ninterface EditalWizardProps {\r\n  selectedTR: DbTermoReferencia;\r\n  onClose: () => void;\r\n  onSave: (editalData: any) => void;\r\n}\r\n\r\ninterface EditalData {\r\n  // Step 1 - Identifica√ß√£o e Objeto\r\n  numeroEdital: string;\r\n  orgaoResponsavel: string;\r\n  unidadeGestora: string;\r\n  responsavelTecnico: string;\r\n  cargoResponsavel: string;\r\n  modalidadeLicitacao: string;\r\n  objetoLicitacao: string;\r\n\r\n  // Step 2 - Crit√©rios e Julgamento\r\n  criterioJulgamento: string;\r\n  justificativaCriterio: string;\r\n  tipoExecucao: string;\r\n  tipoEntrega: string;\r\n  formaFornecimento: string;\r\n  registroPrecos: boolean;\r\n  justificativaRegistroPrecos: string;\r\n\r\n  // Step 3 - Condi√ß√µes de Participa√ß√£o\r\n  permiteMEEPP: boolean;\r\n  permiteConsorcios: boolean;\r\n  permiteCooperativas: boolean;\r\n  justificativaConsorcios: string;\r\n  vistoriaTecnica: string;\r\n  justificativaVistoria: string;\r\n  criteriosDesempate: string;\r\n  documentacaoExigida: string[];\r\n\r\n  // Step 4 - Recursos e Penalidades\r\n  procedimentosRecursos: string;\r\n  penalidadesPrevistas: string;\r\n  responsavelJulgamento: string;\r\n\r\n  // Step 5 - Execu√ß√£o Contratual\r\n  formaPagamento: string;\r\n  prazoPagamento: string;\r\n  prazosExecucao: string;\r\n  vigenciaContrato: string;\r\n  garantiaContratual: boolean;\r\n  especificacaoGarantia: string;\r\n  subcontratacao: boolean;\r\n  detalhesSubcontratacao: string;\r\n  gestores: string[];\r\n  fiscais: string[];\r\n\r\n  // Step 6 - Itens da Licita√ß√£o\r\n  itensLicitacao: any[];\r\n  exibirValorEstimado: boolean;\r\n\r\n  // Step 7 - Cronograma\r\n  dataAbertura: string;\r\n  prazoPropostas: string;\r\n  prazoJulgamento: string;\r\n  prazoImpugnacao: string;\r\n  validadePropostas: string;\r\n\r\n  // Step 8 - Anexos do Edital (Modelos)\r\n  declaracoes: {\r\n    impedimentos: boolean;\r\n    independente: boolean;\r\n    habilitacao: boolean;\r\n  };\r\n  minutaContrato: {\r\n    tipo: 'upload' | 'ai';\r\n    arquivo?: File;\r\n    texto?: string;\r\n  };\r\n  propostaComercial: {\r\n    incluir: boolean;\r\n    tipo?: 'upload' | 'auto';\r\n    arquivo?: File;\r\n    texto?: string;\r\n  };\r\n}\r\n\r\nconst EditalWizard = ({ selectedTR, onClose, onSave }: EditalWizardProps) => {\r\n  const { user } = useAuth();\r\n  const [currentStep, setCurrentStep] = useState(1);\r\n  const [loading, setLoading] = useState(false);\r\n  const [editalData, setEditalData] = useState<EditalData>({\r\n    // Auto-preenchimento inicial baseado no TR\r\n    numeroEdital: `ED-${String(Math.floor(Math.random() * 999) + 1).padStart(4, '0')}/${new Date().getFullYear()}`,\r\n    orgaoResponsavel: selectedTR.secretaria_id || 'N√£o informada',\r\n    unidadeGestora: selectedTR.secretaria_id || 'N√£o informada',\r\n    responsavelTecnico: 'Usu√°rio Atual',\r\n    cargoResponsavel: 'Respons√°vel T√©cnico',\r\n    modalidadeLicitacao: 'pregao-eletronico',\r\n    objetoLicitacao: selectedTR.objeto,\r\n\r\n    criterioJulgamento: 'menor-preco',\r\n    justificativaCriterio: '',\r\n    tipoExecucao: 'direta',\r\n    tipoEntrega: 'unica',\r\n    formaFornecimento: 'sob-demanda',\r\n    registroPrecos: false,\r\n    justificativaRegistroPrecos: '',\r\n\r\n    permiteMEEPP: true,\r\n    permiteConsorcios: false,\r\n    permiteCooperativas: true,\r\n    justificativaConsorcios: '',\r\n    vistoriaTecnica: 'facultativa',\r\n    justificativaVistoria: '',\r\n    criteriosDesempate: '',\r\n    documentacaoExigida: [],\r\n\r\n    procedimentosRecursos: '',\r\n    penalidadesPrevistas: '',\r\n    responsavelJulgamento: '',\r\n\r\n    formaPagamento: 'a-vista',\r\n    prazoPagamento: '30',\r\n    prazosExecucao: '60',\r\n    vigenciaContrato: '12',\r\n    garantiaContratual: false,\r\n    especificacaoGarantia: '',\r\n    subcontratacao: false,\r\n    detalhesSubcontratacao: '',\r\n    gestores: ['Usu√°rio Atual'],\r\n    fiscais: [],\r\n\r\n    itensLicitacao: [],\r\n    exibirValorEstimado: true,\r\n\r\n    dataAbertura: '',\r\n    prazoPropostas: '8',\r\n    prazoJulgamento: '5',\r\n    prazoImpugnacao: '3',\r\n    validadePropostas: '60',\r\n\r\n    declaracoes: {\r\n      impedimentos: true,\r\n      independente: true,\r\n      habilitacao: true\r\n    },\r\n    minutaContrato: {\r\n      tipo: 'ai'\r\n    },\r\n    propostaComercial: {\r\n      incluir: false\r\n    }\r\n  });\r\n\r\n  const { toast } = useToast();\r\n\r\n  const steps = [\r\n    {\r\n      number: 1,\r\n      title: 'Identifica√ß√£o',\r\n      icon: FileText,\r\n      description: 'Objeto e dados b√°sicos'\r\n    },\r\n    {\r\n      number: 2,\r\n      title: 'Crit√©rios',\r\n      icon: Scale,\r\n      description: 'Julgamento e execu√ß√£o'\r\n    },\r\n    {\r\n      number: 3,\r\n      title: 'Participa√ß√£o',\r\n      icon: Users,\r\n      description: 'Condi√ß√µes e habilita√ß√£o'\r\n    },\r\n    {\r\n      number: 4,\r\n      title: 'Recursos',\r\n      icon: Clipboard,\r\n      description: 'Recursos e penalidades'\r\n    },\r\n    {\r\n      number: 5,\r\n      title: 'Execu√ß√£o',\r\n      icon: Settings,\r\n      description: 'Execu√ß√£o contratual'\r\n    },\r\n    {\r\n      number: 6,\r\n      title: 'Itens',\r\n      icon: DollarSign,\r\n      description: 'Itens da licita√ß√£o'\r\n    },\r\n    {\r\n      number: 7,\r\n      title: 'Cronograma',\r\n      icon: Clock,\r\n      description: 'Prazos da licita√ß√£o'\r\n    },\r\n    {\r\n      number: 8,\r\n      title: 'Anexos',\r\n      icon: Paperclip,\r\n      description: 'Anexos do edital'\r\n    }\r\n  ];\r\n\r\n  const updateEditalData = (field: keyof EditalData, value: any) => {\r\n    setEditalData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const validateStep = (step: number): boolean => {\r\n    switch (step) {\r\n      case 1:\r\n        return !!(editalData.numeroEdital && editalData.objetoLicitacao &&\r\n          editalData.modalidadeLicitacao && editalData.orgaoResponsavel);\r\n      case 2:\r\n        return !!(editalData.criterioJulgamento && editalData.tipoExecucao);\r\n      case 3:\r\n        return !!(editalData.vistoriaTecnica);\r\n      case 4:\r\n        return !!(editalData.procedimentosRecursos);\r\n      case 5:\r\n        return !!(editalData.formaPagamento && editalData.vigenciaContrato);\r\n      case 6:\r\n        return true; // Items s√£o opcionais na valida√ß√£o\r\n      case 7:\r\n        return !!(editalData.dataAbertura && editalData.validadePropostas);\r\n      case 8:\r\n        return !!(editalData.minutaContrato.tipo);\r\n      default:\r\n        return false;\r\n    }\r\n  };\r\n\r\n  const handleNext = () => {\r\n    if (currentStep < 8) {\r\n      if (validateStep(currentStep)) {\r\n        setCurrentStep(currentStep + 1);\r\n      } else {\r\n        toast({\r\n          title: \"Campos Obrigat√≥rios\",\r\n          description: \"Preencha todos os campos obrigat√≥rios antes de continuar.\",\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  const handlePrevious = () => {\r\n    if (currentStep > 1) {\r\n      setCurrentStep(currentStep - 1);\r\n    }\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const data: Omit<DbEdital, 'id' | 'created_at' | 'updated_at'> = {\r\n        numero_edital: editalData.numeroEdital,\r\n        tr_id: selectedTR.id,\r\n        objeto: editalData.objetoLicitacao,\r\n        status: 'Em Elabora√ß√£o',\r\n        modalidade: editalData.modalidadeLicitacao,\r\n        tipo_licitacao: editalData.criterioJulgamento,\r\n        valor_estimado: selectedTR.valor_estimado,\r\n        data_publicacao: null,\r\n        prefeitura_id: user?.prefeituraId || null,\r\n        dados_json: editalData,\r\n        created_by: user?.id || null,\r\n      };\r\n\r\n      await editalService.createEdital(data);\r\n      toast({\r\n        title: \"Edital Salvo\",\r\n        description: \"Rascunho do edital foi salvo com sucesso.\",\r\n      });\r\n    } catch (error) {\r\n      console.error('Erro ao salvar edital:', error);\r\n      toast({\r\n        title: \"Erro ao salvar\",\r\n        description: \"N√£o foi poss√≠vel salvar o rascunho.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFinalize = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const data: Omit<DbEdital, 'id' | 'created_at' | 'updated_at'> = {\r\n        numero_edital: editalData.numeroEdital,\r\n        tr_id: selectedTR.id,\r\n        objeto: editalData.objetoLicitacao,\r\n        status: 'Conclu√≠do',\r\n        modalidade: editalData.modalidadeLicitacao,\r\n        tipo_licitacao: editalData.criterioJulgamento,\r\n        valor_estimado: selectedTR.valor_estimado,\r\n        data_publicacao: null,\r\n        prefeitura_id: user?.prefeituraId || null,\r\n        dados_json: editalData,\r\n        created_by: user?.id || null,\r\n      };\r\n\r\n      const result = await editalService.createEdital(data);\r\n      onSave(result);\r\n      toast({\r\n        title: \"Edital Finalizado\",\r\n        description: \"Edital foi finalizado e est√° pronto para revis√£o.\",\r\n      });\r\n    } catch (error) {\r\n      console.error('Erro ao finalizar edital:', error);\r\n      toast({\r\n        title: \"Erro ao finalizar\",\r\n        description: \"N√£o foi poss√≠vel finalizar o edital.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getStepStatus = (stepNumber: number) => {\r\n    if (stepNumber < currentStep) {\r\n      return validateStep(stepNumber) ? 'completed' : 'error';\r\n    } else if (stepNumber === currentStep) {\r\n      return 'current';\r\n    } else {\r\n      return 'pending';\r\n    }\r\n  };\r\n\r\n  const renderStep = () => {\r\n    switch (currentStep) {\r\n      case 1:\r\n        return (\r\n          <EditalStep1\r\n            data={editalData}\r\n            onUpdate={updateEditalData}\r\n            selectedTR={selectedTR}\r\n          />\r\n        );\r\n      case 2:\r\n        return (\r\n          <EditalStep2\r\n            data={editalData}\r\n            onUpdate={updateEditalData}\r\n            selectedTR={selectedTR}\r\n          />\r\n        );\r\n      case 3:\r\n        return (\r\n          <EditalStep3\r\n            data={editalData}\r\n            onUpdate={updateEditalData}\r\n            selectedTR={selectedTR}\r\n          />\r\n        );\r\n      case 4:\r\n        return (\r\n          <EditalStep4\r\n            data={editalData}\r\n            onUpdate={updateEditalData}\r\n          />\r\n        );\r\n      case 5:\r\n        return (\r\n          <EditalStep5\r\n            data={editalData}\r\n            onUpdate={updateEditalData}\r\n            selectedTR={selectedTR}\r\n          />\r\n        );\r\n      case 6:\r\n        return (\r\n          <EditalStep6\r\n            data={editalData}\r\n            onUpdate={updateEditalData}\r\n            selectedTR={selectedTR}\r\n          />\r\n        );\r\n      case 7:\r\n        return (\r\n          <EditalStep7\r\n            data={editalData}\r\n            onUpdate={updateEditalData}\r\n          />\r\n        );\r\n      case 8:\r\n        return (\r\n          <EditalStep8\r\n            data={editalData}\r\n            onUpdate={updateEditalData}\r\n            selectedTR={selectedTR}\r\n            onFinalize={handleFinalize}\r\n          />\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  const progress = (currentStep / 8) * 100;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-lg w-full max-w-7xl h-[95vh] flex flex-col\">\r\n        {/* Header */}\r\n        <div className=\"p-6 border-b flex-shrink-0\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <div>\r\n              <h2 className=\"text-xl font-bold text-gray-900\">Cria√ß√£o de Edital</h2>\r\n              <p className=\"text-sm text-gray-600\">TR: {selectedTR.numero_tr} - {selectedTR.objeto}</p>\r\n            </div>\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Button variant=\"outline\" onClick={handleSave} disabled={loading}>\r\n                {loading ? <Loader2 className=\"h-4 w-4 animate-spin mr-1\" /> : <Save className=\"h-4 w-4 mr-1\" />}\r\n                Salvar\r\n              </Button>\r\n              <Button variant=\"ghost\" onClick={onClose}>\r\n                <X size={20} />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Progress */}\r\n          <div className=\"mb-4\">\r\n            <div className=\"flex items-center justify-between mb-2\">\r\n              <span className=\"text-sm font-medium text-gray-700\">\r\n                Etapa {currentStep} de 8\r\n              </span>\r\n              <span className=\"text-sm text-gray-500\">\r\n                {Math.round(progress)}% conclu√≠do\r\n              </span>\r\n            </div>\r\n            <Progress value={progress} className=\"h-2\" />\r\n          </div>\r\n\r\n          {/* Steps Navigation */}\r\n          <div className=\"flex items-center justify-between\">\r\n            {steps.map((step) => {\r\n              const status = getStepStatus(step.number);\r\n              const Icon = step.icon;\r\n\r\n              return (\r\n                <div\r\n                  key={step.number}\r\n                  className={`flex flex-col items-center cursor-pointer transition-all\r\n                    ${status === 'current' ? 'text-blue-600' :\r\n                      status === 'completed' ? 'text-green-600' :\r\n                        status === 'error' ? 'text-red-600' : 'text-gray-400'}`}\r\n                  onClick={() => setCurrentStep(step.number)}\r\n                >\r\n                  <div className={`w-10 h-10 rounded-full flex items-center justify-center mb-2 transition-all\r\n                    ${status === 'current' ? 'bg-blue-100 border-2 border-blue-600' :\r\n                      status === 'completed' ? 'bg-green-100 border-2 border-green-600' :\r\n                        status === 'error' ? 'bg-red-100 border-2 border-red-600' : 'bg-gray-100 border-2 border-gray-300'}`}\r\n                  >\r\n                    {status === 'completed' ? (\r\n                      <CheckCircle className=\"h-5 w-5\" />\r\n                    ) : status === 'error' ? (\r\n                      <AlertCircle className=\"h-5 w-5\" />\r\n                    ) : (\r\n                      <Icon className=\"h-5 w-5\" />\r\n                    )}\r\n                  </div>\r\n                  <div className=\"text-center\">\r\n                    <div className=\"text-xs font-medium\">{step.title}</div>\r\n                    <div className=\"text-xs text-gray-500 hidden md:block\">{step.description}</div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-auto\">\r\n          {renderStep()}\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"p-6 border-t bg-gray-50 flex-shrink-0\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={handlePrevious}\r\n              disabled={currentStep === 1}\r\n            >\r\n              <ArrowLeft className=\"h-4 w-4 mr-1\" />\r\n              Anterior\r\n            </Button>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Badge variant=\"outline\">\r\n                Etapa {currentStep}/8\r\n              </Badge>\r\n            </div>\r\n\r\n            {currentStep < 8 ? (\r\n              <Button onClick={handleNext} disabled={loading}>\r\n                Pr√≥ximo\r\n                <ArrowRight className=\"h-4 w-4 ml-1\" />\r\n              </Button>\r\n            ) : (\r\n              <Button\r\n                onClick={handleFinalize}\r\n                className=\"bg-green-600 hover:bg-green-700\"\r\n                disabled={loading}\r\n              >\r\n                {loading ? <Loader2 className=\"h-4 w-4 animate-spin mr-2\" /> : null}\r\n                Finalizar Edital\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditalWizard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Edital\\steps\\EditalStep1.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[601,604],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[601,604],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[642,645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[642,645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Sparkles } from 'lucide-react';\r\nimport { DbTermoReferencia } from '@/types/database';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface EditalStep1Props {\r\n  data: any;\r\n  onUpdate: (field: string, value: any) => void;\r\n  selectedTR: DbTermoReferencia;\r\n}\r\n\r\nconst EditalStep1 = ({ data, onUpdate, selectedTR }: EditalStep1Props) => {\r\n  const { toast } = useToast();\r\n\r\n  const handleAIGenerate = (field: string) => {\r\n    toast({\r\n      title: \"IA Ativada\",\r\n      description: \"Gerando conte√∫do com base no TR e dados do sistema...\",\r\n    });\r\n\r\n    // Simula√ß√£o de gera√ß√£o por IA\r\n    setTimeout(() => {\r\n      if (field === 'objetoLicitacao') {\r\n        const aiContent = `${selectedTR.objeto} - conforme especifica√ß√µes t√©cnicas detalhadas no Termo de Refer√™ncia ${selectedTR.numero_tr}, visando atender √†s necessidades da secretaria solicitante.`;\r\n        onUpdate(field, aiContent);\r\n      }\r\n\r\n      toast({\r\n        title: \"Conte√∫do Gerado\",\r\n        description: \"Texto gerado com sucesso. Voc√™ pode edit√°-lo se necess√°rio.\",\r\n      });\r\n    }, 2000);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center space-x-2 mb-6\">\r\n        <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n          <span className=\"text-blue-600 font-bold\">1</span>\r\n        </div>\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">Identifica√ß√£o e Objeto</h3>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Dados da Licita√ß√£o</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"numeroEdital\">N√∫mero do Edital *</Label>\r\n              <Input\r\n                id=\"numeroEdital\"\r\n                value={data.numeroEdital}\r\n                onChange={(e) => onUpdate('numeroEdital', e.target.value)}\r\n                placeholder=\"Ex: ED-0001/2024\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Gerado automaticamente</p>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"orgaoResponsavel\">√ìrg√£o Respons√°vel *</Label>\r\n              <Input\r\n                id=\"orgaoResponsavel\"\r\n                value={data.orgaoResponsavel}\r\n                onChange={(e) => onUpdate('orgaoResponsavel', e.target.value)}\r\n                placeholder=\"Nome da prefeitura/√≥rg√£o\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"unidadeGestora\">Unidade Gestora *</Label>\r\n              <Input\r\n                id=\"unidadeGestora\"\r\n                value={data.unidadeGestora}\r\n                onChange={(e) => onUpdate('unidadeGestora', e.target.value)}\r\n                placeholder=\"Secretaria respons√°vel\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"modalidadeLicitacao\">Modalidade da Licita√ß√£o *</Label>\r\n              <Select value={data.modalidadeLicitacao} onValueChange={(value) => onUpdate('modalidadeLicitacao', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione a modalidade\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"pregao-eletronico\">Preg√£o Eletr√¥nico</SelectItem>\r\n                  <SelectItem value=\"pregao-presencial\">Preg√£o Presencial</SelectItem>\r\n                  <SelectItem value=\"concorrencia\">Concorr√™ncia</SelectItem>\r\n                  <SelectItem value=\"tomada-precos\">Tomada de Pre√ßos</SelectItem>\r\n                  <SelectItem value=\"convite\">Convite</SelectItem>\r\n                  <SelectItem value=\"dispensa\">Dispensa de Licita√ß√£o</SelectItem>\r\n                  <SelectItem value=\"inexigibilidade\">Inexigibilidade</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Respons√°vel T√©cnico</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"responsavelTecnico\">Nome do Respons√°vel *</Label>\r\n              <Input\r\n                id=\"responsavelTecnico\"\r\n                value={data.responsavelTecnico}\r\n                onChange={(e) => onUpdate('responsavelTecnico', e.target.value)}\r\n                placeholder=\"Nome completo\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"cargoResponsavel\">Cargo/Fun√ß√£o</Label>\r\n              <Input\r\n                id=\"cargoResponsavel\"\r\n                value={data.cargoResponsavel}\r\n                onChange={(e) => onUpdate('cargoResponsavel', e.target.value)}\r\n                placeholder=\"Ex: Respons√°vel T√©cnico, Secret√°rio\"\r\n              />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800\">Objeto da Licita√ß√£o</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <Label htmlFor=\"objetoLicitacao\">Descri√ß√£o do Objeto *</Label>\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => handleAIGenerate('objetoLicitacao')}\r\n                className=\"flex items-center space-x-1\"\r\n              >\r\n                <Sparkles className=\"h-4 w-4\" />\r\n                <span>Gerar com IA</span>\r\n              </Button>\r\n            </div>\r\n            <Textarea\r\n              id=\"objetoLicitacao\"\r\n              value={data.objetoLicitacao}\r\n              onChange={(e) => onUpdate('objetoLicitacao', e.target.value)}\r\n              placeholder=\"Descreva detalhadamente o objeto da licita√ß√£o...\"\r\n              rows={4}\r\n            />\r\n            <p className=\"text-xs text-gray-500\">\r\n              Preenchido automaticamente do TR. Voc√™ pode editar ou usar a IA para aprimorar.\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-blue-900 mb-2\">Informa√ß√µes do TR Vinculado</h4>\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\r\n          <div>\r\n            <span className=\"text-blue-700 font-medium\">TR:</span> {selectedTR.numero_tr}\r\n          </div>\r\n          <div>\r\n            <span className=\"text-blue-700 font-medium\">Data:</span> {new Date(selectedTR.created_at || '').toLocaleDateString('pt-BR')}\r\n          </div>\r\n          <div>\r\n            <span className=\"text-blue-700 font-medium\">Secretaria:</span> {selectedTR.secretaria_id || 'N√£o informada'}\r\n          </div>\r\n          <div>\r\n            <span className=\"text-blue-700 font-medium\">Valor Estimado:</span> {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(selectedTR.valor_estimado)}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditalStep1;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Edital\\steps\\EditalStep2.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[603,606],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[603,606],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[644,647],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[644,647],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Sparkles } from 'lucide-react';\r\nimport { DbTermoReferencia } from '@/types/database';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface EditalStep2Props {\r\n  data: any;\r\n  onUpdate: (field: string, value: any) => void;\r\n  selectedTR: DbTermoReferencia;\r\n}\r\n\r\nconst EditalStep2 = ({ data, onUpdate, selectedTR }: EditalStep2Props) => {\r\n  const { toast } = useToast();\r\n\r\n  const handleAIGenerate = (field: string) => {\r\n    toast({\r\n      title: \"IA Ativada\",\r\n      description: \"Gerando conte√∫do com base no TR e dados do sistema...\",\r\n    });\r\n\r\n    setTimeout(() => {\r\n      let aiContent = '';\r\n\r\n      switch (field) {\r\n        case 'justificativaCriterio':\r\n          aiContent = `O crit√©rio de menor pre√ßo √© adequado para este tipo de contrata√ß√£o, considerando que o objeto possui especifica√ß√µes t√©cnicas padronizadas e bem definidas no Termo de Refer√™ncia, n√£o havendo necessidade de avalia√ß√£o t√©cnica diferenciada entre as propostas.`;\r\n          break;\r\n        case 'justificativaRegistroPrecos':\r\n          aiContent = `A ado√ß√£o do Sistema de Registro de Pre√ßos se justifica pela necessidade de aquisi√ß√µes de forma parcelada, conforme demanda da Administra√ß√£o, durante o per√≠odo de vig√™ncia da Ata de Registro de Pre√ßos, proporcionando economia de recursos p√∫blicos e maior efici√™ncia na gest√£o dos contratos.`;\r\n          break;\r\n      }\r\n\r\n      onUpdate(field, aiContent);\r\n\r\n      toast({\r\n        title: \"Conte√∫do Gerado\",\r\n        description: \"Texto gerado com sucesso. Voc√™ pode edit√°-lo se necess√°rio.\",\r\n      });\r\n    }, 2000);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center space-x-2 mb-6\">\r\n        <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n          <span className=\"text-blue-600 font-bold\">2</span>\r\n        </div>\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">Crit√©rios e Julgamento</h3>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Crit√©rios de Julgamento</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"criterioJulgamento\">Crit√©rio de Julgamento *</Label>\r\n              <Select value={data.criterioJulgamento} onValueChange={(value) => onUpdate('criterioJulgamento', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione o crit√©rio\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"menor-preco\">Menor Pre√ßo</SelectItem>\r\n                  <SelectItem value=\"melhor-tecnica\">Melhor T√©cnica</SelectItem>\r\n                  <SelectItem value=\"tecnica-preco\">T√©cnica e Pre√ßo</SelectItem>\r\n                  <SelectItem value=\"maior-lance\">Maior Lance ou Oferta</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n\r\n            <div>\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <Label htmlFor=\"justificativaCriterio\">Justificativa do Crit√©rio</Label>\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => handleAIGenerate('justificativaCriterio')}\r\n                  className=\"flex items-center space-x-1\"\r\n                >\r\n                  <Sparkles className=\"h-4 w-4\" />\r\n                  <span>Gerar com IA</span>\r\n                </Button>\r\n              </div>\r\n              <Textarea\r\n                id=\"justificativaCriterio\"\r\n                value={data.justificativaCriterio}\r\n                onChange={(e) => onUpdate('justificativaCriterio', e.target.value)}\r\n                placeholder=\"Justifique a escolha do crit√©rio de julgamento...\"\r\n                rows={3}\r\n              />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Execu√ß√£o e Entrega</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"tipoExecucao\">Tipo de Execu√ß√£o *</Label>\r\n              <Select value={data.tipoExecucao} onValueChange={(value) => onUpdate('tipoExecucao', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione o tipo\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"direta\">Execu√ß√£o Direta</SelectItem>\r\n                  <SelectItem value=\"indireta\">Execu√ß√£o Indireta</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"tipoEntrega\">Tipo de Entrega</Label>\r\n              <Select value={data.tipoEntrega} onValueChange={(value) => onUpdate('tipoEntrega', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione o tipo\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"unica\">Entrega √önica</SelectItem>\r\n                  <SelectItem value=\"parcelada\">Entrega Parcelada</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"formaFornecimento\">Forma de Fornecimento</Label>\r\n              <Select value={data.formaFornecimento} onValueChange={(value) => onUpdate('formaFornecimento', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione a forma\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"continuo\">Fornecimento Cont√≠nuo</SelectItem>\r\n                  <SelectItem value=\"sob-demanda\">Sob Demanda</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800\">Sistema de Registro de Pre√ßos</CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-4\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Switch\r\n              id=\"registroPrecos\"\r\n              checked={data.registroPrecos}\r\n              onCheckedChange={(checked) => onUpdate('registroPrecos', checked)}\r\n            />\r\n            <Label htmlFor=\"registroPrecos\">Adotar Sistema de Registro de Pre√ßos (SRP)</Label>\r\n          </div>\r\n          <p className=\"text-xs text-gray-500\">Preenchido automaticamente do TR</p>\r\n\r\n          {data.registroPrecos && (\r\n            <div>\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <Label htmlFor=\"justificativaRegistroPrecos\">Justificativa para SRP *</Label>\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => handleAIGenerate('justificativaRegistroPrecos')}\r\n                  className=\"flex items-center space-x-1\"\r\n                >\r\n                  <Sparkles className=\"h-4 w-4\" />\r\n                  <span>Gerar com IA</span>\r\n                </Button>\r\n              </div>\r\n              <Textarea\r\n                id=\"justificativaRegistroPrecos\"\r\n                value={data.justificativaRegistroPrecos}\r\n                onChange={(e) => onUpdate('justificativaRegistroPrecos', e.target.value)}\r\n                placeholder=\"Justifique a ado√ß√£o do Sistema de Registro de Pre√ßos...\"\r\n                rows={3}\r\n              />\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-green-900 mb-2\">Informa√ß√µes Autom√°ticas do TR</h4>\r\n        <div className=\"text-sm text-green-800\">\r\n          <p>‚Ä¢ Crit√©rio de julgamento baseado na natureza do objeto definida no TR</p>\r\n          <p>‚Ä¢ Formas de entrega e fornecimento conforme especificado no planejamento</p>\r\n          <p>‚Ä¢ Sistema de Registro de Pre√ßos conforme an√°lise pr√©via da demanda</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditalStep2;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Edital\\steps\\EditalStep3.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[657,660],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[657,660],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[698,701],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[698,701],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Sparkles } from 'lucide-react';\r\nimport { DbTermoReferencia } from '@/types/database';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface EditalStep3Props {\r\n  data: any;\r\n  onUpdate: (field: string, value: any) => void;\r\n  selectedTR: DbTermoReferencia;\r\n}\r\n\r\nconst EditalStep3 = ({ data, onUpdate, selectedTR }: EditalStep3Props) => {\r\n  const { toast } = useToast();\r\n\r\n  const handleAIGenerate = (field: string) => {\r\n    toast({\r\n      title: \"IA Ativada\",\r\n      description: \"Gerando conte√∫do com base no TR e dados do sistema...\",\r\n    });\r\n\r\n    setTimeout(() => {\r\n      let aiContent = '';\r\n\r\n      switch (field) {\r\n        case 'justificativaConsorcios':\r\n          aiContent = `A n√£o participa√ß√£o de cons√≥rcios se fundamenta na natureza e complexidade do objeto, que n√£o exige conjuga√ß√£o de especialidades ou capacidades t√©cnicas distintas, podendo ser executado por empresas individualmente, conforme art. 35 da Lei 14.133/2021.`;\r\n          break;\r\n        case 'justificativaVistoria':\r\n          aiContent = `A vistoria √© facultativa, considerando que as especifica√ß√µes t√©cnicas est√£o suficientemente detalhadas no Termo de Refer√™ncia, permitindo aos licitantes formularem suas propostas com base nas informa√ß√µes disponibilizadas.`;\r\n          break;\r\n        case 'criteriosDesempate':\r\n          aiContent = `Em caso de empate, ser√° aplicado o crit√©rio de desempate previsto no art. 60 da Lei 14.133/2021, com prefer√™ncia para bens e servi√ßos produzidos no Pa√≠s, seguindo-se os demais crit√©rios legais estabelecidos.`;\r\n          break;\r\n      }\r\n\r\n      onUpdate(field, aiContent);\r\n\r\n      toast({\r\n        title: \"Conte√∫do Gerado\",\r\n        description: \"Texto gerado com sucesso. Voc√™ pode edit√°-lo se necess√°rio.\",\r\n      });\r\n    }, 2000);\r\n  };\r\n\r\n  const documentosHabilitacao = [\r\n    'Habilita√ß√£o Jur√≠dica - Pessoa F√≠sica',\r\n    'Habilita√ß√£o Jur√≠dica - Pessoa Jur√≠dica',\r\n    'Regularidade Fiscal Federal',\r\n    'Regularidade com FGTS',\r\n    'Regularidade Trabalhista',\r\n    'Qualifica√ß√£o Econ√¥mico-Financeira',\r\n    'Qualifica√ß√£o T√©cnica',\r\n    'Declara√ß√£o de Cumprimento de Requisitos'\r\n  ];\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center space-x-2 mb-6\">\r\n        <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n          <span className=\"text-blue-600 font-bold\">3</span>\r\n        </div>\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">Condi√ß√µes de Participa√ß√£o e Habilita√ß√£o</h3>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Participa√ß√£o</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"space-y-3\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Switch\r\n                  id=\"permiteMEEPP\"\r\n                  checked={data.permiteMEEPP}\r\n                  onCheckedChange={(checked) => onUpdate('permiteMEEPP', checked)}\r\n                />\r\n                <Label htmlFor=\"permiteMEEPP\">Tratamento Diferenciado para ME/EPP</Label>\r\n              </div>\r\n\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Switch\r\n                  id=\"permiteConsorcios\"\r\n                  checked={data.permiteConsorcios}\r\n                  onCheckedChange={(checked) => onUpdate('permiteConsorcios', checked)}\r\n                />\r\n                <Label htmlFor=\"permiteConsorcios\">Participa√ß√£o de Cons√≥rcios</Label>\r\n              </div>\r\n\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Switch\r\n                  id=\"permiteCooperativas\"\r\n                  checked={data.permiteCooperativas}\r\n                  onCheckedChange={(checked) => onUpdate('permiteCooperativas', checked)}\r\n                />\r\n                <Label htmlFor=\"permiteCooperativas\">Participa√ß√£o de Cooperativas</Label>\r\n              </div>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500\">Preenchido automaticamente do TR</p>\r\n\r\n            {!data.permiteConsorcios && (\r\n              <div>\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <Label htmlFor=\"justificativaConsorcios\">Justificativa (n√£o cons√≥rcio)</Label>\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => handleAIGenerate('justificativaConsorcios')}\r\n                    className=\"flex items-center space-x-1\"\r\n                  >\r\n                    <Sparkles className=\"h-4 w-4\" />\r\n                    <span>Gerar com IA</span>\r\n                  </Button>\r\n                </div>\r\n                <Textarea\r\n                  id=\"justificativaConsorcios\"\r\n                  value={data.justificativaConsorcios}\r\n                  onChange={(e) => onUpdate('justificativaConsorcios', e.target.value)}\r\n                  placeholder=\"Justifique por que n√£o permite cons√≥rcios...\"\r\n                  rows={3}\r\n                />\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Vistoria T√©cnica</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"vistoriaTecnica\">Tipo de Vistoria *</Label>\r\n              <Select value={data.vistoriaTecnica} onValueChange={(value) => onUpdate('vistoriaTecnica', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione o tipo\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"obrigatoria\">Obrigat√≥ria</SelectItem>\r\n                  <SelectItem value=\"facultativa\">Facultativa</SelectItem>\r\n                  <SelectItem value=\"nao-aplicavel\">N√£o Aplic√°vel</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n\r\n            {data.vistoriaTecnica !== 'nao-aplicavel' && (\r\n              <div>\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <Label htmlFor=\"justificativaVistoria\">Justificativa da Vistoria</Label>\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    onClick={() => handleAIGenerate('justificativaVistoria')}\r\n                    className=\"flex items-center space-x-1\"\r\n                  >\r\n                    <Sparkles className=\"h-4 w-4\" />\r\n                    <span>Gerar com IA</span>\r\n                  </Button>\r\n                </div>\r\n                <Textarea\r\n                  id=\"justificativaVistoria\"\r\n                  value={data.justificativaVistoria}\r\n                  onChange={(e) => onUpdate('justificativaVistoria', e.target.value)}\r\n                  placeholder=\"Justifique a necessidade da vistoria...\"\r\n                  rows={3}\r\n                />\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800\">Crit√©rios de Desempate</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <Label htmlFor=\"criteriosDesempate\">Crit√©rios de Desempate</Label>\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => handleAIGenerate('criteriosDesempate')}\r\n              className=\"flex items-center space-x-1\"\r\n            >\r\n              <Sparkles className=\"h-4 w-4\" />\r\n              <span>Gerar com IA</span>\r\n            </Button>\r\n          </div>\r\n          <Textarea\r\n            id=\"criteriosDesempate\"\r\n            value={data.criteriosDesempate}\r\n            onChange={(e) => onUpdate('criteriosDesempate', e.target.value)}\r\n            placeholder=\"Defina os crit√©rios de desempate conforme Lei 14.133/2021...\"\r\n            rows={3}\r\n          />\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800\">Documenta√ß√£o Exigida</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <p className=\"text-sm text-gray-600 mb-4\">\r\n            Documentos de habilita√ß√£o conforme Lei 14.133/2021 (preenchido automaticamente do TR):\r\n          </p>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2\">\r\n            {documentosHabilitacao.map((doc, index) => (\r\n              <div key={index} className=\"flex items-center space-x-2\">\r\n                <Checkbox\r\n                  id={`doc-${index}`}\r\n                  checked={true}\r\n                  disabled\r\n                />\r\n                <Label htmlFor={`doc-${index}`} className=\"text-sm\">\r\n                  {doc}\r\n                </Label>\r\n              </div>\r\n            ))}\r\n          </div>\r\n          <p className=\"text-xs text-gray-500 mt-2\">\r\n            Lista completa preenchida automaticamente do TR\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditalStep3;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Edital\\steps\\EditalStep4.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[441,444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[441,444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[482,485],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[482,485],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Sparkles } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface EditalStep4Props {\r\n  data: any;\r\n  onUpdate: (field: string, value: any) => void;\r\n}\r\n\r\nconst EditalStep4 = ({ data, onUpdate }: EditalStep4Props) => {\r\n  const { toast } = useToast();\r\n\r\n  const handleAIGenerate = (field: string) => {\r\n    toast({\r\n      title: \"IA Ativada\",\r\n      description: \"Gerando conte√∫do com base nas melhores pr√°ticas legais...\",\r\n    });\r\n    \r\n    setTimeout(() => {\r\n      let aiContent = '';\r\n      \r\n      switch (field) {\r\n        case 'procedimentosRecursos':\r\n          aiContent = `Os recursos dever√£o ser interpostos no prazo de 3 (tr√™s) dias √∫teis, contados da intima√ß√£o do ato ou da lavratura da ata, conforme art. 164 da Lei 14.133/2021. O recurso dever√° ser dirigido √† autoridade superior, por interm√©dio da que praticou o ato recorrido, sendo protocolado na Comiss√£o de Licita√ß√£o durante o hor√°rio de expediente.`;\r\n          break;\r\n        case 'penalidadesPrevistas':\r\n          aiContent = `Pelo descumprimento das obriga√ß√µes contratuais, o contratado ficar√° sujeito √†s seguintes penalidades: a) Advert√™ncia; b) Multa de mora de 0,5% ao dia sobre o valor do contrato; c) Multa de 10% sobre o valor do contrato; d) Suspens√£o tempor√°ria do direito de licitar; e) Declara√ß√£o de inidoneidade, conforme arts. 155 a 163 da Lei 14.133/2021.`;\r\n          break;\r\n      }\r\n      \r\n      onUpdate(field, aiContent);\r\n      \r\n      toast({\r\n        title: \"Conte√∫do Gerado\",\r\n        description: \"Texto gerado com sucesso. Voc√™ pode edit√°-lo se necess√°rio.\",\r\n      });\r\n    }, 2000);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center space-x-2 mb-6\">\r\n        <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n          <span className=\"text-blue-600 font-bold\">4</span>\r\n        </div>\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">Recursos e Penalidades</h3>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800\">Procedimentos para Recursos</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <Label htmlFor=\"procedimentosRecursos\">Procedimentos para Apresenta√ß√£o de Recursos *</Label>\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => handleAIGenerate('procedimentosRecursos')}\r\n              className=\"flex items-center space-x-1\"\r\n            >\r\n              <Sparkles className=\"h-4 w-4\" />\r\n              <span>Gerar com IA</span>\r\n            </Button>\r\n          </div>\r\n          <Textarea\r\n            id=\"procedimentosRecursos\"\r\n            value={data.procedimentosRecursos}\r\n            onChange={(e) => onUpdate('procedimentosRecursos', e.target.value)}\r\n            placeholder=\"Descreva os procedimentos para apresenta√ß√£o de recursos...\"\r\n            rows={6}\r\n          />\r\n          <p className=\"text-xs text-gray-500 mt-1\">\r\n            Defina os prazos e procedimentos conforme Lei 14.133/2021\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800\">Penalidades</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex items-center justify-between mb-2\">\r\n            <Label htmlFor=\"penalidadesPrevistas\">Penalidades Previstas</Label>\r\n            <Button\r\n              type=\"button\"\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              onClick={() => handleAIGenerate('penalidadesPrevistas')}\r\n              className=\"flex items-center space-x-1\"\r\n            >\r\n              <Sparkles className=\"h-4 w-4\" />\r\n              <span>Gerar com IA</span>\r\n            </Button>\r\n          </div>\r\n          <Textarea\r\n            id=\"penalidadesPrevistas\"\r\n            value={data.penalidadesPrevistas}\r\n            onChange={(e) => onUpdate('penalidadesPrevistas', e.target.value)}\r\n            placeholder=\"Descreva as penalidades aplic√°veis conforme Lei 14.133/2021...\"\r\n            rows={6}\r\n          />\r\n          <p className=\"text-xs text-gray-500 mt-1\">\r\n            Inclua multas, suspens√£o e outras penalidades previstas em lei\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800\">Respons√°vel pelo Julgamento</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div>\r\n            <Label htmlFor=\"responsavelJulgamento\">Nome do Respons√°vel pelo Julgamento dos Recursos</Label>\r\n            <Input\r\n              id=\"responsavelJulgamento\"\r\n              value={data.responsavelJulgamento}\r\n              onChange={(e) => onUpdate('responsavelJulgamento', e.target.value)}\r\n              placeholder=\"Nome e cargo da autoridade superior\"\r\n            />\r\n            <p className=\"text-xs text-gray-500 mt-1\">\r\n              Autoridade competente para julgar os recursos interpostos\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-amber-900 mb-2\">‚öñÔ∏è Conformidade Legal</h4>\r\n        <div className=\"text-sm text-amber-800\">\r\n          <p>‚Ä¢ Prazos de recursos conforme art. 164 da Lei 14.133/2021</p>\r\n          <p>‚Ä¢ Penalidades baseadas nos arts. 155 a 163 da Lei 14.133/2021</p>\r\n          <p>‚Ä¢ Compet√™ncia para julgamento conforme hierarquia administrativa</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditalStep4;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Edital\\steps\\EditalStep5.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[651,654],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[651,654],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[692,695],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[692,695],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1051,1054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1051,1054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":43,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1541,1544],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1541,1544],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Plus, X } from 'lucide-react';\r\nimport { DbTermoReferencia } from '@/types/database';\r\n\r\ninterface EditalStep5Props {\r\n  data: any;\r\n  onUpdate: (field: string, value: any) => void;\r\n  selectedTR: DbTermoReferencia;\r\n}\r\n\r\nconst EditalStep5 = ({ data, onUpdate, selectedTR }: EditalStep5Props) => {\r\n  const addGestor = () => {\r\n    const newGestores = [...(data.gestores || []), ''];\r\n    onUpdate('gestores', newGestores);\r\n  };\r\n\r\n  const removeGestor = (index: number) => {\r\n    const newGestores = data.gestores.filter((_: any, i: number) => i !== index);\r\n    onUpdate('gestores', newGestores);\r\n  };\r\n\r\n  const updateGestor = (index: number, value: string) => {\r\n    const newGestores = [...data.gestores];\r\n    newGestores[index] = value;\r\n    onUpdate('gestores', newGestores);\r\n  };\r\n\r\n  const addFiscal = () => {\r\n    const newFiscais = [...(data.fiscais || []), ''];\r\n    onUpdate('fiscais', newFiscais);\r\n  };\r\n\r\n  const removeFiscal = (index: number) => {\r\n    const newFiscais = data.fiscais.filter((_: any, i: number) => i !== index);\r\n    onUpdate('fiscais', newFiscais);\r\n  };\r\n\r\n  const updateFiscal = (index: number, value: string) => {\r\n    const newFiscais = [...data.fiscais];\r\n    newFiscais[index] = value;\r\n    onUpdate('fiscais', newFiscais);\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center space-x-2 mb-6\">\r\n        <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n          <span className=\"text-blue-600 font-bold\">5</span>\r\n        </div>\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">Execu√ß√£o Contratual</h3>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Pagamento</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"formaPagamento\">Forma de Pagamento *</Label>\r\n              <Select value={data.formaPagamento} onValueChange={(value) => onUpdate('formaPagamento', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione a forma\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"a-vista\">√Ä Vista</SelectItem>\r\n                  <SelectItem value=\"parcelado\">Parcelado</SelectItem>\r\n                  <SelectItem value=\"pos-entrega\">Ap√≥s Entrega</SelectItem>\r\n                  <SelectItem value=\"mensal\">Mensal</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"prazoPagamento\">Prazo de Pagamento (dias)</Label>\r\n              <Input\r\n                id=\"prazoPagamento\"\r\n                type=\"number\"\r\n                value={data.prazoPagamento}\r\n                onChange={(e) => onUpdate('prazoPagamento', e.target.value)}\r\n                placeholder=\"30\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Ap√≥s emiss√£o da Nota Fiscal eletr√¥nica</p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Prazos de Execu√ß√£o</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"prazosExecucao\">Prazo de Execu√ß√£o (dias)</Label>\r\n              <Input\r\n                id=\"prazosExecucao\"\r\n                type=\"number\"\r\n                value={data.prazosExecucao}\r\n                onChange={(e) => onUpdate('prazosExecucao', e.target.value)}\r\n                placeholder=\"60\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"vigenciaContrato\">Vig√™ncia do Contrato (meses)</Label>\r\n              <Input\r\n                id=\"vigenciaContrato\"\r\n                type=\"number\"\r\n                value={data.vigenciaContrato}\r\n                onChange={(e) => onUpdate('vigenciaContrato', e.target.value)}\r\n                placeholder=\"12\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Preenchido automaticamente do TR</p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Garantia Contratual</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Switch\r\n                id=\"garantiaContratual\"\r\n                checked={data.garantiaContratual}\r\n                onCheckedChange={(checked) => onUpdate('garantiaContratual', checked)}\r\n              />\r\n              <Label htmlFor=\"garantiaContratual\">Exigir Garantia Contratual</Label>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500\">Preenchido automaticamente do TR</p>\r\n\r\n            {data.garantiaContratual && (\r\n              <div>\r\n                <Label htmlFor=\"especificacaoGarantia\">Especifica√ß√£o da Garantia</Label>\r\n                <Textarea\r\n                  id=\"especificacaoGarantia\"\r\n                  value={data.especificacaoGarantia}\r\n                  onChange={(e) => onUpdate('especificacaoGarantia', e.target.value)}\r\n                  placeholder=\"Especifique o tipo e percentual da garantia...\"\r\n                  rows={3}\r\n                />\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Subcontrata√ß√£o</CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Switch\r\n                id=\"subcontratacao\"\r\n                checked={data.subcontratacao}\r\n                onCheckedChange={(checked) => onUpdate('subcontratacao', checked)}\r\n              />\r\n              <Label htmlFor=\"subcontratacao\">Permitir Subcontrata√ß√£o</Label>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500\">Preenchido automaticamente do TR</p>\r\n\r\n            {data.subcontratacao && (\r\n              <div>\r\n                <Label htmlFor=\"detalhesSubcontratacao\">Detalhes da Subcontrata√ß√£o</Label>\r\n                <Textarea\r\n                  id=\"detalhesSubcontratacao\"\r\n                  value={data.detalhesSubcontratacao}\r\n                  onChange={(e) => onUpdate('detalhesSubcontratacao', e.target.value)}\r\n                  placeholder=\"Especifique as condi√ß√µes para subcontrata√ß√£o...\"\r\n                  rows={3}\r\n                />\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800 flex items-center justify-between\">\r\n              Gestores do Contrato\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={addGestor}\r\n              >\r\n                <Plus className=\"h-4 w-4\" />\r\n              </Button>\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-3\">\r\n            {data.gestores?.map((gestor: string, index: number) => (\r\n              <div key={index} className=\"flex items-center space-x-2\">\r\n                <Input\r\n                  value={gestor}\r\n                  onChange={(e) => updateGestor(index, e.target.value)}\r\n                  placeholder=\"Nome do gestor\"\r\n                />\r\n                {data.gestores.length > 1 && (\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    onClick={() => removeGestor(index)}\r\n                  >\r\n                    <X className=\"h-4 w-4\" />\r\n                  </Button>\r\n                )}\r\n              </div>\r\n            ))}\r\n            <p className=\"text-xs text-gray-500\">Preenchido automaticamente do TR</p>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800 flex items-center justify-between\">\r\n              Fiscais do Contrato\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={addFiscal}\r\n              >\r\n                <Plus className=\"h-4 w-4\" />\r\n              </Button>\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-3\">\r\n            {data.fiscais?.length > 0 ? (\r\n              data.fiscais.map((fiscal: string, index: number) => (\r\n                <div key={index} className=\"flex items-center space-x-2\">\r\n                  <Input\r\n                    value={fiscal}\r\n                    onChange={(e) => updateFiscal(index, e.target.value)}\r\n                    placeholder=\"Nome do fiscal\"\r\n                  />\r\n                  <Button\r\n                    type=\"button\"\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    onClick={() => removeFiscal(index)}\r\n                  >\r\n                    <X className=\"h-4 w-4\" />\r\n                  </Button>\r\n                </div>\r\n              ))\r\n            ) : (\r\n              <p className=\"text-sm text-gray-500\">Nenhum fiscal adicionado</p>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditalStep5;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Edital\\steps\\EditalStep6.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[457,460],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[457,460],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[498,501],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[498,501],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[732,735],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[732,735],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1051,1054],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1051,1054],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3413,3416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3413,3416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { DbTermoReferencia } from '@/types/database';\r\n\r\ninterface EditalStep6Props {\r\n  data: any;\r\n  onUpdate: (field: string, value: any) => void;\r\n  selectedTR: DbTermoReferencia;\r\n}\r\n\r\nconst EditalStep6 = ({ data, onUpdate, selectedTR }: EditalStep6Props) => {\r\n  // Carregar itens do TR (armazenados no dados_json)\r\n  const itemsFromTR = (selectedTR.dados_json as any)?.items || [];\r\n\r\n  const items = itemsFromTR.length > 0 ? itemsFromTR : [\r\n    {\r\n      id: 1,\r\n      descricao: 'Item n√£o encontrado ou TR vazio',\r\n      unidade: 'N/A',\r\n      quantidade: 0,\r\n      valorUnitario: 0,\r\n      valorTotal: 0\r\n    }\r\n  ];\r\n\r\n  const valorTotalGeral = items.reduce((acc: number, item: any) => acc + (parseFloat(item.valorTotal) || 0), 0);\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center space-x-2 mb-6\">\r\n        <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n          <span className=\"text-blue-600 font-bold\">6</span>\r\n        </div>\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">Itens da Licita√ß√£o</h3>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800 flex items-center justify-between\">\r\n            Configura√ß√µes de Exibi√ß√£o\r\n            <Badge variant=\"outline\" className=\"bg-blue-50\">\r\n              Baseado no TR/DFD/PCA\r\n            </Badge>\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Switch\r\n              id=\"exibirValorEstimado\"\r\n              checked={data.exibirValorEstimado}\r\n              onCheckedChange={(checked) => onUpdate('exibirValorEstimado', checked)}\r\n            />\r\n            <Label htmlFor=\"exibirValorEstimado\">Exibir Valor Estimado no Edital</Label>\r\n          </div>\r\n          <p className=\"text-xs text-gray-500 mt-2\">\r\n            {data.exibirValorEstimado\r\n              ? 'Os valores estimados ser√£o vis√≠veis aos licitantes'\r\n              : 'Os valores ser√£o mantidos em sigilo (envelope lacrado)'\r\n            }\r\n          </p>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800\">Lista de Itens</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"overflow-x-auto\">\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Item</TableHead>\r\n                  <TableHead>Descri√ß√£o</TableHead>\r\n                  <TableHead>Unidade</TableHead>\r\n                  <TableHead className=\"text-right\">Quantidade</TableHead>\r\n                  {data.exibirValorEstimado && (\r\n                    <>\r\n                      <TableHead className=\"text-right\">Valor Unit.</TableHead>\r\n                      <TableHead className=\"text-right\">Valor Total</TableHead>\r\n                    </>\r\n                  )}\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {items.map((item: any, index: number) => (\r\n                  <TableRow key={index}>\r\n                    <TableCell className=\"font-medium\">{index + 1}</TableCell>\r\n                    <TableCell>{item.descricao || item.item}</TableCell>\r\n                    <TableCell>{item.unidade}</TableCell>\r\n                    <TableCell className=\"text-right\">{(parseFloat(item.quantidade) || 0).toLocaleString()}</TableCell>\r\n                    {data.exibirValorEstimado && (\r\n                      <>\r\n                        <TableCell className=\"text-right\">\r\n                          {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(parseFloat(item.valorUnitario) || 0)}\r\n                        </TableCell>\r\n                        <TableCell className=\"text-right font-medium\">\r\n                          {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(parseFloat(item.valorTotal) || 0)}\r\n                        </TableCell>\r\n                      </>\r\n                    )}\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          </div>\r\n\r\n          {data.exibirValorEstimado && (\r\n            <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\r\n              <div className=\"flex justify-between items-center\">\r\n                <span className=\"font-medium text-gray-700\">Valor Total Estimado:</span>\r\n                <span className=\"font-bold text-lg text-green-600\">\r\n                  R$ {valorTotalGeral.toFixed(2).replace('.', ',')}\r\n                </span>\r\n              </div>\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Valores baseados na mediana dos pre√ßos de refer√™ncia\r\n              </p>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-blue-900 mb-2\">üìã Origem dos Itens</h4>\r\n        <div className=\"text-sm text-blue-800 space-y-1\">\r\n          <p>‚Ä¢ Itens importados automaticamente do TR: {selectedTR.numero_tr}</p>\r\n          <p>‚Ä¢ Quantidades consolidadas do planejamento</p>\r\n          <p>‚Ä¢ Valores baseados na pesquisa de pre√ßos do TR</p>\r\n          <p>‚Ä¢ Total de {items.length} itens carregados</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditalStep6;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Edital\\steps\\EditalStep7.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[502,505],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[502,505],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[543,546],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[543,546],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[888,891],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[888,891],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React from 'react';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Sparkles, Calendar } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface EditalStep7Props {\r\n  data: any;\r\n  onUpdate: (field: string, value: any) => void;\r\n}\r\n\r\nconst EditalStep7 = ({ data, onUpdate }: EditalStep7Props) => {\r\n  const { toast } = useToast();\r\n\r\n  const handleAIGenerate = (field: string) => {\r\n    toast({\r\n      title: \"IA Ativada\",\r\n      description: \"Calculando prazos otimizados baseados na modalidade...\",\r\n    });\r\n    \r\n    setTimeout(() => {\r\n      let values: any = {};\r\n      \r\n      switch (field) {\r\n        case 'prazos-otimizados':\r\n          values = {\r\n            prazoPropostas: '8',\r\n            prazoJulgamento: '5',\r\n            prazoImpugnacao: '3'\r\n          };\r\n          break;\r\n      }\r\n      \r\n      Object.keys(values).forEach(key => {\r\n        onUpdate(key, values[key]);\r\n      });\r\n      \r\n      toast({\r\n        title: \"Prazos Otimizados\",\r\n        description: \"Prazos calculados com base nas melhores pr√°ticas.\",\r\n      });\r\n    }, 2000);\r\n  };\r\n\r\n  // Sugest√£o autom√°tica de data baseada no cronograma\r\n  const suggestedDate = new Date();\r\n  suggestedDate.setDate(suggestedDate.getDate() + 30);\r\n  const suggestedDateStr = suggestedDate.toISOString().split('T')[0];\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"flex items-center space-x-2 mb-6\">\r\n        <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n          <span className=\"text-blue-600 font-bold\">7</span>\r\n        </div>\r\n        <h3 className=\"text-lg font-semibold text-gray-900\">Cronograma de Licita√ß√£o</h3>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800 flex items-center space-x-2\">\r\n            <Calendar className=\"h-4 w-4\" />\r\n            <span>Data de Abertura</span>\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div>\r\n            <Label htmlFor=\"dataAbertura\">Data de Abertura da Licita√ß√£o *</Label>\r\n            <Input\r\n              id=\"dataAbertura\"\r\n              type=\"date\"\r\n              value={data.dataAbertura}\r\n              onChange={(e) => onUpdate('dataAbertura', e.target.value)}\r\n              min={new Date().toISOString().split('T')[0]}\r\n            />\r\n            <p className=\"text-xs text-gray-500 mt-1\">\r\n              Sugest√£o baseada no cronograma: {new Date(suggestedDateStr).toLocaleDateString('pt-BR')}\r\n            </p>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800 flex items-center justify-between\">\r\n              Prazos Processuais\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                onClick={() => handleAIGenerate('prazos-otimizados')}\r\n                className=\"flex items-center space-x-1\"\r\n              >\r\n                <Sparkles className=\"h-4 w-4\" />\r\n                <span>Otimizar</span>\r\n              </Button>\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div>\r\n              <Label htmlFor=\"prazoPropostas\">Prazo para Propostas (dias)</Label>\r\n              <Input\r\n                id=\"prazoPropostas\"\r\n                type=\"number\"\r\n                value={data.prazoPropostas}\r\n                onChange={(e) => onUpdate('prazoPropostas', e.target.value)}\r\n                placeholder=\"8\"\r\n                min=\"1\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Prazo m√≠nimo conforme modalidade</p>\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"prazoJulgamento\">Prazo para Julgamento (dias)</Label>\r\n              <Input\r\n                id=\"prazoJulgamento\"\r\n                type=\"number\"\r\n                value={data.prazoJulgamento}\r\n                onChange={(e) => onUpdate('prazoJulgamento', e.target.value)}\r\n                placeholder=\"5\"\r\n                min=\"1\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <Label htmlFor=\"prazoImpugnacao\">Prazo para Impugna√ß√£o (dias)</Label>\r\n              <Input\r\n                id=\"prazoImpugnacao\"\r\n                type=\"number\"\r\n                value={data.prazoImpugnacao}\r\n                onChange={(e) => onUpdate('prazoImpugnacao', e.target.value)}\r\n                placeholder=\"3\"\r\n                min=\"1\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">Antes da data de abertura</p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-base text-gray-800\">Validade das Propostas</CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div>\r\n              <Label htmlFor=\"validadePropostas\">Prazo de Validade das Propostas</Label>\r\n              <Select value={data.validadePropostas} onValueChange={(value) => onUpdate('validadePropostas', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione o prazo\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"30\">30 dias</SelectItem>\r\n                  <SelectItem value=\"60\">60 dias</SelectItem>\r\n                  <SelectItem value=\"90\">90 dias</SelectItem>\r\n                  <SelectItem value=\"120\">120 dias</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Prazo contado da data de abertura das propostas\r\n              </p>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"text-base text-gray-800\">Cronograma Resumido</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {data.dataAbertura && (\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n              <div className=\"bg-blue-50 p-3 rounded-lg text-center\">\r\n                <div className=\"text-xs text-blue-600 font-medium\">Publica√ß√£o</div>\r\n                <div className=\"text-sm font-bold text-blue-900\">\r\n                  {new Date(data.dataAbertura).toLocaleDateString('pt-BR')}\r\n                </div>\r\n                <div className=\"text-xs text-blue-700\">Edital publicado</div>\r\n              </div>\r\n\r\n              <div className=\"bg-amber-50 p-3 rounded-lg text-center\">\r\n                <div className=\"text-xs text-amber-600 font-medium\">Impugna√ß√£o at√©</div>\r\n                <div className=\"text-sm font-bold text-amber-900\">\r\n                  {new Date(new Date(data.dataAbertura).getTime() - (parseInt(data.prazoImpugnacao) * 24 * 60 * 60 * 1000)).toLocaleDateString('pt-BR')}\r\n                </div>\r\n                <div className=\"text-xs text-amber-700\">{data.prazoImpugnacao} dias antes</div>\r\n              </div>\r\n\r\n              <div className=\"bg-green-50 p-3 rounded-lg text-center\">\r\n                <div className=\"text-xs text-green-600 font-medium\">Abertura</div>\r\n                <div className=\"text-sm font-bold text-green-900\">\r\n                  {new Date(data.dataAbertura).toLocaleDateString('pt-BR')}\r\n                </div>\r\n                <div className=\"text-xs text-green-700\">Sess√£o p√∫blica</div>\r\n              </div>\r\n\r\n              <div className=\"bg-purple-50 p-3 rounded-lg text-center\">\r\n                <div className=\"text-xs text-purple-600 font-medium\">Validade</div>\r\n                <div className=\"text-sm font-bold text-purple-900\">\r\n                  {new Date(new Date(data.dataAbertura).getTime() + (parseInt(data.validadePropostas) * 24 * 60 * 60 * 1000)).toLocaleDateString('pt-BR')}\r\n                </div>\r\n                <div className=\"text-xs text-purple-700\">{data.validadePropostas} dias</div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-green-900 mb-2\">‚è∞ Conformidade de Prazos</h4>\r\n        <div className=\"text-sm text-green-800 space-y-1\">\r\n          <p>‚Ä¢ Prazos m√≠nimos conforme modalidade de licita√ß√£o respeitados</p>\r\n          <p>‚Ä¢ Cronograma otimizado para efici√™ncia do processo</p>\r\n          <p>‚Ä¢ Datas calculadas considerando dias √∫teis</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditalStep7;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\Edital\\steps\\EditalStep8.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":9,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":12,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1054,1057],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1054,1057],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1095,1098],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1095,1098],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":277,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":277,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10786,10789],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10786,10789],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { ScrollArea } from '@/components/ui/scroll-area';\r\nimport {\r\n  FileText,\r\n  Upload,\r\n  Wand2,\r\n  Eye,\r\n  Info,\r\n  Paperclip,\r\n  Download,\r\n  Copy,\r\n  CheckCircle,\r\n  Shield,\r\n  Building,\r\n  UserCheck,\r\n  Scale,\r\n  FileCheck,\r\n  Loader2\r\n} from 'lucide-react';\r\nimport { DbTermoReferencia } from '@/types/database';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/components/ui/dialog';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\n\r\ninterface EditalStep8Props {\r\n  data: any;\r\n  onUpdate: (field: string, value: any) => void;\r\n  selectedTR: DbTermoReferencia;\r\n  onFinalize: () => void;\r\n}\r\n\r\nconst EditalStep8 = ({ data, onUpdate, selectedTR, onFinalize }: EditalStep8Props) => {\r\n  // Declara√ß√µes obrigat√≥rias (j√° marcadas por padr√£o)\r\n  const [obligatoryDeclarations, setObligatoryDeclarations] = useState({\r\n    impedimentos: true,\r\n    independente: true,\r\n    habilitacao: true,\r\n    artigo7: true,\r\n    anticorrupcao: true,\r\n    ausenciaImpedimentos: true\r\n  });\r\n\r\n  // Declara√ß√µes opcionais\r\n  const [optionalDeclarations, setOptionalDeclarations] = useState({\r\n    plenoAtendimento: false,\r\n    meEpp: false,\r\n    naoServidorPublico: false,\r\n    capacidadeTecnica: false,\r\n    vistoriaTecnica: false,\r\n    responsabilidadeTecnica: false,\r\n    lgpd: false\r\n  });\r\n\r\n  const [contractType, setContractType] = useState<'upload' | 'standard'>('standard');\r\n  const [proposalType, setProposalType] = useState<'upload' | 'standard' | null>(null);\r\n  const [editingModel, setEditingModel] = useState<string | null>(null);\r\n  const [editingText, setEditingText] = useState('');\r\n\r\n  // Modelos das declara√ß√µes obrigat√≥rias\r\n  const obligatoryModels = {\r\n    impedimentos: {\r\n      title: \"Declara√ß√£o de Inexist√™ncia de Fatos Impeditivos\",\r\n      tooltip: \"Declara que a empresa n√£o possui impedimentos legais para contratar com a administra√ß√£o p√∫blica.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], com sede na [ENDERE√áO COMPLETO], por seu representante legal, DECLARA, sob as penas da lei, que n√£o existem fatos impeditivos para sua participa√ß√£o no presente processo licitat√≥rio, estando ciente da obrigatoriedade de declarar ocorr√™ncias posteriores.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    independente: {\r\n      title: \"Declara√ß√£o de Elabora√ß√£o Independente de Proposta\",\r\n      tooltip: \"Garante que a proposta foi elaborada de forma independente, sem conluio com outros concorrentes.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], por meio de seu representante legal, DECLARA, sob as penas da lei, que a proposta foi elaborada de maneira independente, sem que tenha havido qualquer forma de conluio, ajuste ou combina√ß√£o com outros concorrentes ou terceiros.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    habilitacao: {\r\n      title: \"Declara√ß√£o de Cumprimento dos Requisitos de Habilita√ß√£o\",\r\n      tooltip: \"Confirma que a empresa atende a todos os requisitos de habilita√ß√£o exigidos no edital.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], declara, sob as penas da lei, que cumpre plenamente todos os requisitos de habilita√ß√£o exigidos no edital em ep√≠grafe, estando apta a participar do certame.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    artigo7: {\r\n      title: \"Declara√ß√£o de Cumprimento do Art. 7¬∫, XXXIII da CF/88\",\r\n      tooltip: \"Declara n√£o empregar menor de dezoito anos em trabalho noturno, perigoso ou insalubre.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA, sob as penas da lei, que n√£o emprega menor de dezoito anos em trabalho noturno, perigoso ou insalubre e n√£o emprega menor de dezesseis anos, salvo na condi√ß√£o de aprendiz, a partir de quatorze anos, em cumprimento ao disposto no art. 7¬∫, XXXIII, da Constitui√ß√£o Federal.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    anticorrupcao: {\r\n      title: \"Declara√ß√£o Anticorrup√ß√£o e de Integridade (Lei 12.846/2013)\",\r\n      tooltip: \"Declara conformidade com a Lei Anticorrup√ß√£o e pr√°ticas de integridade empresarial.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA, sob as penas da lei, que n√£o pratica atos lesivos √† administra√ß√£o p√∫blica, nacional ou estrangeira, conforme Lei 12.846/2013, comprometendo-se a manter pr√°ticas de integridade e √©tica empresarial.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    ausenciaImpedimentos: {\r\n      title: \"Declara√ß√£o de Aus√™ncia de Impedimentos Legais (Art. 155 da Lei 14.133/2021)\",\r\n      tooltip: \"Declara aus√™ncia de impedimentos legais conforme o art. 155 da Nova Lei de Licita√ß√µes.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA, sob as penas da lei, que n√£o se enquadra em nenhuma das hip√≥teses de impedimento para participar de licita√ß√µes previstas no art. 155 da Lei 14.133/2021.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    }\r\n  };\r\n\r\n  // Modelos das declara√ß√µes opcionais\r\n  const optionalModels = {\r\n    plenoAtendimento: {\r\n      title: \"Declara√ß√£o de Pleno Atendimento ao Edital\",\r\n      tooltip: \"Declara que a empresa atende integralmente √†s especifica√ß√µes do edital.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA que atende plenamente a todas as especifica√ß√µes t√©cnicas, condi√ß√µes e exig√™ncias constantes do edital e seus anexos.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    meEpp: {\r\n      title: \"Declara√ß√£o de Enquadramento como ME/EPP (LC 123/2006)\",\r\n      tooltip: \"Declara enquadramento como Microempresa ou Empresa de Pequeno Porte.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA que se enquadra como [MICROEMPRESA/EMPRESA DE PEQUENO PORTE], nos termos da Lei Complementar 123/2006, fazendo jus aos benef√≠cios previstos em lei.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    naoServidorPublico: {\r\n      title: \"Declara√ß√£o de N√£o Emprego de Servidor Vinculado ao √ìrg√£o\",\r\n      tooltip: \"Declara que n√£o emprega servidor p√∫blico vinculado ao √≥rg√£o contratante.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA que n√£o possui em seu quadro de funcion√°rios, servidor p√∫blico vinculado ao √≥rg√£o contratante, em conformidade com as veda√ß√µes legais.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    capacidadeTecnica: {\r\n      title: \"Declara√ß√£o de Capacidade T√©cnica\",\r\n      tooltip: \"Declara possuir capacidade t√©cnica para execu√ß√£o do objeto licitado.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA possuir capacidade t√©cnica, recursos humanos e materiais necess√°rios para a perfeita execu√ß√£o do objeto desta licita√ß√£o.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    vistoriaTecnica: {\r\n      title: \"Declara√ß√£o de Ci√™ncia da Visita T√©cnica\",\r\n      tooltip: \"Declara ci√™ncia sobre a necessidade ou dispensa de visita t√©cnica.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA ter ci√™ncia das condi√ß√µes para execu√ß√£o do objeto licitado, dispensando a necessidade de visita t√©cnica pr√©via, assumindo total responsabilidade pela execu√ß√£o dos servi√ßos.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    responsabilidadeTecnica: {\r\n      title: \"Declara√ß√£o de Responsabilidade T√©cnica\",\r\n      tooltip: \"Declara possuir respons√°vel t√©cnico habilitado para execu√ß√£o dos servi√ßos.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA possuir respons√°vel t√©cnico devidamente habilitado e registrado no √≥rg√£o de classe competente para acompanhar a execu√ß√£o dos servi√ßos objeto desta licita√ß√£o.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    },\r\n    lgpd: {\r\n      title: \"Declara√ß√£o de Atendimento √† LGPD (Lei 13.709/2018)\",\r\n      tooltip: \"Declara conformidade com a Lei Geral de Prote√ß√£o de Dados Pessoais.\",\r\n      content: `[RAZ√ÉO SOCIAL], inscrita no CNPJ sob o n¬∫ [CNPJ], DECLARA estar em conformidade com a Lei Geral de Prote√ß√£o de Dados Pessoais (Lei 13.709/2018), comprometendo-se a tratar os dados pessoais conforme as diretrizes legais.\r\n\r\n[Local], [Data].\r\n\r\n__________________________________  \r\n[Nome do Representante Legal]  \r\n[Cargo]  \r\n[CPF]`\r\n    }\r\n  };\r\n\r\n  const handleObligatoryChange = (declaration: string, checked: boolean) => {\r\n    setObligatoryDeclarations(prev => ({\r\n      ...prev,\r\n      [declaration]: checked\r\n    }));\r\n  };\r\n\r\n  const handleOptionalChange = (declaration: string, checked: boolean) => {\r\n    setOptionalDeclarations(prev => ({\r\n      ...prev,\r\n      [declaration]: checked\r\n    }));\r\n  };\r\n\r\n  const openEditModal = (modelKey: string, isOptional: boolean = false) => {\r\n    let model: { title: string; tooltip: string; content: string } | undefined;\r\n\r\n    if (isOptional) {\r\n      model = optionalModels[modelKey as keyof typeof optionalModels];\r\n    } else {\r\n      model = obligatoryModels[modelKey as keyof typeof obligatoryModels];\r\n    }\r\n\r\n    if (model) {\r\n      setEditingModel(modelKey);\r\n      setEditingText(model.content);\r\n    }\r\n  };\r\n\r\n  const saveEditedModel = () => {\r\n    // Aqui voc√™ salvaria as altera√ß√µes do modelo\r\n    setEditingModel(null);\r\n    setEditingText('');\r\n  };\r\n\r\n  const copyToClipboard = (text: string) => {\r\n    navigator.clipboard.writeText(text);\r\n  };\r\n\r\n  const DeclarationCard = ({\r\n    declaration,\r\n    model,\r\n    checked,\r\n    onChange,\r\n    isOptional = false\r\n  }: {\r\n    declaration: string;\r\n    model: any;\r\n    checked: boolean;\r\n    onChange: (declaration: string, checked: boolean) => void;\r\n    isOptional?: boolean;\r\n  }) => (\r\n    <Card className={`transition-all hover:shadow-md ${checked ? 'ring-2 ring-blue-500 bg-blue-50' : ''}`}>\r\n      <CardContent className=\"p-4\">\r\n        <div className=\"flex items-start justify-between gap-3\">\r\n          <div className=\"flex items-start space-x-3 flex-1\">\r\n            <Checkbox\r\n              id={declaration}\r\n              checked={checked}\r\n              onCheckedChange={(checked) => onChange(declaration, checked as boolean)}\r\n            />\r\n            <div className=\"flex-1\">\r\n              <Label htmlFor={declaration} className=\"font-medium text-sm leading-tight cursor-pointer\">\r\n                {model.title}\r\n              </Label>\r\n              <TooltipProvider>\r\n                <Tooltip>\r\n                  <TooltipTrigger asChild>\r\n                    <Info className=\"h-4 w-4 text-gray-400 cursor-help inline ml-2\" />\r\n                  </TooltipTrigger>\r\n                  <TooltipContent side=\"top\" className=\"max-w-xs\">\r\n                    <p>{model.tooltip}</p>\r\n                  </TooltipContent>\r\n                </Tooltip>\r\n              </TooltipProvider>\r\n            </div>\r\n          </div>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={() => openEditModal(declaration, isOptional)}\r\n            className=\"shrink-0\"\r\n          >\r\n            <Eye className=\"h-4 w-4 mr-1\" />\r\n            Visualizar Modelo\r\n          </Button>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n\r\n  return (\r\n    <div className=\"p-6 space-y-6\">\r\n      <div className=\"mb-6\">\r\n        <h2 className=\"text-2xl font-bold text-gray-900 flex items-center gap-2\">\r\n          <Paperclip className=\"h-6 w-6\" />\r\n          Declara√ß√µes e Anexos Obrigat√≥rios\r\n        </h2>\r\n        <p className=\"text-gray-600 mt-2\">\r\n          Configure as declara√ß√µes e anexos que far√£o parte do edital. As declara√ß√µes obrigat√≥rias j√° est√£o selecionadas por padr√£o.\r\n        </p>\r\n      </div>\r\n\r\n      {/* Declara√ß√µes Obrigat√≥rias */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Shield className=\"h-5 w-5 text-red-600\" />\r\n            üìù Declara√ß√µes Obrigat√≥rias\r\n            <Badge variant=\"destructive\">Requeridas</Badge>\r\n          </CardTitle>\r\n          <p className=\"text-sm text-gray-600\">\r\n            Declara√ß√µes obrigat√≥rias para o processo licitat√≥rio. Podem ser desmarcadas apenas em casos espec√≠ficos.\r\n          </p>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\r\n            {Object.entries(obligatoryModels).map(([key, model]) => (\r\n              <DeclarationCard\r\n                key={key}\r\n                declaration={key}\r\n                model={model}\r\n                checked={obligatoryDeclarations[key as keyof typeof obligatoryDeclarations]}\r\n                onChange={handleObligatoryChange}\r\n              />\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Declara√ß√µes Opcionais */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <FileCheck className=\"h-5 w-5 text-blue-600\" />\r\n            üìå Declara√ß√µes Opcionais\r\n            <Badge variant=\"secondary\">Selecion√°veis</Badge>\r\n          </CardTitle>\r\n          <p className=\"text-sm text-gray-600\">\r\n            Declara√ß√µes adicionais que podem ser inclu√≠das conforme a necessidade do certame.\r\n          </p>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\r\n            {Object.entries(optionalModels).map(([key, model]) => (\r\n              <DeclarationCard\r\n                key={key}\r\n                declaration={key}\r\n                model={model}\r\n                checked={optionalDeclarations[key as keyof typeof optionalDeclarations]}\r\n                onChange={handleOptionalChange}\r\n                isOptional={true}\r\n              />\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Minuta de Contrato e Modelo de Proposta Comercial */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <Building className=\"h-5 w-5 text-green-600\" />\r\n            üìé Minuta de Contrato e Modelo de Proposta Comercial\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent className=\"space-y-6\">\r\n          {/* Minuta de Contrato */}\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <h4 className=\"font-medium\">Minuta de Contrato</h4>\r\n              <Badge variant=\"destructive\">Obrigat√≥rio</Badge>\r\n            </div>\r\n            <div className=\"flex gap-4\">\r\n              <Button\r\n                variant={contractType === 'upload' ? 'default' : 'outline'}\r\n                onClick={() => setContractType('upload')}\r\n                className=\"flex-1\"\r\n              >\r\n                <Upload className=\"h-4 w-4 mr-2\" />\r\n                Upload Manual (.pdf/.doc)\r\n              </Button>\r\n              <Button\r\n                variant={contractType === 'standard' ? 'default' : 'outline'}\r\n                onClick={() => setContractType('standard')}\r\n                className=\"flex-1\"\r\n              >\r\n                <Wand2 className=\"h-4 w-4 mr-2\" />\r\n                Utilizar Modelo Padr√£o do PreparaGov\r\n              </Button>\r\n            </div>\r\n\r\n            {contractType === 'upload' && (\r\n              <div className=\"p-4 border-2 border-dashed border-gray-300 rounded-lg\">\r\n                <Input\r\n                  type=\"file\"\r\n                  accept=\".pdf,.doc,.docx\"\r\n                  className=\"max-w-xs\"\r\n                />\r\n                <p className=\"text-sm text-gray-500 mt-2\">\r\n                  Fa√ßa upload da minuta de contrato personalizada\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            {contractType === 'standard' && (\r\n              <div className=\"p-4 bg-blue-50 rounded-lg\">\r\n                <p className=\"text-sm text-blue-700\">\r\n                  <strong>Ser√° utilizado o modelo padr√£o do PreparaGov</strong> com preenchimento autom√°tico baseado nos dados do TR e edital.\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <Separator />\r\n\r\n          {/* Modelo de Proposta Comercial */}\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <h4 className=\"font-medium\">Modelo de Proposta Comercial</h4>\r\n              <Badge variant=\"secondary\">Opcional</Badge>\r\n            </div>\r\n            <div className=\"flex gap-4\">\r\n              <Button\r\n                variant={proposalType === 'upload' ? 'default' : 'outline'}\r\n                onClick={() => setProposalType('upload')}\r\n                className=\"flex-1\"\r\n              >\r\n                <Upload className=\"h-4 w-4 mr-2\" />\r\n                Upload Manual\r\n              </Button>\r\n              <Button\r\n                variant={proposalType === 'standard' ? 'default' : 'outline'}\r\n                onClick={() => setProposalType('standard')}\r\n                className=\"flex-1\"\r\n              >\r\n                <Wand2 className=\"h-4 w-4 mr-2\" />\r\n                Utilizar Modelo Padr√£o do PreparaGov\r\n              </Button>\r\n            </div>\r\n\r\n            {proposalType === 'upload' && (\r\n              <div className=\"p-4 border-2 border-dashed border-gray-300 rounded-lg\">\r\n                <Input\r\n                  type=\"file\"\r\n                  accept=\".pdf,.doc,.docx,.xls,.xlsx\"\r\n                  className=\"max-w-xs\"\r\n                />\r\n                <p className=\"text-sm text-gray-500 mt-2\">\r\n                  Fa√ßa upload do modelo de proposta comercial personalizado\r\n                </p>\r\n              </div>\r\n            )}\r\n\r\n            {proposalType === 'standard' && (\r\n              <div className=\"p-4 bg-green-50 rounded-lg\">\r\n                <p className=\"text-sm text-green-700\">\r\n                  <strong>Ser√° utilizado o modelo padr√£o do PreparaGov</strong> formatado conforme os itens do TR.\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Modal de Edi√ß√£o de Declara√ß√£o */}\r\n      <Dialog open={!!editingModel} onOpenChange={() => setEditingModel(null)}>\r\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle>\r\n              {editingModel && (obligatoryModels[editingModel as keyof typeof obligatoryModels]?.title ||\r\n                optionalModels[editingModel as keyof typeof optionalModels]?.title)}\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"p-3 bg-yellow-50 border border-yellow-200 rounded\">\r\n              <p className=\"text-sm text-yellow-800\">\r\n                <strong>Aten√ß√£o:</strong> Voc√™ pode editar apenas o corpo da declara√ß√£o.\r\n                A estrutura b√°sica (t√≠tulo, campos de assinatura) deve ser mantida.\r\n              </p>\r\n            </div>\r\n            <Textarea\r\n              value={editingText}\r\n              onChange={(e) => setEditingText(e.target.value)}\r\n              className=\"min-h-[400px] font-mono text-sm\"\r\n              placeholder=\"Edite o conte√∫do da declara√ß√£o...\"\r\n            />\r\n            <div className=\"flex justify-between\">\r\n              <div className=\"flex gap-2\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => copyToClipboard(editingText)}\r\n                >\r\n                  <Copy className=\"h-4 w-4 mr-1\" />\r\n                  Copiar\r\n                </Button>\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => {/* Fun√ß√£o para download do PDF */ }}\r\n                >\r\n                  <Download className=\"h-4 w-4 mr-1\" />\r\n                  Exportar PDF\r\n                </Button>\r\n              </div>\r\n              <div className=\"flex gap-2\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  onClick={() => setEditingModel(null)}\r\n                >\r\n                  Cancelar\r\n                </Button>\r\n                <Button\r\n                  onClick={saveEditedModel}\r\n                >\r\n                  Salvar Altera√ß√µes\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Resumo Final */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle className=\"flex items-center gap-2\">\r\n            <UserCheck className=\"h-5 w-5 text-green-600\" />\r\n            üìÑ Resumo dos Documentos Selecionados\r\n          </CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <div className=\"space-y-4\">\r\n            {/* Declara√ß√µes Obrigat√≥rias Selecionadas */}\r\n            <div>\r\n              <h4 className=\"font-medium text-sm mb-2\">Declara√ß√µes Obrigat√≥rias Selecionadas:</h4>\r\n              <div className=\"space-y-1\">\r\n                {Object.entries(obligatoryDeclarations)\r\n                  .filter(([_, selected]) => selected)\r\n                  .map(([key, _]) => (\r\n                    <div key={key} className=\"text-sm text-gray-600 ml-4\">\r\n                      ‚Ä¢ {obligatoryModels[key as keyof typeof obligatoryModels].title}\r\n                    </div>\r\n                  ))\r\n                }\r\n              </div>\r\n            </div>\r\n\r\n            {/* Declara√ß√µes Opcionais Selecionadas */}\r\n            {Object.values(optionalDeclarations).some(selected => selected) && (\r\n              <div>\r\n                <h4 className=\"font-medium text-sm mb-2\">Declara√ß√µes Opcionais Selecionadas:</h4>\r\n                <div className=\"space-y-1\">\r\n                  {Object.entries(optionalDeclarations)\r\n                    .filter(([_, selected]) => selected)\r\n                    .map(([key, _]) => (\r\n                      <div key={key} className=\"text-sm text-gray-600 ml-4\">\r\n                        ‚Ä¢ {optionalModels[key as keyof typeof optionalModels].title}\r\n                      </div>\r\n                    ))\r\n                  }\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <Separator />\r\n\r\n            {/* Anexos */}\r\n            <div>\r\n              <h4 className=\"font-medium text-sm mb-2\">Anexos Contratuais:</h4>\r\n              <div className=\"space-y-1\">\r\n                <div className=\"text-sm text-gray-600 ml-4\">\r\n                  ‚Ä¢ Minuta de Contrato: {contractType === 'upload' ? 'Arquivo personalizado' : 'Modelo padr√£o PreparaGov'}\r\n                </div>\r\n                {proposalType && (\r\n                  <div className=\"text-sm text-gray-600 ml-4\">\r\n                    ‚Ä¢ Modelo de Proposta Comercial: {proposalType === 'upload' ? 'Arquivo personalizado' : 'Modelo padr√£o PreparaGov'}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Bot√£o de Finaliza√ß√£o */}\r\n      <div className=\"bg-green-50 border border-green-200 rounded-lg p-6 text-center\">\r\n        <h4 className=\"font-medium text-green-900 mb-2\">‚úÖ Edital Completo</h4>\r\n        <div className=\"text-sm text-green-800 space-y-1 mb-4\">\r\n          <p>‚Ä¢ Todas as etapas foram preenchidas com sucesso</p>\r\n          <p>‚Ä¢ Declara√ß√µes e anexos configurados</p>\r\n          <p>‚Ä¢ Conformidade com Lei 14.133/2021 verificada</p>\r\n          <p>‚Ä¢ Pronto para finaliza√ß√£o e publica√ß√£o</p>\r\n        </div>\r\n\r\n        <Button\r\n          onClick={onFinalize}\r\n          size=\"lg\"\r\n          className=\"bg-green-600 hover:bg-green-700 px-8 animate-scale-in\"\r\n        >\r\n          <CheckCircle className=\"h-5 w-5 mr-2\" />\r\n          Finalizar e Gerar Edital\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditalStep8;","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\PCA\\CancellationRequestsModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[525,528],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[525,528],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[549,552],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[549,552],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[583,586],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[583,586],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[614,617],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[614,617],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[864,867],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[864,867],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Eye, Check, X } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface CancellationRequestsModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  cancellationRequests: any[];\r\n  onView: (dfd: any) => void;\r\n  onApprove: (dfd: any) => void;\r\n  onDeny: (dfd: any, justification: string) => void;\r\n}\r\n\r\nconst CancellationRequestsModal = ({\r\n  open,\r\n  onClose,\r\n  cancellationRequests,\r\n  onView,\r\n  onApprove,\r\n  onDeny\r\n}: CancellationRequestsModalProps) => {\r\n  const [denyingDFD, setDenyingDFD] = useState<any>(null);\r\n  const [justification, setJustification] = useState('');\r\n  const { toast } = useToast();\r\n\r\n  const handleDeny = () => {\r\n    if (!justification.trim()) {\r\n      toast({\r\n        title: \"Erro\",\r\n        description: \"A justificativa √© obrigat√≥ria para negar o cancelamento.\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    onDeny(denyingDFD, justification);\r\n    setDenyingDFD(null);\r\n    setJustification('');\r\n  };\r\n\r\n  const cancelDeny = () => {\r\n    setDenyingDFD(null);\r\n    setJustification('');\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>Solicita√ß√µes de Cancelamento</DialogTitle>\r\n        </DialogHeader>\r\n\r\n        {denyingDFD ? (\r\n          <div className=\"space-y-4\">\r\n            <h3 className=\"font-semibold\">Negar Cancelamento: {denyingDFD.objeto}</h3>\r\n            <div className=\"p-3 bg-gray-50 rounded-lg\">\r\n              <p className=\"text-sm\"><strong>Justificativa da Solicita√ß√£o:</strong></p>\r\n              <p className=\"text-sm text-gray-700\">{denyingDFD.justificativaCancelamento}</p>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium mb-2\">\r\n                Justificativa da Negativa *\r\n              </label>\r\n              <Textarea\r\n                value={justification}\r\n                onChange={(e) => setJustification(e.target.value)}\r\n                placeholder=\"Digite o motivo da negativa do cancelamento...\"\r\n                rows={4}\r\n              />\r\n            </div>\r\n            <div className=\"flex space-x-2\">\r\n              <Button onClick={handleDeny} variant=\"destructive\">\r\n                Confirmar Negativa\r\n              </Button>\r\n              <Button onClick={cancelDeny} variant=\"outline\">\r\n                Cancelar\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {cancellationRequests.length === 0 ? (\r\n              <p className=\"text-center text-gray-500 py-8\">\r\n                N√£o h√° solicita√ß√µes de cancelamento pendentes.\r\n              </p>\r\n            ) : (\r\n              cancellationRequests.map((dfd) => (\r\n                <div key={dfd.id} className=\"border border-gray-200 rounded-lg p-4\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <h3 className=\"font-semibold text-gray-900\">{dfd.objeto}</h3>\r\n                    <Badge className=\"bg-red-100 text-red-800\">\r\n                      Solicita√ß√£o de Cancelamento\r\n                    </Badge>\r\n                  </div>\r\n                  <div className=\"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3\">\r\n                    <div>Tipo: {dfd.tipoDFD}</div>\r\n                    <div>Valor: {dfd.valorEstimado}</div>\r\n                    <div>Solicitado por: {dfd.solicitadoPor}</div>\r\n                    <div>Data: {new Date(dfd.dataSolicitacao).toLocaleDateString('pt-BR')}</div>\r\n                  </div>\r\n                  <div className=\"p-3 bg-yellow-50 rounded-lg mb-3\">\r\n                    <p className=\"text-sm\"><strong>Justificativa:</strong></p>\r\n                    <p className=\"text-sm text-gray-700\">{dfd.justificativaCancelamento}</p>\r\n                  </div>\r\n                  <div className=\"flex space-x-2\">\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      onClick={() => onView(dfd)}\r\n                    >\r\n                      <Eye size={16} className=\"mr-1\" />\r\n                      Visualizar\r\n                    </Button>\r\n                    <Button\r\n                      size=\"sm\"\r\n                      className=\"bg-green-600 hover:bg-green-700\"\r\n                      onClick={() => onApprove(dfd)}\r\n                    >\r\n                      <Check size={16} className=\"mr-1\" />\r\n                      Aprovar Cancelamento\r\n                    </Button>\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"destructive\"\r\n                      onClick={() => setDenyingDFD(dfd)}\r\n                    >\r\n                      <X size={16} className=\"mr-1\" />\r\n                      Negar\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {!denyingDFD && (\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Fechar\r\n            </Button>\r\n          </DialogFooter>\r\n        )}\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default CancellationRequestsModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\PCA\\DFDApprovalModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[507,510],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[507,510],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[531,534],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[531,534],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[565,568],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[565,568],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[598,601],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[598,601],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[827,830],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[827,830],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Eye, Check, X } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface DFDApprovalModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  pendingDFDs: any[];\r\n  onView: (dfd: any) => void;\r\n  onApprove: (dfd: any) => void;\r\n  onReject: (dfd: any, justification: string) => void;\r\n}\r\n\r\nconst DFDApprovalModal = ({\r\n  open,\r\n  onClose,\r\n  pendingDFDs,\r\n  onView,\r\n  onApprove,\r\n  onReject\r\n}: DFDApprovalModalProps) => {\r\n  const [rejectingDFD, setRejectingDFD] = useState<any>(null);\r\n  const [justification, setJustification] = useState('');\r\n  const { toast } = useToast();\r\n\r\n  const handleReject = () => {\r\n    if (!justification.trim()) {\r\n      toast({\r\n        title: \"Erro\",\r\n        description: \"A justificativa √© obrigat√≥ria para recusar um DFD.\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    onReject(rejectingDFD, justification);\r\n    setRejectingDFD(null);\r\n    setJustification('');\r\n  };\r\n\r\n  const cancelReject = () => {\r\n    setRejectingDFD(null);\r\n    setJustification('');\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={onClose}>\r\n      <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\r\n        <DialogHeader>\r\n          <DialogTitle>DFDs Pendentes de Aprova√ß√£o</DialogTitle>\r\n        </DialogHeader>\r\n\r\n        {rejectingDFD ? (\r\n          <div className=\"space-y-4\">\r\n            <h3 className=\"font-semibold\">Recusar DFD: {rejectingDFD.objeto}</h3>\r\n            <div>\r\n              <label className=\"block text-sm font-medium mb-2\">\r\n                Justificativa da Recusa *\r\n              </label>\r\n              <Textarea\r\n                value={justification}\r\n                onChange={(e) => setJustification(e.target.value)}\r\n                placeholder=\"Digite o motivo da recusa...\"\r\n                rows={4}\r\n              />\r\n            </div>\r\n            <div className=\"flex space-x-2\">\r\n              <Button onClick={handleReject} variant=\"destructive\">\r\n                Confirmar Recusa\r\n              </Button>\r\n              <Button onClick={cancelReject} variant=\"outline\">\r\n                Cancelar\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {pendingDFDs.length === 0 ? (\r\n              <p className=\"text-center text-gray-500 py-8\">\r\n                N√£o h√° DFDs pendentes de aprova√ß√£o.\r\n              </p>\r\n            ) : (\r\n              pendingDFDs.map((dfd) => (\r\n                <div key={dfd.id} className=\"border border-gray-200 rounded-lg p-4\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <h3 className=\"font-semibold text-gray-900\">{dfd.objeto}</h3>\r\n                    <Badge className=\"bg-orange-100 text-orange-800\">\r\n                      Pendente Aprova√ß√£o\r\n                    </Badge>\r\n                  </div>\r\n                  <div className=\"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3\">\r\n                    <div>Tipo: {dfd.tipoDFD}</div>\r\n                    <div>Prioridade: {dfd.prioridade}</div>\r\n                    <div>Valor: {dfd.valorEstimado}</div>\r\n                    <div>Ano: {dfd.anoContratacao}</div>\r\n                    <div className=\"col-span-2 mt-1 font-medium text-gray-800\">\r\n                      Requisitante: {dfd.userName}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex space-x-2\">\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"outline\"\r\n                      onClick={() => onView(dfd)}\r\n                    >\r\n                      <Eye size={16} className=\"mr-1\" />\r\n                      Visualizar\r\n                    </Button>\r\n                    <Button\r\n                      size=\"sm\"\r\n                      className=\"bg-green-600 hover:bg-green-700\"\r\n                      onClick={() => onApprove(dfd)}\r\n                    >\r\n                      <Check size={16} className=\"mr-1\" />\r\n                      Aprovar\r\n                    </Button>\r\n                    <Button\r\n                      size=\"sm\"\r\n                      variant=\"destructive\"\r\n                      onClick={() => setRejectingDFD(dfd)}\r\n                    >\r\n                      <X size={16} className=\"mr-1\" />\r\n                      Recusar\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n              ))\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {!rejectingDFD && (\r\n          <DialogFooter>\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Fechar\r\n            </Button>\r\n          </DialogFooter>\r\n        )}\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default DFDApprovalModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\PCA\\PCAApprovedDFDsList.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[413,416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[413,416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[440,443],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[440,443],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[480,483],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[480,483],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Eye, Printer, X } from 'lucide-react';\r\nimport DFDListPagination from '../DFD/DFDListPagination';\r\n\r\ninterface PCAApprovedDFDsListProps {\r\n  selectedYear: string;\r\n  approvedDFDs: any[];\r\n  onViewDFD: (dfd: any) => void;\r\n  onRemoveFromPCA: (dfd: any) => void;\r\n}\r\n\r\nconst PCAApprovedDFDsList = ({\r\n  selectedYear,\r\n  approvedDFDs,\r\n  onViewDFD,\r\n  onRemoveFromPCA\r\n}: PCAApprovedDFDsListProps) => {\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const itemsPerPage = 5;\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'Aprovado':\r\n        return 'bg-green-100 text-green-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getTrimestreColor = (trimestre: string) => {\r\n    const colors = {\r\n      'Q1': 'bg-purple-100 text-purple-800',\r\n      'Q2': 'bg-blue-100 text-blue-800',\r\n      'Q3': 'bg-green-100 text-green-800',\r\n      'Q4': 'bg-orange-100 text-orange-800'\r\n    };\r\n    return colors[trimestre as keyof typeof colors] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  // C√°lculos de pagina√ß√£o\r\n  const totalPages = Math.ceil(approvedDFDs.length / itemsPerPage);\r\n  const startIndex = (currentPage - 1) * itemsPerPage;\r\n  const paginatedDFDs = approvedDFDs.slice(startIndex, startIndex + itemsPerPage);\r\n\r\n  const handlePageChange = (page: number) => {\r\n    setCurrentPage(page);\r\n  };\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader>\r\n        <CardTitle>DFDs Aprovados - Componentes do PCA {selectedYear}</CardTitle>\r\n      </CardHeader>\r\n      <CardContent>\r\n        <div className=\"space-y-4\">\r\n          {paginatedDFDs.map((item) => (\r\n            <div key={item.id} className=\"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50\">\r\n              <div className=\"flex-1\">\r\n                <h3 className=\"font-medium text-gray-900\">{item.objeto}</h3>\r\n                <div className=\"flex items-center space-x-4 mt-2\">\r\n                  <Badge className={getStatusColor(item.status)}>\r\n                    {item.status}\r\n                  </Badge>\r\n                  <Badge className={getTrimestreColor(item.trimestre)}>\r\n                    {item.trimestre}\r\n                  </Badge>\r\n                  <span className=\"text-sm text-gray-600\">\r\n                    {item.tipoDFD}\r\n                  </span>\r\n                  <span className=\"text-sm text-gray-600\">\r\n                    Prioridade: {item.prioridade}\r\n                  </span>\r\n                </div>\r\n                <p className=\"text-sm font-medium text-gray-900 mt-1\">{item.valorEstimado}</p>\r\n              </div>\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => onViewDFD(item)}>\r\n                  <Eye size={16} />\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"sm\">\r\n                  <Printer size={16} />\r\n                </Button>\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => onRemoveFromPCA(item)}>\r\n                  <X size={16} className=\"text-red-600\" />\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n\r\n          {approvedDFDs.length === 0 && (\r\n            <div className=\"text-center py-8\">\r\n              <p className=\"text-gray-500\">Nenhum DFD aprovado encontrado para o ano {selectedYear}.</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Pagina√ß√£o */}\r\n        {totalPages > 1 && (\r\n          <div className=\"mt-6\">\r\n            <DFDListPagination\r\n              currentPage={currentPage}\r\n              totalPages={totalPages}\r\n              onPageChange={handlePageChange}\r\n            />\r\n          </div>\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nexport default PCAApprovedDFDsList;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\PCA\\RemoveFromPCAModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":8,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":11,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[501,504],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[501,504],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":20,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":20,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[526,529],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[526,529],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n  DialogFooter,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Label } from '@/components/ui/label';\r\nimport { AlertTriangle } from 'lucide-react';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ninterface RemoveFromPCAModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  dfd: any;\r\n  onConfirm: (dfd: any, justification: string) => void;\r\n}\r\n\r\nconst RemoveFromPCAModal = ({\r\n  open,\r\n  onClose,\r\n  dfd,\r\n  onConfirm\r\n}: RemoveFromPCAModalProps) => {\r\n  const [justification, setJustification] = useState('');\r\n  const { toast } = useToast();\r\n\r\n  const handleConfirm = () => {\r\n    if (!justification.trim()) {\r\n      toast({\r\n        title: \"Erro\",\r\n        description: \"A justificativa √© obrigat√≥ria para retirar um DFD do PCA.\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    onConfirm(dfd, justification);\r\n    setJustification('');\r\n    onClose();\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setJustification('');\r\n    onClose();\r\n  };\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleClose}>\r\n      <DialogContent className=\"max-w-md\">\r\n        <DialogHeader>\r\n          <DialogTitle className=\"flex items-center space-x-2 text-red-600\">\r\n            <AlertTriangle size={20} />\r\n            <span>Confirmar Retirada do PCA</span>\r\n          </DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-4\">\r\n          {dfd && (\r\n            <div className=\"p-3 bg-gray-50 rounded-lg\">\r\n              <h4 className=\"font-medium text-gray-900\">{dfd.objeto}</h4>\r\n              <p className=\"text-sm text-gray-600\">{dfd.valorEstimado}</p>\r\n            </div>\r\n          )}\r\n\r\n          <div className=\"space-y-2\">\r\n            <Label htmlFor=\"justification\">\r\n              Justificativa da Retirada *\r\n            </Label>\r\n            <Textarea\r\n              id=\"justification\"\r\n              value={justification}\r\n              onChange={(e) => setJustification(e.target.value)}\r\n              placeholder=\"Digite o motivo da retirada do DFD do PCA...\"\r\n              rows={4}\r\n              className=\"resize-none\"\r\n            />\r\n            <p className=\"text-xs text-gray-500\">\r\n              Esta justificativa ficar√° registrada no hist√≥rico do DFD.\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <DialogFooter>\r\n          <Button variant=\"outline\" onClick={handleClose}>\r\n            Cancelar\r\n          </Button>\r\n          <Button variant=\"destructive\" onClick={handleConfirm}>\r\n            Confirmar Retirada\r\n          </Button>\r\n        </DialogFooter>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default RemoveFromPCAModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\TermoReferencia\\DFDsLivresModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1024,1027],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1024,1027],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1633,1636],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1633,1636],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3259,3262],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3259,3262],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport {\r\n  Search,\r\n  FileText,\r\n  ArrowRight,\r\n  X,\r\n  Eye,\r\n  Loader2\r\n} from 'lucide-react';\r\nimport DFDViewModal from '../DFD/DFDViewModal';\r\nimport { dfdService } from '@/services/dfdService';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { DbDFD } from '@/types/database';\r\n\r\ninterface DFDsLivresModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onContinuar: (selectedDFDs: any[]) => void;\r\n}\r\n\r\nconst DFDsLivresModal = ({ open, onClose, onContinuar }: DFDsLivresModalProps) => {\r\n  const { user } = useAuth();\r\n  const [dfds, setDfds] = useState<DbDFD[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [filtros, setFiltros] = useState({\r\n    secretaria: 'todos',\r\n    tipoDFD: 'todos',\r\n    prioridade: 'todas',\r\n    anoContratacao: 'todos',\r\n    busca: ''\r\n  });\r\n  const [selectedDFDs, setSelectedDFDs] = useState<string[]>([]);\r\n  const [showDFDPreview, setShowDFDPreview] = useState(false);\r\n  const [selectedDFDForPreview, setSelectedDFDForPreview] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    if (open) {\r\n      loadDFDs();\r\n    }\r\n  }, [open, user?.prefeituraId]);\r\n\r\n  const loadDFDs = async () => {\r\n    try {\r\n      setLoading(true);\r\n      // Buscamos apenas DFDs aprovados\r\n      const data = await dfdService.getAll({ status: 'Aprovado' });\r\n      setDfds(data || []);\r\n    } catch (error) {\r\n      console.error('Erro ao carregar DFDs:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const filteredDFDs = useMemo(() => {\r\n    return dfds.filter(dfd => {\r\n      const matchesBusca = !filtros.busca ||\r\n        dfd.numero_dfd?.toLowerCase().includes(filtros.busca.toLowerCase()) ||\r\n        dfd.descricao_sucinta?.toLowerCase().includes(filtros.busca.toLowerCase()) ||\r\n        dfd.area_requisitante?.toLowerCase().includes(filtros.busca.toLowerCase());\r\n\r\n      const matchesSecretaria = filtros.secretaria === 'todos' || dfd.area_requisitante === filtros.secretaria;\r\n      const matchesTipo = filtros.tipoDFD === 'todos' || dfd.tipo_dfd === filtros.tipoDFD;\r\n      const matchesPrioridade = filtros.prioridade === 'todas' || dfd.prioridade === filtros.prioridade;\r\n      const matchesAno = filtros.anoContratacao === 'todos' || dfd.ano_contratacao?.toString() === filtros.anoContratacao;\r\n\r\n      return matchesBusca && matchesSecretaria && matchesTipo && matchesPrioridade && matchesAno;\r\n    });\r\n  }, [dfds, filtros]);\r\n\r\n  const handleSelectDFD = (dfdId: string) => {\r\n    setSelectedDFDs(prev =>\r\n      prev.includes(dfdId)\r\n        ? prev.filter(id => id !== dfdId)\r\n        : [...prev, dfdId]\r\n    );\r\n  };\r\n\r\n  const handleViewDFD = (dfd: any) => {\r\n    setSelectedDFDForPreview(dfd);\r\n    setShowDFDPreview(true);\r\n  };\r\n\r\n  const handleContinuar = () => {\r\n    const selecionados = dfds.filter(dfd => selectedDFDs.includes(dfd.id));\r\n    onContinuar(selecionados);\r\n  };\r\n\r\n  const getPriorityColor = (prioridade: string | null) => {\r\n    switch (prioridade) {\r\n      case 'Alta':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'M√©dia':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'Baixa':\r\n        return 'bg-green-100 text-green-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const secretarias = [...new Set(dfds.map(d => d.area_requisitante).filter(Boolean))];\r\n  const tipos = [...new Set(dfds.map(d => d.tipo_dfd).filter(Boolean))];\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={open} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center\">\r\n                <FileText size={20} className=\"mr-2 text-blue-600\" />\r\n                DFDs Livres - Sele√ß√£o para TR\r\n              </div>\r\n              <Button variant=\"ghost\" onClick={onClose} className=\"h-8 w-8 p-0\">\r\n                <X size={20} />\r\n              </Button>\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-6\">\r\n            {/* Filtros */}\r\n            <Card className=\"bg-gray-50/50 border-none shadow-none\">\r\n              <CardContent className=\"p-4\">\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4\">\r\n                  <div className=\"lg:col-span-2 space-y-1\">\r\n                    <label className=\"text-[10px] font-bold text-gray-400 uppercase ml-1\">Busca</label>\r\n                    <div className=\"relative\">\r\n                      <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" size={16} />\r\n                      <Input\r\n                        placeholder=\"N√∫mero, descri√ß√£o ou √°rea...\"\r\n                        value={filtros.busca}\r\n                        onChange={(e) => setFiltros(prev => ({ ...prev, busca: e.target.value }))}\r\n                        className=\"pl-10 h-9 bg-white\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-1\">\r\n                    <label className=\"text-[10px] font-bold text-gray-400 uppercase ml-1\">√Årea</label>\r\n                    <Select value={filtros.secretaria} onValueChange={(value) => setFiltros(prev => ({ ...prev, secretaria: value }))}>\r\n                      <SelectTrigger className=\"h-9 bg-white\">\r\n                        <SelectValue placeholder=\"√Årea\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"todos\">Todas</SelectItem>\r\n                        {secretarias.map(s => <SelectItem key={s!} value={s!}>{s}</SelectItem>)}\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-1\">\r\n                    <label className=\"text-[10px] font-bold text-gray-400 uppercase ml-1\">Tipo</label>\r\n                    <Select value={filtros.tipoDFD} onValueChange={(value) => setFiltros(prev => ({ ...prev, tipoDFD: value }))}>\r\n                      <SelectTrigger className=\"h-9 bg-white\">\r\n                        <SelectValue placeholder=\"Tipo\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"todos\">Todos</SelectItem>\r\n                        {tipos.map(t => <SelectItem key={t!} value={t!}>{t}</SelectItem>)}\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-1\">\r\n                    <label className=\"text-[10px] font-bold text-gray-400 uppercase ml-1\">Prioridade</label>\r\n                    <Select value={filtros.prioridade} onValueChange={(value) => setFiltros(prev => ({ ...prev, prioridade: value }))}>\r\n                      <SelectTrigger className=\"h-9 bg-white\">\r\n                        <SelectValue placeholder=\"Prioridade\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"todas\">Todas</SelectItem>\r\n                        <SelectItem value=\"Alta\">Alta</SelectItem>\r\n                        <SelectItem value=\"M√©dia\">M√©dia</SelectItem>\r\n                        <SelectItem value=\"Baixa\">Baixa</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-1\">\r\n                    <label className=\"text-[10px] font-bold text-gray-400 uppercase ml-1\">Ano</label>\r\n                    <Select value={filtros.anoContratacao} onValueChange={(value) => setFiltros(prev => ({ ...prev, anoContratacao: value }))}>\r\n                      <SelectTrigger className=\"h-9 bg-white\">\r\n                        <SelectValue placeholder=\"Ano\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"todos\">Todos</SelectItem>\r\n                        <SelectItem value=\"2024\">2024</SelectItem>\r\n                        <SelectItem value=\"2025\">2025</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {/* Tabela de DFDs */}\r\n            <div className=\"rounded-md border bg-white overflow-hidden\">\r\n              <Table>\r\n                <TableHeader className=\"bg-gray-50\">\r\n                  <TableRow>\r\n                    <TableHead className=\"w-12\"></TableHead>\r\n                    <TableHead className=\"font-bold\">N√∫mero</TableHead>\r\n                    <TableHead className=\"font-bold\">√Årea Requisitante</TableHead>\r\n                    <TableHead className=\"font-bold\">Descri√ß√£o</TableHead>\r\n                    <TableHead className=\"font-bold\">Tipo</TableHead>\r\n                    <TableHead className=\"font-bold\">Data Contrata√ß√£o</TableHead>\r\n                    <TableHead className=\"font-bold\">Prioridade</TableHead>\r\n                    <TableHead className=\"font-bold\">Valor Total</TableHead>\r\n                    <TableHead className=\"font-bold text-right\">A√ß√µes</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n                <TableBody>\r\n                  {loading ? (\r\n                    <TableRow>\r\n                      <TableCell colSpan={9} className=\"h-32 text-center\">\r\n                        <Loader2 className=\"w-8 h-8 animate-spin mx-auto text-orange-500 mb-2\" />\r\n                        <span className=\"text-gray-500\">Buscando DFDs aprovados...</span>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ) : filteredDFDs.length === 0 ? (\r\n                    <TableRow>\r\n                      <TableCell colSpan={9} className=\"h-32 text-center text-gray-500\">\r\n                        Nenhum DFD aprovado encontrado para os filtros selecionados.\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ) : (\r\n                    filteredDFDs.map((dfd) => (\r\n                      <TableRow key={dfd.id} className={selectedDFDs.includes(dfd.id) ? 'bg-blue-50/50' : ''}>\r\n                        <TableCell>\r\n                          <Checkbox\r\n                            checked={selectedDFDs.includes(dfd.id)}\r\n                            onCheckedChange={() => handleSelectDFD(dfd.id)}\r\n                          />\r\n                        </TableCell>\r\n                        <TableCell className=\"font-bold text-blue-600\">\r\n                          {dfd.numero_dfd}\r\n                        </TableCell>\r\n                        <TableCell className=\"text-sm\">{dfd.area_requisitante}</TableCell>\r\n                        <TableCell className=\"text-xs max-w-xs truncate\">{dfd.descricao_sucinta}</TableCell>\r\n                        <TableCell>\r\n                          <Badge variant=\"outline\" className=\"text-[10px]\">{dfd.tipo_dfd}</Badge>\r\n                        </TableCell>\r\n                        <TableCell className=\"text-xs\">\r\n                          {dfd.data_contratacao ? new Date(dfd.data_contratacao).toLocaleDateString('pt-BR') : '-'}\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <Badge className={`${getPriorityColor(dfd.prioridade)} text-[10px]`}>\r\n                            {dfd.prioridade}\r\n                          </Badge>\r\n                        </TableCell>\r\n                        <TableCell className=\"font-bold text-green-700\">\r\n                          {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(dfd.valor_estimado_total || 0)}\r\n                        </TableCell>\r\n                        <TableCell className=\"text-right\">\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleViewDFD(dfd)}\r\n                            className=\"h-8 w-8 p-0\"\r\n                          >\r\n                            <Eye size={16} className=\"text-gray-400\" />\r\n                          </Button>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    ))\r\n                  )}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n\r\n            {/* Resumo e A√ß√µes */}\r\n            <div className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg border\">\r\n              <div className=\"text-sm text-gray-600 flex items-center space-x-4\">\r\n                <div className=\"bg-white px-3 py-1 rounded-full border shadow-sm\">\r\n                  <span className=\"font-bold text-blue-600\">{selectedDFDs.length}</span> DFD(s) selecionado(s)\r\n                </div>\r\n                {selectedDFDs.length > 0 && (\r\n                  <div className=\"bg-green-50 px-3 py-1 rounded-full border border-green-100 shadow-sm\">\r\n                    Total Estimado: <span className=\"font-bold text-green-700\">\r\n                      {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(\r\n                        dfds\r\n                          .filter(dfd => selectedDFDs.includes(dfd.id))\r\n                          .reduce((total, dfd) => total + (dfd.valor_estimado_total || 0), 0)\r\n                      )}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"flex items-center space-x-3\">\r\n                <Button variant=\"ghost\" onClick={onClose} className=\"text-gray-500\">\r\n                  Cancelar\r\n                </Button>\r\n                <Button\r\n                  onClick={handleContinuar}\r\n                  disabled={selectedDFDs.length === 0}\r\n                  className=\"bg-blue-600 hover:bg-blue-700 shadow-sm\"\r\n                >\r\n                  Avan√ßar para TR\r\n                  <ArrowRight size={16} className=\"ml-2\" />\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Modal de Preview do DFD */}\r\n      <DFDViewModal\r\n        open={showDFDPreview}\r\n        onClose={() => setShowDFDPreview(false)}\r\n        dfd={selectedDFDForPreview}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default DFDsLivresModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\TermoReferencia\\ItensEspecificosModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1197,1200],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1197,1200],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1382,1385],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1382,1385],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1885,1888],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1885,1888],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":98,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3668,3671],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3668,3671],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":104,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3817,3820],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3817,3820],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3895,3898],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3895,3898],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":139,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4906,4909],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4906,4909],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":150,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5223,5226],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5223,5226],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":306,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":306,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13609,13612],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13609,13612],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useMemo } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from '@/components/ui/collapsible';\r\nimport {\r\n  Search,\r\n  ArrowRight,\r\n  X,\r\n  Eye,\r\n  ChevronDown,\r\n  ChevronRight,\r\n  Package,\r\n  Loader2\r\n} from 'lucide-react';\r\nimport DFDViewModal from '../DFD/DFDViewModal';\r\nimport { dfdService } from '@/services/dfdService';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { DbDFD, DbDFDItem } from '@/types/database';\r\n\r\ninterface ItensEspecificosModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onContinuar: (selectedItems: any[]) => void;\r\n}\r\n\r\nconst ItensEspecificosModal = ({ open, onClose, onContinuar }: ItensEspecificosModalProps) => {\r\n  const { user } = useAuth();\r\n  const [dfds, setDfds] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [filtros, setFiltros] = useState({\r\n    secretaria: 'todas',\r\n    tipoDFD: 'todos',\r\n    prioridade: 'todas',\r\n    anoContratacao: 'todos',\r\n    busca: ''\r\n  });\r\n  const [selectedItems, setSelectedItems] = useState<string[]>([]);\r\n  const [expandedDFDs, setExpandedDFDs] = useState<string[]>([]);\r\n  const [showDFDPreview, setShowDFDPreview] = useState(false);\r\n  const [selectedDFDForPreview, setSelectedDFDForPreview] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    if (open) {\r\n      loadDFDs();\r\n    }\r\n  }, [open, user?.prefeituraId]);\r\n\r\n  const loadDFDs = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const data = await dfdService.getAll({ status: 'Aprovado' });\r\n      setDfds(data || []);\r\n    } catch (error) {\r\n      console.error('Erro ao carregar DFDs:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const filteredDFDs = useMemo(() => {\r\n    return dfds.filter(dfd => {\r\n      const matchesBusca = !filtros.busca ||\r\n        dfd.numero_dfd?.toLowerCase().includes(filtros.busca.toLowerCase()) ||\r\n        dfd.descricao_sucinta?.toLowerCase().includes(filtros.busca.toLowerCase()) ||\r\n        dfd.area_requisitante?.toLowerCase().includes(filtros.busca.toLowerCase());\r\n\r\n      const matchesSecretaria = filtros.secretaria === 'todas' || dfd.area_requisitante === filtros.secretaria;\r\n      const matchesTipo = filtros.tipoDFD === 'todos' || dfd.tipo_dfd === filtros.tipoDFD;\r\n      const matchesPrioridade = filtros.prioridade === 'todas' || dfd.prioridade === filtros.prioridade;\r\n      const matchesAno = filtros.anoContratacao === 'todos' || dfd.ano_contratacao?.toString() === filtros.anoContratacao;\r\n\r\n      return matchesBusca && matchesSecretaria && matchesTipo && matchesPrioridade && matchesAno;\r\n    });\r\n  }, [dfds, filtros]);\r\n\r\n  const handleSelectItem = (itemId: string) => {\r\n    setSelectedItems(prev =>\r\n      prev.includes(itemId)\r\n        ? prev.filter(id => id !== itemId)\r\n        : [...prev, itemId]\r\n    );\r\n  };\r\n\r\n  const handleToggleDFD = (dfdId: string) => {\r\n    setExpandedDFDs(prev =>\r\n      prev.includes(dfdId)\r\n        ? prev.filter(id => id !== dfdId)\r\n        : [...prev, dfdId]\r\n    );\r\n  };\r\n\r\n  const handleViewDFD = (dfd: any) => {\r\n    setSelectedDFDForPreview(dfd);\r\n    setShowDFDPreview(true);\r\n  };\r\n\r\n  const handleContinuar = () => {\r\n    const itensSelecionados: any[] = [];\r\n\r\n    dfds.forEach(dfd => {\r\n      dfd.dfd_items?.forEach((item: any) => {\r\n        if (selectedItems.includes(item.id)) {\r\n          itensSelecionados.push({\r\n            ...item,\r\n            dfdNumero: dfd.numero_dfd,\r\n            dfdSecretaria: dfd.area_requisitante\r\n          });\r\n        }\r\n      });\r\n    });\r\n\r\n    onContinuar(itensSelecionados);\r\n  };\r\n\r\n  const getPriorityColor = (prioridade: string | null) => {\r\n    switch (prioridade) {\r\n      case 'Alta':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'M√©dia':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'Baixa':\r\n        return 'bg-green-100 text-green-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const secretarias = [...new Set(dfds.map(d => d.area_requisitante).filter(Boolean))];\r\n  const tipos = [...new Set(dfds.map(d => d.tipo_dfd).filter(Boolean))];\r\n\r\n  const totalSelecionados = selectedItems.length;\r\n  const valorTotalSelecionado = dfds.reduce((total, dfd) => {\r\n    return total + (dfd.dfd_items?.reduce((dfdTotal: number, item: any) => {\r\n      if (selectedItems.includes(item.id)) {\r\n        return dfdTotal + (item.valor_estimado || 0);\r\n      }\r\n      return dfdTotal;\r\n    }, 0) || 0);\r\n  }, 0);\r\n\r\n  const dfdsComSelecaoCount = useMemo(() => {\r\n    const idsMap = new Set();\r\n    dfds.forEach(dfd => {\r\n      if (dfd.dfd_items?.some((item: any) => selectedItems.includes(item.id))) {\r\n        idsMap.add(dfd.id);\r\n      }\r\n    });\r\n    return idsMap.size;\r\n  }, [dfds, selectedItems]);\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={open} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto p-0\">\r\n          <div className=\"sticky top-0 z-10 bg-white border-b p-6\">\r\n            <DialogHeader>\r\n              <DialogTitle className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center text-orange-600\">\r\n                  <Package size={20} className=\"mr-2\" />\r\n                  Itens Espec√≠ficos - Sele√ß√£o para TR\r\n                </div>\r\n                <Button variant=\"ghost\" onClick={onClose} className=\"h-8 w-8 p-0\">\r\n                  <X size={20} />\r\n                </Button>\r\n              </DialogTitle>\r\n            </DialogHeader>\r\n\r\n            {/* Filtros */}\r\n            <div className=\"mt-4 grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-3\">\r\n              <div className=\"lg:col-span-2 relative\">\r\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" size={16} />\r\n                <Input\r\n                  placeholder=\"Buscar DFD...\"\r\n                  value={filtros.busca}\r\n                  onChange={(e) => setFiltros(prev => ({ ...prev, busca: e.target.value }))}\r\n                  className=\"pl-10 h-9\"\r\n                />\r\n              </div>\r\n\r\n              <Select value={filtros.secretaria} onValueChange={(value) => setFiltros(prev => ({ ...prev, secretaria: value }))}>\r\n                <SelectTrigger className=\"h-9\">\r\n                  <SelectValue placeholder=\"√Årea\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"todas\">Todas as √Åreas</SelectItem>\r\n                  {secretarias.map(s => <SelectItem key={s!} value={s!}>{s}</SelectItem>)}\r\n                </SelectContent>\r\n              </Select>\r\n\r\n              <Select value={filtros.tipoDFD} onValueChange={(value) => setFiltros(prev => ({ ...prev, tipoDFD: value }))}>\r\n                <SelectTrigger className=\"h-9\">\r\n                  <SelectValue placeholder=\"Tipo\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"todos\">Todos os Tipos</SelectItem>\r\n                  {tipos.map(t => <SelectItem key={t!} value={t!}>{t}</SelectItem>)}\r\n                </SelectContent>\r\n              </Select>\r\n\r\n              <Select value={filtros.prioridade} onValueChange={(value) => setFiltros(prev => ({ ...prev, prioridade: value }))}>\r\n                <SelectTrigger className=\"h-9\">\r\n                  <SelectValue placeholder=\"Prioridade\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"todas\">Todas</SelectItem>\r\n                  <SelectItem value=\"Alta\">Alta</SelectItem>\r\n                  <SelectItem value=\"M√©dia\">M√©dia</SelectItem>\r\n                  <SelectItem value=\"Baixa\">Baixa</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n\r\n              <Select value={filtros.anoContratacao} onValueChange={(value) => setFiltros(prev => ({ ...prev, anoContratacao: value }))}>\r\n                <SelectTrigger className=\"h-9\">\r\n                  <SelectValue placeholder=\"Ano\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"todos\">Todos</SelectItem>\r\n                  <SelectItem value=\"2024\">2024</SelectItem>\r\n                  <SelectItem value=\"2025\">2025</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"p-6 space-y-4 bg-gray-50/50\">\r\n            {loading ? (\r\n              <div className=\"py-20 text-center\">\r\n                <Loader2 className=\"w-10 h-10 animate-spin mx-auto text-orange-500 mb-2\" />\r\n                <p className=\"text-gray-500\">Buscando itens dos DFDs...</p>\r\n              </div>\r\n            ) : filteredDFDs.length === 0 ? (\r\n              <div className=\"py-20 text-center bg-white border rounded-lg\">\r\n                <Package size={48} className=\"mx-auto text-gray-200 mb-4\" />\r\n                <p className=\"text-gray-500\">Nenhum item aprovado dispon√≠vel.</p>\r\n              </div>\r\n            ) : (\r\n              filteredDFDs.map((dfd) => (\r\n                <Card key={dfd.id} className=\"overflow-hidden border-gray-100 shadow-sm\">\r\n                  <Collapsible\r\n                    open={expandedDFDs.includes(dfd.id)}\r\n                    onOpenChange={() => handleToggleDFD(dfd.id)}\r\n                  >\r\n                    <CollapsibleTrigger asChild>\r\n                      <div className=\"p-4 cursor-pointer hover:bg-gray-50 flex items-center justify-between transition-colors\">\r\n                        <div className=\"flex items-center space-x-4\">\r\n                          <div className={`p-1 rounded bg-gray-100 text-gray-500 transition-transform ${expandedDFDs.includes(dfd.id) ? 'rotate-90' : ''}`}>\r\n                            <ChevronRight size={16} />\r\n                          </div>\r\n                          <div>\r\n                            <div className=\"flex items-center space-x-3\">\r\n                              <span className=\"font-bold text-blue-600\">{dfd.numero_dfd}</span>\r\n                              <Badge className={`${getPriorityColor(dfd.prioridade)} text-[10px]`}>\r\n                                {dfd.prioridade}\r\n                              </Badge>\r\n                            </div>\r\n                            <p className=\"text-xs text-gray-500\">{dfd.descricao_sucinta}</p>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex items-center space-x-6\">\r\n                          <div className=\"text-right\">\r\n                            <p className=\"text-[10px] font-bold text-gray-400 uppercase\">√Årea</p>\r\n                            <p className=\"text-xs text-gray-600\">{dfd.area_requisitante}</p>\r\n                          </div>\r\n                          <div className=\"text-right\">\r\n                            <p className=\"text-[10px] font-bold text-gray-400 uppercase\">Total DFD</p>\r\n                            <p className=\"text-xs font-bold text-green-700\">\r\n                              {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(dfd.valor_estimado_total || 0)}\r\n                            </p>\r\n                          </div>\r\n                          <Button\r\n                            variant=\"ghost\"\r\n                            size=\"sm\"\r\n                            onClick={(e) => {\r\n                              e.stopPropagation();\r\n                              handleViewDFD(dfd);\r\n                            }}\r\n                            className=\"h-8 w-8 p-0\"\r\n                          >\r\n                            <Eye size={16} className=\"text-gray-400\" />\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    </CollapsibleTrigger>\r\n\r\n                    <CollapsibleContent>\r\n                      <div className=\"p-0 bg-white border-t\">\r\n                        <Table>\r\n                          <TableHeader className=\"bg-gray-50/50\">\r\n                            <TableRow>\r\n                              <TableHead className=\"w-12\"></TableHead>\r\n                              <TableHead className=\"font-bold text-xs uppercase text-gray-400\">Item / Especifica√ß√£o</TableHead>\r\n                              <TableHead className=\"font-bold text-xs uppercase text-gray-400\">Unidade</TableHead>\r\n                              <TableHead className=\"font-bold text-xs uppercase text-gray-400\">Qtd</TableHead>\r\n                              <TableHead className=\"font-bold text-xs uppercase text-gray-400\">Valor Unit.</TableHead>\r\n                              <TableHead className=\"font-bold text-xs uppercase text-gray-400\">Valor Total</TableHead>\r\n                              <TableHead className=\"font-bold text-xs uppercase text-gray-400\">Status</TableHead>\r\n                            </TableRow>\r\n                          </TableHeader>\r\n                          <TableBody>\r\n                            {dfd.dfd_items?.map((item: any) => {\r\n                              const isUtilizado = !!item.tr_id;\r\n                              return (\r\n                                <TableRow\r\n                                  key={item.id}\r\n                                  className={`${isUtilizado ? 'bg-red-50/30' :\r\n                                      selectedItems.includes(item.id) ? 'bg-orange-50/30' : ''\r\n                                    }`}\r\n                                >\r\n                                  <TableCell>\r\n                                    <Checkbox\r\n                                      checked={selectedItems.includes(item.id)}\r\n                                      onCheckedChange={() => handleSelectItem(item.id)}\r\n                                      disabled={isUtilizado}\r\n                                    />\r\n                                  </TableCell>\r\n                                  <TableCell className=\"max-w-xs\">\r\n                                    <p className={`text-sm font-medium ${isUtilizado ? 'text-gray-400' : 'text-gray-900'}`}>{item.descricao}</p>\r\n                                    {item.especificacao && <p className=\"text-[10px] text-gray-400 truncate\">{item.especificacao}</p>}\r\n                                  </TableCell>\r\n                                  <TableCell className=\"text-xs\">{item.unidade_medida}</TableCell>\r\n                                  <TableCell className=\"text-xs\">{item.quantidade}</TableCell>\r\n                                  <TableCell className=\"text-xs\">\r\n                                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(item.valor_unitario || 0)}\r\n                                  </TableCell>\r\n                                  <TableCell className=\"text-sm font-bold text-green-700\">\r\n                                    {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(item.valor_total || 0)}\r\n                                  </TableCell>\r\n                                  <TableCell>\r\n                                    {isUtilizado ? (\r\n                                      <Badge variant=\"destructive\" className=\"text-[9px] uppercase font-bold py-0\">Ocupado</Badge>\r\n                                    ) : (\r\n                                      <Badge variant=\"outline\" className=\"text-[9px] uppercase font-bold text-green-600 border-green-200 py-0\">Dispon√≠vel</Badge>\r\n                                    )}\r\n                                  </TableCell>\r\n                                </TableRow>\r\n                              );\r\n                            })}\r\n                          </TableBody>\r\n                        </Table>\r\n                      </div>\r\n                    </CollapsibleContent>\r\n                  </Collapsible>\r\n                </Card>\r\n              ))\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"sticky bottom-0 z-10 p-6 border-t bg-white flex items-center justify-between shadow-lg\">\r\n            <div className=\"flex items-center space-x-6\">\r\n              <div className=\"text-left\">\r\n                <p className=\"text-[10px] font-bold text-gray-400 uppercase\">Itens Selecionados</p>\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <span className=\"text-lg font-bold text-orange-600\">{totalSelecionados}</span>\r\n                  <p className=\"text-xs text-gray-500\">em <span className=\"font-bold\">{dfdsComSelecaoCount}</span> DFD(s)</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"text-left border-l pl-6\">\r\n                <p className=\"text-[10px] font-bold text-gray-400 uppercase\">Subtotal Estimado</p>\r\n                <p className=\"text-lg font-bold text-green-700\">\r\n                  {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valorTotalSelecionado)}\r\n                </p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Button variant=\"ghost\" onClick={onClose} className=\"text-gray-500\">\r\n                Cancelar\r\n              </Button>\r\n              <Button\r\n                onClick={handleContinuar}\r\n                disabled={selectedItems.length === 0}\r\n                className=\"bg-orange-500 hover:bg-orange-600 min-w-[150px] shadow-sm\"\r\n              >\r\n                Avan√ßar para TR\r\n                <ArrowRight size={16} className=\"ml-2\" />\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Modal de Preview do DFD */}\r\n      <DFDViewModal\r\n        open={showDFDPreview}\r\n        onClose={() => setShowDFDPreview(false)}\r\n        dfd={selectedDFDForPreview}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ItensEspecificosModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\TermoReferencia\\TRCreationWizard.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1222,1225],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1222,1225],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1269,1272],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1269,1272],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":291,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":291,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12362,12365],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12362,12365],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Checkbox } from '@/components/ui/checkbox';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport {\r\n  X,\r\n  Save,\r\n  Sparkles,\r\n  FileText,\r\n  Building,\r\n  DollarSign,\r\n  Calendar,\r\n  CheckCircle,\r\n  ArrowLeft,\r\n  ArrowRight,\r\n  Package,\r\n  Eye,\r\n  EyeOff,\r\n  Plus,\r\n  Minus,\r\n  Info,\r\n  Loader2\r\n} from 'lucide-react';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { termoReferenciaService } from '@/services/termoReferenciaService';\r\nimport { DbTermoReferencia } from '@/types/database';\r\n\r\ninterface TRCreationWizardProps {\r\n  origin: 'cronograma' | 'dfds-livres' | 'itens-especificos';\r\n  selectedData: any;\r\n  onClose: () => void;\r\n  onSave: (data: any) => void;\r\n}\r\n\r\ninterface GestorFiscal {\r\n  nome: string;\r\n  cargo: string;\r\n  matricula: string;\r\n}\r\n\r\ninterface FormData {\r\n  // Etapa 1 - Identifica√ß√£o\r\n  numero: string;\r\n  origem: string;\r\n  etpsSelecionados: string[];\r\n\r\n  // Etapa 2 - Objeto e Natureza\r\n  objeto: string;\r\n  naturezaObjeto: string;\r\n  naturezaOutra: string;\r\n\r\n  // Etapa 3 - Modalidade e Registro de Pre√ßos\r\n  modalidade: string;\r\n  justificativaLegal: string;\r\n  artigoLegal: string;\r\n  sistemaRegistroPrecos: boolean;\r\n  justificativaRegistroPrecos: string;\r\n  justificativaComplementar: string;\r\n\r\n  // Etapa 4 - Tratamento Diferenciado\r\n  tratamentoMEEPP: string;\r\n  participacaoConsorcio: boolean;\r\n  justificativaConsorcio: string;\r\n  participacaoCooperativas: boolean;\r\n  subcontratacao: boolean;\r\n  detalhesSubcontratacao: string;\r\n\r\n  // Etapa 5 - Vistoria e Amostras\r\n  vistoriaTecnica: string;\r\n  justificativaVistoria: string;\r\n  unidadeResponsavelVistoria: string;\r\n  contatoVistoria: string;\r\n  amostrasExigidas: boolean;\r\n  prazoAmostras: string;\r\n  unidadeTecnicaAmostras: string;\r\n  localAmostras: string;\r\n\r\n  // Etapa 6 - Documenta√ß√£o\r\n  habilitacaoJuridica: string[];\r\n  habilitacaoFiscal: string[];\r\n  qualificacaoEconomica: string[];\r\n  qualificacaoTecnica: string[];\r\n  documentosAdicionais: string;\r\n\r\n  // Etapa 7 - Condi√ß√µes de Execu√ß√£o\r\n  prazoEntrega: string;\r\n  ordemFornecimento: string;\r\n  enderecoEntrega: string;\r\n  garantiaProduto: boolean;\r\n  condicoesGarantia: string;\r\n  fornecimentoContinuo: boolean;\r\n  justificativaFornecimento: string;\r\n\r\n  // Etapa 8 - Vig√™ncia e Pagamento\r\n  prazoVigencia: string;\r\n  prazoSubstituicao: string;\r\n  prazoRecebimento: string;\r\n  prazoLiquidacao: string;\r\n  prazoPagamento: string;\r\n\r\n  // Etapa 9 - Gest√£o e Fiscaliza√ß√£o\r\n  gestores: GestorFiscal[];\r\n  fiscais: GestorFiscal[];\r\n\r\n  // Etapa 10 - Itens e Valor\r\n  mostrarValores: boolean;\r\n  observacoes: string;\r\n}\r\n\r\nconst generateTRNumber = () => {\r\n  const sequence = Math.floor(Math.random() * 1000).toString().padStart(3, '0');\r\n  return `TR-${sequence}`;\r\n};\r\n\r\nconst TRCreationWizard = ({ origin, selectedData, onClose, onSave }: TRCreationWizardProps) => {\r\n  const { user } = useAuth();\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [loading, setLoading] = useState(false);\r\n  const [formData, setFormData] = useState<FormData>({\r\n    // Etapa 1\r\n    numero: generateTRNumber(),\r\n    origem: origin,\r\n    etpsSelecionados: [],\r\n\r\n    // Etapa 2\r\n    objeto: '',\r\n    naturezaObjeto: '',\r\n    naturezaOutra: '',\r\n\r\n    // Etapa 3\r\n    modalidade: '',\r\n    justificativaLegal: '',\r\n    artigoLegal: '',\r\n    sistemaRegistroPrecos: false,\r\n    justificativaRegistroPrecos: '',\r\n    justificativaComplementar: '',\r\n\r\n    // Etapa 4\r\n    tratamentoMEEPP: '',\r\n    participacaoConsorcio: false,\r\n    justificativaConsorcio: '',\r\n    participacaoCooperativas: false,\r\n    subcontratacao: false,\r\n    detalhesSubcontratacao: '',\r\n\r\n    // Etapa 5\r\n    vistoriaTecnica: 'nao',\r\n    justificativaVistoria: '',\r\n    unidadeResponsavelVistoria: '',\r\n    contatoVistoria: '',\r\n    amostrasExigidas: false,\r\n    prazoAmostras: '',\r\n    unidadeTecnicaAmostras: '',\r\n    localAmostras: '',\r\n\r\n    // Etapa 6\r\n    habilitacaoJuridica: [],\r\n    habilitacaoFiscal: [],\r\n    qualificacaoEconomica: [],\r\n    qualificacaoTecnica: [],\r\n    documentosAdicionais: '',\r\n\r\n    // Etapa 7\r\n    prazoEntrega: '30',\r\n    ordemFornecimento: 'unica',\r\n    enderecoEntrega: '',\r\n    garantiaProduto: false,\r\n    condicoesGarantia: '',\r\n    fornecimentoContinuo: false,\r\n    justificativaFornecimento: '',\r\n\r\n    // Etapa 8\r\n    prazoVigencia: '12',\r\n    prazoSubstituicao: '5',\r\n    prazoRecebimento: '5',\r\n    prazoLiquidacao: '5',\r\n    prazoPagamento: '30',\r\n\r\n    // Etapa 9\r\n    gestores: [{ nome: '', cargo: '', matricula: '' }],\r\n    fiscais: [{ nome: '', cargo: '', matricula: '' }],\r\n\r\n    // Etapa 10\r\n    mostrarValores: true,\r\n    observacoes: ''\r\n  });\r\n\r\n  const { toast } = useToast();\r\n\r\n  // Auto-fill natureza do objeto based on DFD type\r\n  useEffect(() => {\r\n    if (selectedData && !formData.naturezaObjeto) {\r\n      let natureza = '';\r\n\r\n      if (origin === 'cronograma' && selectedData?.tipoDFD) {\r\n        natureza = mapDFDTypeToNatureza(selectedData.tipoDFD);\r\n      } else if (origin === 'dfds-livres' && Array.isArray(selectedData)) {\r\n        const tipos = selectedData.map(dfd => dfd.tipoDFD);\r\n        const tipoMaisComum = tipos.sort((a, b) =>\r\n          tipos.filter(v => v === a).length - tipos.filter(v => v === b).length\r\n        ).pop();\r\n        natureza = mapDFDTypeToNatureza(tipoMaisComum);\r\n      }\r\n\r\n      if (natureza) {\r\n        setFormData(prev => ({ ...prev, naturezaObjeto: natureza }));\r\n      }\r\n    }\r\n  }, [selectedData, origin, formData.naturezaObjeto]);\r\n\r\n  const mapDFDTypeToNatureza = (tipoDFD: string): string => {\r\n    const mapping: { [key: string]: string } = {\r\n      'Material de Consumo': 'materiais-consumo',\r\n      'Material Permanente': 'materiais-permanentes',\r\n      'Equipamento': 'materiais-permanentes',\r\n      'Servi√ßo': 'servico-nao-continuado',\r\n      'Servi√ßo de Engenharia': 'servico-engenharia',\r\n      'Obra': 'servico-engenharia'\r\n    };\r\n    return mapping[tipoDFD] || 'materiais-consumo';\r\n  };\r\n\r\n  const steps = [\r\n    { title: 'Identifica√ß√£o e Origem', icon: <FileText size={16} /> },\r\n    { title: 'Objeto e Natureza', icon: <Package size={16} /> },\r\n    { title: 'Modalidade e Registro', icon: <Building size={16} /> },\r\n    { title: 'Tratamento Diferenciado', icon: <CheckCircle size={16} /> },\r\n    { title: 'Vistoria e Amostras', icon: <Eye size={16} /> },\r\n    { title: 'Documenta√ß√£o Exigida', icon: <FileText size={16} /> },\r\n    { title: 'Condi√ß√µes de Execu√ß√£o', icon: <Calendar size={16} /> },\r\n    { title: 'Vig√™ncia e Pagamento', icon: <DollarSign size={16} /> },\r\n    { title: 'Gest√£o e Fiscaliza√ß√£o', icon: <Building size={16} /> },\r\n    { title: 'Itens e Valor Estimado', icon: <Package size={16} /> }\r\n  ];\r\n\r\n  const documentationData = {\r\n    habilitacaoJuridica: [\r\n      { id: 'pessoa-fisica', label: 'Pessoa f√≠sica', tooltip: 'C√©dula de identidade (RG) ou equivalente v√°lido nacionalmente.' },\r\n      { id: 'empresario-individual', label: 'Empres√°rio individual', tooltip: 'Inscri√ß√£o no Registro P√∫blico de Empresas Mercantis (Junta Comercial).' },\r\n      { id: 'mei', label: 'Microempreendedor Individual (MEI)', tooltip: 'Certificado de Condi√ß√£o de Microempreendedor Individual (CCMEI).' },\r\n      { id: 'sociedade-empresaria', label: 'Sociedade empres√°ria / SLU / EIRELI', tooltip: 'Contrato social ou estatuto registrado na Junta Comercial + comprova√ß√£o dos administradores.' },\r\n      { id: 'sociedade-estrangeira', label: 'Sociedade empres√°ria estrangeira', tooltip: 'Portaria de autoriza√ß√£o de funcionamento no Brasil, publicada no DOU.' },\r\n      { id: 'sociedade-simples', label: 'Sociedade simples', tooltip: 'Ato constitutivo registrado no Registro Civil das Pessoas Jur√≠dicas + administradores.' },\r\n      { id: 'filial-sucursal', label: 'Filial / sucursal / ag√™ncia', tooltip: 'Ato constitutivo da matriz e da filial com averba√ß√µes nos respectivos registros.' },\r\n      { id: 'sociedade-cooperativa', label: 'Sociedade cooperativa', tooltip: 'Estatuto social + ata de funda√ß√£o + registro na Junta Comercial e no √≥rg√£o competente.' },\r\n      { id: 'agricultor-familiar', label: 'Agricultor familiar', tooltip: 'DAP v√°lida ou outro documento reconhecido pela Secretaria de Agricultura Familiar.' },\r\n      { id: 'produtor-rural', label: 'Produtor rural', tooltip: 'Matr√≠cula no Cadastro Espec√≠fico do INSS ‚Äì CEI.' }\r\n    ],\r\n    habilitacaoFiscal: [\r\n      { id: 'cnpj-cpf', label: 'CNPJ ou CPF', tooltip: 'Prova de inscri√ß√£o no Cadastro Nacional de Pessoas Jur√≠dicas ou F√≠sicas.' },\r\n      { id: 'regularidade-fiscal-federal', label: 'Regularidade fiscal federal', tooltip: 'Certid√£o conjunta da Receita Federal e da PGFN.' },\r\n      { id: 'regularidade-fgts', label: 'Regularidade com o FGTS', tooltip: 'Certid√£o de regularidade do FGTS emitida pela Caixa.' },\r\n      { id: 'regularidade-trabalhista', label: 'Regularidade trabalhista', tooltip: 'Certid√£o de d√©bitos trabalhistas (CNDT).' },\r\n      { id: 'cadastro-contribuintes', label: 'Cadastro de contribuintes municipal/estadual', tooltip: 'Prova de inscri√ß√£o no cadastro do domic√≠lio da empresa.' },\r\n      { id: 'regularidade-fiscal-local', label: 'Regularidade fiscal municipal/estadual', tooltip: 'Certid√£o de regularidade fiscal com a Fazenda local.' }\r\n    ],\r\n    qualificacaoEconomica: [\r\n      { id: 'certidao-insolvencia', label: 'Certid√£o negativa de insolv√™ncia civil (pessoa f√≠sica/sociedade simples)', tooltip: 'Emitida pelo distribuidor da comarca do domic√≠lio ou sede do licitante.' },\r\n      { id: 'certidao-falencia', label: 'Certid√£o negativa de fal√™ncia', tooltip: 'Emitida pelo distribuidor da sede da empresa.' },\r\n      { id: 'indices-financeiros', label: '√çndices financeiros (LG, SG, LC)', tooltip: 'Demonstra√ß√µes cont√°beis dos 2 √∫ltimos exerc√≠cios com √≠ndices superiores a 1.' }\r\n    ],\r\n    qualificacaoTecnica: [\r\n      { id: 'registro-profissional', label: 'Registro na entidade profissional competente', tooltip: 'Comprova√ß√£o de regularidade no conselho ou ordem da atividade fim.' },\r\n      { id: 'atestado-capacidade', label: 'Atestado(s) de capacidade t√©cnica', tooltip: 'Comprova√ß√£o de experi√™ncia anterior compat√≠vel com o objeto da licita√ß√£o.' },\r\n      { id: 'relacao-cooperados', label: 'Rela√ß√£o de cooperados (quando aplic√°vel)', tooltip: 'Lista dos cooperados que executar√£o o contrato, com comprova√ß√£o de domic√≠lio local.' },\r\n      { id: 'declaracao-cooperados', label: 'Declara√ß√£o de regularidade dos cooperados (DRSCI)', tooltip: 'Uma para cada cooperado indicado.' },\r\n      { id: 'capital-social-cooperativa', label: 'Comprova√ß√£o do capital social proporcional (cooperativas)', tooltip: 'Com base na quantidade de cooperados necess√°rios ao servi√ßo.' },\r\n      { id: 'documentacao-cooperativa', label: 'Documenta√ß√£o jur√≠dica da cooperativa', tooltip: 'Ata de funda√ß√£o, estatuto, assembleias, fundos e registros de presen√ßa.' },\r\n      { id: 'auditoria-cooperativa', label: '√öltima auditoria cont√°bil-financeira (ou declara√ß√£o de isen√ß√£o)', tooltip: 'Conforme art. 112 da Lei 5.764/1971.' }\r\n    ]\r\n  };\r\n\r\n  const artigosLegais = [\r\n    { value: 'art-74-i', label: 'Art. 74, inciso I - Situa√ß√£o de emerg√™ncia ou calamidade p√∫blica' },\r\n    { value: 'art-74-ii', label: 'Art. 74, inciso II - Para atender a situa√ß√£o de urg√™ncia' },\r\n    { value: 'art-74-iii', label: 'Art. 74, inciso III - Quando n√£o acudirem interessados √† licita√ß√£o anterior' },\r\n    { value: 'art-75-i', label: 'Art. 75, inciso I - Compras at√© R$ 50.000,00' },\r\n    { value: 'art-75-ii', label: 'Art. 75, inciso II - Servi√ßos e obras de engenharia at√© R$ 100.000,00' },\r\n    { value: 'art-25-i', label: 'Art. 25, inciso I - Fornecedor exclusivo' },\r\n    { value: 'art-25-ii', label: 'Art. 25, inciso II - Servi√ßos t√©cnicos especializados' }\r\n  ];\r\n\r\n  const handleInputChange = (field: keyof FormData, value: any) => {\r\n    setFormData(prev => ({ ...prev, [field]: value }));\r\n  };\r\n\r\n  const handleArrayChange = (field: keyof FormData, value: string, checked: boolean) => {\r\n    setFormData(prev => {\r\n      const currentArray = prev[field] as string[];\r\n      if (checked) {\r\n        return { ...prev, [field]: [...currentArray, value] };\r\n      } else {\r\n        return { ...prev, [field]: currentArray.filter(item => item !== value) };\r\n      }\r\n    });\r\n  };\r\n\r\n  const handleGestorFiscalChange = (type: 'gestores' | 'fiscais', index: number, field: keyof GestorFiscal, value: string) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [type]: prev[type].map((item, i) =>\r\n        i === index ? { ...item, [field]: value } : item\r\n      )\r\n    }));\r\n  };\r\n\r\n  const addGestorFiscal = (type: 'gestores' | 'fiscais') => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [type]: [...prev[type], { nome: '', cargo: '', matricula: '' }]\r\n    }));\r\n  };\r\n\r\n  const removeGestorFiscal = (type: 'gestores' | 'fiscais', index: number) => {\r\n    if (formData[type].length > 1) {\r\n      setFormData(prev => ({\r\n        ...prev,\r\n        [type]: prev[type].filter((_, i) => i !== index)\r\n      }));\r\n    }\r\n  };\r\n\r\n  const generateWithAI = (field: keyof FormData) => {\r\n    const aiContent: Record<string, string> = {\r\n      objeto: `Contrata√ß√£o de empresa especializada para fornecimento de ${getOriginDescription()}, conforme especifica√ß√µes t√©cnicas estabelecidas.`,\r\n      justificativaVistoria: 'Vistoria t√©cnica necess√°ria para verifica√ß√£o das condi√ß√µes locais e adequa√ß√£o t√©cnica.',\r\n      justificativaFornecimento: 'Fornecimento cont√≠nuo justificado pela natureza do objeto e necessidade de continuidade dos servi√ßos.',\r\n      justificativaComplementar: 'Sistema de Registro de Pre√ßos justificado pela natureza do objeto e necessidade de contrata√ß√µes m√∫ltiplas ao longo do per√≠odo.',\r\n      justificativaConsorcio: 'A participa√ß√£o em cons√≥rcio n√£o √© recomendada tendo em vista a natureza e complexidade do objeto, que pode ser executado por uma √∫nica empresa.',\r\n      detalhesSubcontratacao: 'A subcontrata√ß√£o ser√° permitida at√© o limite de 30% do valor total do contrato, mediante pr√©via autoriza√ß√£o da Administra√ß√£o.',\r\n      condicoesGarantia: 'Garantia m√≠nima de 12 meses contra defeitos de fabrica√ß√£o e funcionamento.',\r\n      enderecoEntrega: 'Endere√ßo da secretaria solicitante conforme especificado.',\r\n      documentosAdicionais: 'Documentos complementares conforme natureza espec√≠fica do objeto.',\r\n      observacoes: 'Observa√ß√µes adicionais sobre a execu√ß√£o do contrato.'\r\n    };\r\n\r\n    if (aiContent[field]) {\r\n      handleInputChange(field, aiContent[field]);\r\n      toast({\r\n        title: \"Campo preenchido com IA\",\r\n        description: \"Conte√∫do gerado automaticamente.\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const getOriginDescription = () => {\r\n    if (origin === 'cronograma' && selectedData?.tipoDFD) {\r\n      return selectedData.tipoDFD.toLowerCase();\r\n    } else if (origin === 'dfds-livres' && Array.isArray(selectedData)) {\r\n      const tipos = [...new Set(selectedData.map(dfd => dfd.tipoDFD))];\r\n      return tipos.join(', ').toLowerCase();\r\n    } else if (origin === 'itens-especificos' && Array.isArray(selectedData)) {\r\n      return 'itens espec√≠ficos selecionados';\r\n    }\r\n    return 'materiais';\r\n  };\r\n\r\n  const calculateTotalValue = () => {\r\n    if (origin === 'cronograma' && selectedData?.valorTotal) {\r\n      return selectedData.valorTotal;\r\n    } else if (origin === 'dfds-livres' && Array.isArray(selectedData)) {\r\n      const total = selectedData.reduce((sum, dfd) => {\r\n        const valor = parseFloat(dfd.valorTotal.replace(/[^\\d,]/g, '').replace(',', '.'));\r\n        return sum + valor;\r\n      }, 0);\r\n      return `R$ ${total.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;\r\n    } else if (origin === 'itens-especificos' && Array.isArray(selectedData)) {\r\n      const total = selectedData.reduce((sum, item) => {\r\n        const valor = parseFloat(item.valorEstimado.replace(/[^\\d,]/g, '').replace(',', '.'));\r\n        return sum + valor;\r\n      }, 0);\r\n      return `R$ ${total.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`;\r\n    }\r\n    return 'R$ 0,00';\r\n  };\r\n\r\n  const getSelectedItems = () => {\r\n    if (origin === 'itens-especificos' && Array.isArray(selectedData)) {\r\n      return selectedData;\r\n    }\r\n    return [];\r\n  };\r\n\r\n  const nextStep = () => {\r\n    if (currentStep < steps.length - 1) {\r\n      setCurrentStep(currentStep + 1);\r\n    }\r\n  };\r\n\r\n  const prevStep = () => {\r\n    if (currentStep > 0) {\r\n      setCurrentStep(currentStep - 1);\r\n    }\r\n  };\r\n\r\n  const handleSave = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const valorEstimado = parseFloat(calculateTotalValue().replace(/[^\\d,]/g, '').replace(',', '.')) || 0;\r\n\r\n      const trData: Omit<DbTermoReferencia, 'id' | 'created_at' | 'updated_at'> = {\r\n        numero_tr: formData.numero,\r\n        etp_id: null, // Pode ser preenchido se vier de um ETP\r\n        objeto: formData.objeto,\r\n        status: 'Em Elabora√ß√£o',\r\n        tipo: formData.naturezaObjeto,\r\n        valor_estimado: valorEstimado,\r\n        secretaria_id: user?.secretaria_id || null,\r\n        prefeitura_id: user?.prefeituraId || null,\r\n        dados_json: formData,\r\n        created_by: user?.id || null,\r\n      };\r\n\r\n      const result = await termoReferenciaService.createTermoReferencia(trData);\r\n      onSave(result);\r\n    } catch (error) {\r\n      console.error('Erro ao salvar TR:', error);\r\n      toast({\r\n        title: \"Erro ao salvar\",\r\n        description: \"N√£o foi poss√≠vel salvar o rascunho do TR.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFinalize = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const valorEstimado = parseFloat(calculateTotalValue().replace(/[^\\d,]/g, '').replace(',', '.')) || 0;\r\n\r\n      const trData: Omit<DbTermoReferencia, 'id' | 'created_at' | 'updated_at'> = {\r\n        numero_tr: formData.numero,\r\n        etp_id: null,\r\n        objeto: formData.objeto,\r\n        status: 'Conclu√≠do',\r\n        tipo: formData.naturezaObjeto,\r\n        valor_estimado: valorEstimado,\r\n        secretaria_id: user?.secretaria_id || null,\r\n        prefeitura_id: user?.prefeituraId || null,\r\n        dados_json: formData,\r\n        created_by: user?.id || null,\r\n      };\r\n\r\n      const result = await termoReferenciaService.createTermoReferencia(trData);\r\n      onSave(result);\r\n    } catch (error) {\r\n      console.error('Erro ao finalizar TR:', error);\r\n      toast({\r\n        title: \"Erro ao finalizar\",\r\n        description: \"N√£o foi poss√≠vel finalizar o TR.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const getSecretariaInfo = () => {\r\n    if (origin === 'cronograma' && selectedData?.secretariasNomes) {\r\n      return selectedData.secretariasNomes[0];\r\n    } else if (origin === 'dfds-livres' && Array.isArray(selectedData)) {\r\n      const secretarias = [...new Set(selectedData.map(dfd => dfd.secretaria))];\r\n      return secretarias.join(', ');\r\n    } else if (origin === 'itens-especificos' && Array.isArray(selectedData)) {\r\n      const secretarias = [...new Set(selectedData.map(item => item.dfdSecretaria))];\r\n      return secretarias.join(', ');\r\n    }\r\n    return 'Secretaria';\r\n  };\r\n\r\n  const getDFDCount = () => {\r\n    if (origin === 'cronograma' && selectedData?.dfdIds) {\r\n      return selectedData.dfdIds.length;\r\n    } else if (origin === 'dfds-livres' && Array.isArray(selectedData)) {\r\n      return selectedData.length;\r\n    } else if (origin === 'itens-especificos' && Array.isArray(selectedData)) {\r\n      return [...new Set(selectedData.map(item => item.dfdNumero))].length;\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  const renderStepContent = () => {\r\n    switch (currentStep) {\r\n      case 0: // Etapa 1: Identifica√ß√£o e Origem\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label>N√∫mero do TR</Label>\r\n                <Input\r\n                  value={formData.numero}\r\n                  onChange={(e) => handleInputChange('numero', e.target.value)}\r\n                  disabled\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>Origem</Label>\r\n                <Input\r\n                  value={origin === 'cronograma' ? 'Cronograma de Licita√ß√µes' :\r\n                    origin === 'dfds-livres' ? 'DFDs Livres' : 'Itens Espec√≠ficos'}\r\n                  disabled\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              <h4 className=\"font-medium\">Dados da Origem Selecionada</h4>\r\n              <div className=\"bg-gray-50 p-4 rounded-lg space-y-3\">\r\n                {origin === 'cronograma' && selectedData && (\r\n                  <>\r\n                    <div><strong>Tipo:</strong> {selectedData.tipoDFD}</div>\r\n                    <div><strong>Secretarias:</strong> {selectedData.secretariasNomes?.join(', ')}</div>\r\n                    <div><strong>Valor Total:</strong> {selectedData.valorTotal}</div>\r\n                    <div><strong>DFDs Vinculados:</strong> {selectedData.dfdIds?.length || 0}</div>\r\n                  </>\r\n                )}\r\n                {origin === 'dfds-livres' && Array.isArray(selectedData) && (\r\n                  <>\r\n                    <div><strong>DFDs Selecionados:</strong> {selectedData.length}</div>\r\n                    <div><strong>Secretarias:</strong> {[...new Set(selectedData.map(dfd => dfd.secretaria))].join(', ')}</div>\r\n                    <div><strong>Valor Total:</strong> {calculateTotalValue()}</div>\r\n                  </>\r\n                )}\r\n                {origin === 'itens-especificos' && Array.isArray(selectedData) && (\r\n                  <>\r\n                    <div><strong>Itens Selecionados:</strong> {selectedData.length}</div>\r\n                    <div><strong>DFDs Envolvidos:</strong> {[...new Set(selectedData.map(item => item.dfdNumero))].length}</div>\r\n                    <div><strong>Valor Total:</strong> {calculateTotalValue()}</div>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      case 1: // Etapa 2: Objeto e Natureza\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Label>Objeto da Contrata√ß√£o *</Label>\r\n                <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('objeto')}>\r\n                  <Sparkles size={14} className=\"mr-1\" />\r\n                  IA\r\n                </Button>\r\n              </div>\r\n              <Textarea\r\n                value={formData.objeto}\r\n                onChange={(e) => handleInputChange('objeto', e.target.value)}\r\n                rows={4}\r\n                placeholder=\"Descreva o objeto da contrata√ß√£o de forma precisa, suficiente e clara...\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>Natureza do Objeto *</Label>\r\n              <Select value={formData.naturezaObjeto} onValueChange={(value) => handleInputChange('naturezaObjeto', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione a natureza do objeto\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"materiais-consumo\">Materiais de Consumo</SelectItem>\r\n                  <SelectItem value=\"materiais-permanentes\">Materiais Permanentes</SelectItem>\r\n                  <SelectItem value=\"servico-continuado\">Servi√ßo Continuado</SelectItem>\r\n                  <SelectItem value=\"servico-nao-continuado\">Servi√ßo N√£o Continuado</SelectItem>\r\n                  <SelectItem value=\"servico-engenharia\">Servi√ßo de Engenharia</SelectItem>\r\n                  <SelectItem value=\"termo-aditivo\">Termo Aditivo</SelectItem>\r\n                  <SelectItem value=\"outro\">Outro</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            {formData.naturezaObjeto === 'outro' && (\r\n              <div className=\"space-y-2\">\r\n                <Label>Especifique a Natureza *</Label>\r\n                <Input\r\n                  value={formData.naturezaOutra}\r\n                  onChange={(e) => handleInputChange('naturezaOutra', e.target.value)}\r\n                  placeholder=\"Descreva a natureza do objeto...\"\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        );\r\n\r\n      case 2: // Etapa 3: Modalidade e Registro de Pre√ßos\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"space-y-2\">\r\n              <Label>Modalidade de Licita√ß√£o *</Label>\r\n              <Select value={formData.modalidade} onValueChange={(value) => handleInputChange('modalidade', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione a modalidade\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"dispensa\">Dispensa</SelectItem>\r\n                  <SelectItem value=\"inexigibilidade\">Inexigibilidade</SelectItem>\r\n                  <SelectItem value=\"pregao\">Preg√£o</SelectItem>\r\n                  <SelectItem value=\"concorrencia\">Concorr√™ncia</SelectItem>\r\n                  <SelectItem value=\"concurso\">Concurso</SelectItem>\r\n                  <SelectItem value=\"leilao\">Leil√£o</SelectItem>\r\n                  <SelectItem value=\"dialogo-competitivo\">Di√°logo Competitivo</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            {(formData.modalidade === 'dispensa' || formData.modalidade === 'inexigibilidade') && (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>Artigo Legal da Lei 14.133/2021 *</Label>\r\n                  <Select value={formData.artigoLegal} onValueChange={(value) => handleInputChange('artigoLegal', value)}>\r\n                    <SelectTrigger>\r\n                      <SelectValue placeholder=\"Selecione o artigo legal aplic√°vel\" />\r\n                    </SelectTrigger>\r\n                    <SelectContent>\r\n                      {artigosLegais.map((artigo) => (\r\n                        <SelectItem key={artigo.value} value={artigo.value}>\r\n                          {artigo.label}\r\n                        </SelectItem>\r\n                      ))}\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <Label>Justificativa Legal *</Label>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('justificativaLegal')}>\r\n                      <Sparkles size={14} className=\"mr-1\" />\r\n                      IA\r\n                    </Button>\r\n                  </div>\r\n                  <Textarea\r\n                    value={formData.justificativaLegal}\r\n                    onChange={(e) => handleInputChange('justificativaLegal', e.target.value)}\r\n                    rows={4}\r\n                    placeholder=\"Justifique a aplica√ß√£o do artigo legal selecionado...\"\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Checkbox\r\n                  id=\"registro-precos\"\r\n                  checked={formData.sistemaRegistroPrecos}\r\n                  onCheckedChange={(checked) => handleInputChange('sistemaRegistroPrecos', checked)}\r\n                />\r\n                <Label htmlFor=\"registro-precos\">Adotar√° Sistema de Registro de Pre√ßos (SRP)?</Label>\r\n              </div>\r\n\r\n              {formData.sistemaRegistroPrecos && (\r\n                <div className=\"space-y-4 ml-6\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Justificativa para SRP *</Label>\r\n                    <Select value={formData.justificativaRegistroPrecos} onValueChange={(value) => handleInputChange('justificativaRegistroPrecos', value)}>\r\n                      <SelectTrigger>\r\n                        <SelectValue placeholder=\"Selecione a justificativa\" />\r\n                      </SelectTrigger>\r\n                      <SelectContent>\r\n                        <SelectItem value=\"contratacoes-frequentes\">Contrata√ß√µes frequentes</SelectItem>\r\n                        <SelectItem value=\"multiplos-orgaos\">Atende m√∫ltiplos √≥rg√£os</SelectItem>\r\n                        <SelectItem value=\"quantidade-indeterminada\">N√£o √© poss√≠vel prever quantidade exata</SelectItem>\r\n                      </SelectContent>\r\n                    </Select>\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <Label>Justificativa Complementar</Label>\r\n                      <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('justificativaComplementar')}>\r\n                        <Sparkles size={14} className=\"mr-1\" />\r\n                        IA\r\n                      </Button>\r\n                    </div>\r\n                    <Textarea\r\n                      value={formData.justificativaComplementar}\r\n                      onChange={(e) => handleInputChange('justificativaComplementar', e.target.value)}\r\n                      rows={3}\r\n                      placeholder=\"Justificativa adicional para o Sistema de Registro de Pre√ßos...\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      case 3: // Etapa 4: Tratamento Diferenciado e Participa√ß√£o\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"space-y-2\">\r\n              <Label>Tratamento Diferenciado ME/EPP *</Label>\r\n              <Select value={formData.tratamentoMEEPP} onValueChange={(value) => handleInputChange('tratamentoMEEPP', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione o tratamento\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"exclusiva\">Participa√ß√£o exclusiva para ME/EPP</SelectItem>\r\n                  <SelectItem value=\"cota-reservada\">Cota reservada para ME/EPP</SelectItem>\r\n                  <SelectItem value=\"nao-aplicado\">N√£o ser√° aplicado</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Checkbox\r\n                  id=\"participacao-consorcio\"\r\n                  checked={formData.participacaoConsorcio}\r\n                  onCheckedChange={(checked) => handleInputChange('participacaoConsorcio', checked)}\r\n                />\r\n                <Label htmlFor=\"participacao-consorcio\">Participa√ß√£o em cons√≥rcio permitida?</Label>\r\n              </div>\r\n\r\n              {!formData.participacaoConsorcio && (\r\n                <div className=\"space-y-2 ml-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <Label>Justificativa para n√£o permitir cons√≥rcio</Label>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('justificativaConsorcio')}>\r\n                      <Sparkles size={14} className=\"mr-1\" />\r\n                      IA\r\n                    </Button>\r\n                  </div>\r\n                  <Textarea\r\n                    value={formData.justificativaConsorcio}\r\n                    onChange={(e) => handleInputChange('justificativaConsorcio', e.target.value)}\r\n                    rows={2}\r\n                    placeholder=\"Justifique por que n√£o ser√° permitida a participa√ß√£o em cons√≥rcio...\"\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n              <Checkbox\r\n                id=\"participacao-cooperativas\"\r\n                checked={formData.participacaoCooperativas}\r\n                onCheckedChange={(checked) => handleInputChange('participacaoCooperativas', checked)}\r\n              />\r\n              <Label htmlFor=\"participacao-cooperativas\">Participa√ß√£o de cooperativas permitida?</Label>\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Checkbox\r\n                  id=\"subcontratacao\"\r\n                  checked={formData.subcontratacao}\r\n                  onCheckedChange={(checked) => handleInputChange('subcontratacao', checked)}\r\n                />\r\n                <Label htmlFor=\"subcontratacao\">Subcontrata√ß√£o permitida?</Label>\r\n              </div>\r\n\r\n              {formData.subcontratacao && (\r\n                <div className=\"space-y-2 ml-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <Label>Detalhes da subcontrata√ß√£o</Label>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('detalhesSubcontratacao')}>\r\n                      <Sparkles size={14} className=\"mr-1\" />\r\n                      IA\r\n                    </Button>\r\n                  </div>\r\n                  <Textarea\r\n                    value={formData.detalhesSubcontratacao}\r\n                    onChange={(e) => handleInputChange('detalhesSubcontratacao', e.target.value)}\r\n                    rows={2}\r\n                    placeholder=\"Detalhe as condi√ß√µes para subcontrata√ß√£o...\"\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      case 4: // Etapa 5: Vistoria T√©cnica e Amostras\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"space-y-2\">\r\n              <Label>Vistoria T√©cnica</Label>\r\n              <Select value={formData.vistoriaTecnica} onValueChange={(value) => handleInputChange('vistoriaTecnica', value)}>\r\n                <SelectTrigger>\r\n                  <SelectValue placeholder=\"Selecione o tipo de vistoria\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"nao\">N√£o</SelectItem>\r\n                  <SelectItem value=\"facultativa\">Facultativa</SelectItem>\r\n                  <SelectItem value=\"obrigatoria\">Obrigat√≥ria</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            {formData.vistoriaTecnica !== 'nao' && (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <Label>Justificativa para vistoria</Label>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('justificativaVistoria')}>\r\n                      <Sparkles size={14} className=\"mr-1\" />\r\n                      IA\r\n                    </Button>\r\n                  </div>\r\n                  <Textarea\r\n                    value={formData.justificativaVistoria}\r\n                    onChange={(e) => handleInputChange('justificativaVistoria', e.target.value)}\r\n                    rows={3}\r\n                    placeholder=\"Justifique a necessidade da vistoria t√©cnica...\"\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Unidade Respons√°vel</Label>\r\n                    <Input\r\n                      value={formData.unidadeResponsavelVistoria}\r\n                      onChange={(e) => handleInputChange('unidadeResponsavelVistoria', e.target.value)}\r\n                      placeholder=\"Nome da unidade respons√°vel\"\r\n                    />\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Telefone/E-mail para Agendamento</Label>\r\n                    <Input\r\n                      value={formData.contatoVistoria}\r\n                      onChange={(e) => handleInputChange('contatoVistoria', e.target.value)}\r\n                      placeholder=\"Contato para agendamento\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Checkbox\r\n                  id=\"amostras-exigidas\"\r\n                  checked={formData.amostrasExigidas}\r\n                  onCheckedChange={(checked) => handleInputChange('amostrasExigidas', checked)}\r\n                />\r\n                <Label htmlFor=\"amostras-exigidas\">Amostras ou provas de conceito ser√£o exigidas?</Label>\r\n              </div>\r\n\r\n              {formData.amostrasExigidas && (\r\n                <div className=\"space-y-4 ml-6\">\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Prazo para apresenta√ß√£o</Label>\r\n                      <Input\r\n                        value={formData.prazoAmostras}\r\n                        onChange={(e) => handleInputChange('prazoAmostras', e.target.value)}\r\n                        placeholder=\"Ex: 5 dias √∫teis\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Unidade t√©cnica respons√°vel</Label>\r\n                      <Input\r\n                        value={formData.unidadeTecnicaAmostras}\r\n                        onChange={(e) => handleInputChange('unidadeTecnicaAmostras', e.target.value)}\r\n                        placeholder=\"Unidade t√©cnica\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"space-y-2\">\r\n                    <Label>Local de entrega/demonstra√ß√£o</Label>\r\n                    <Input\r\n                      value={formData.localAmostras}\r\n                      onChange={(e) => handleInputChange('localAmostras', e.target.value)}\r\n                      placeholder=\"Endere√ßo para entrega das amostras\"\r\n                    />\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      case 5: // Etapa 6: Documenta√ß√£o Exigida\r\n        return (\r\n          <TooltipProvider>\r\n            <div className=\"space-y-6\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div className=\"space-y-4\">\r\n                  <h4 className=\"font-medium text-lg\">üìÅ Habilita√ß√£o Jur√≠dica</h4>\r\n                  <div className=\"space-y-3\">\r\n                    {documentationData.habilitacaoJuridica.map((doc) => (\r\n                      <div key={doc.id} className=\"flex items-start space-x-2\">\r\n                        <Checkbox\r\n                          id={doc.id}\r\n                          checked={formData.habilitacaoJuridica.includes(doc.id)}\r\n                          onCheckedChange={(checked) => handleArrayChange('habilitacaoJuridica', doc.id, checked as boolean)}\r\n                          className=\"mt-1\"\r\n                        />\r\n                        <div className=\"flex items-center space-x-1 flex-1\">\r\n                          <Label htmlFor={doc.id} className=\"text-sm leading-normal cursor-pointer\">{doc.label}</Label>\r\n                          <Tooltip>\r\n                            <TooltipTrigger asChild>\r\n                              <Info size={14} className=\"text-gray-400 hover:text-gray-600 cursor-help flex-shrink-0\" />\r\n                            </TooltipTrigger>\r\n                            <TooltipContent className=\"max-w-xs\">\r\n                              <p className=\"text-sm\">{doc.tooltip}</p>\r\n                            </TooltipContent>\r\n                          </Tooltip>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <h4 className=\"font-medium text-lg\">üìÅ Habilita√ß√£o Fiscal, Social e Trabalhista</h4>\r\n                  <div className=\"space-y-3\">\r\n                    {documentationData.habilitacaoFiscal.map((doc) => (\r\n                      <div key={doc.id} className=\"flex items-start space-x-2\">\r\n                        <Checkbox\r\n                          id={doc.id}\r\n                          checked={formData.habilitacaoFiscal.includes(doc.id)}\r\n                          onCheckedChange={(checked) => handleArrayChange('habilitacaoFiscal', doc.id, checked as boolean)}\r\n                          className=\"mt-1\"\r\n                        />\r\n                        <div className=\"flex items-center space-x-1 flex-1\">\r\n                          <Label htmlFor={doc.id} className=\"text-sm leading-normal cursor-pointer\">{doc.label}</Label>\r\n                          <Tooltip>\r\n                            <TooltipTrigger asChild>\r\n                              <Info size={14} className=\"text-gray-400 hover:text-gray-600 cursor-help flex-shrink-0\" />\r\n                            </TooltipTrigger>\r\n                            <TooltipContent className=\"max-w-xs\">\r\n                              <p className=\"text-sm\">{doc.tooltip}</p>\r\n                            </TooltipContent>\r\n                          </Tooltip>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <h4 className=\"font-medium text-lg\">üìÅ Qualifica√ß√£o Econ√¥mico-Financeira</h4>\r\n                  <div className=\"space-y-3\">\r\n                    {documentationData.qualificacaoEconomica.map((doc) => (\r\n                      <div key={doc.id} className=\"flex items-start space-x-2\">\r\n                        <Checkbox\r\n                          id={doc.id}\r\n                          checked={formData.qualificacaoEconomica.includes(doc.id)}\r\n                          onCheckedChange={(checked) => handleArrayChange('qualificacaoEconomica', doc.id, checked as boolean)}\r\n                          className=\"mt-1\"\r\n                        />\r\n                        <div className=\"flex items-center space-x-1 flex-1\">\r\n                          <Label htmlFor={doc.id} className=\"text-sm leading-normal cursor-pointer\">{doc.label}</Label>\r\n                          <Tooltip>\r\n                            <TooltipTrigger asChild>\r\n                              <Info size={14} className=\"text-gray-400 hover:text-gray-600 cursor-help flex-shrink-0\" />\r\n                            </TooltipTrigger>\r\n                            <TooltipContent className=\"max-w-xs\">\r\n                              <p className=\"text-sm\">{doc.tooltip}</p>\r\n                            </TooltipContent>\r\n                          </Tooltip>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"space-y-4\">\r\n                  <h4 className=\"font-medium text-lg\">üìÅ Qualifica√ß√£o T√©cnica</h4>\r\n                  <div className=\"space-y-3\">\r\n                    {documentationData.qualificacaoTecnica.map((doc) => (\r\n                      <div key={doc.id} className=\"flex items-start space-x-2\">\r\n                        <Checkbox\r\n                          id={doc.id}\r\n                          checked={formData.qualificacaoTecnica.includes(doc.id)}\r\n                          onCheckedChange={(checked) => handleArrayChange('qualificacaoTecnica', doc.id, checked as boolean)}\r\n                          className=\"mt-1\"\r\n                        />\r\n                        <div className=\"flex items-center space-x-1 flex-1\">\r\n                          <Label htmlFor={doc.id} className=\"text-sm leading-normal cursor-pointer\">{doc.label}</Label>\r\n                          <Tooltip>\r\n                            <TooltipTrigger asChild>\r\n                              <Info size={14} className=\"text-gray-400 hover:text-gray-600 cursor-help flex-shrink-0\" />\r\n                            </TooltipTrigger>\r\n                            <TooltipContent className=\"max-w-xs\">\r\n                              <p className=\"text-sm\">{doc.tooltip}</p>\r\n                            </TooltipContent>\r\n                          </Tooltip>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-2 pt-4 border-t\">\r\n                <div className=\"flex items-center space-x-1\">\r\n                  <Label className=\"font-medium\">‚ûï Adicionar documentos complementares</Label>\r\n                  <Tooltip>\r\n                    <TooltipTrigger asChild>\r\n                      <Info size={14} className=\"text-gray-400 hover:text-gray-600 cursor-help\" />\r\n                    </TooltipTrigger>\r\n                    <TooltipContent className=\"max-w-xs\">\r\n                      <p className=\"text-sm\">Caso a Administra√ß√£o queira exigir documentos adicionais.</p>\r\n                    </TooltipContent>\r\n                  </Tooltip>\r\n                </div>\r\n                <Textarea\r\n                  value={formData.documentosAdicionais}\r\n                  onChange={(e) => handleInputChange('documentosAdicionais', e.target.value)}\r\n                  rows={3}\r\n                  placeholder=\"Descreva documentos adicionais espec√≠ficos para este certame...\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </TooltipProvider>\r\n        );\r\n\r\n      case 6: // Etapa 7: Condi√ß√µes de Execu√ß√£o\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label>Prazo de Entrega</Label>\r\n                <Select value={formData.prazoEntrega} onValueChange={(value) => handleInputChange('prazoEntrega', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Selecione o prazo\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"5\">5 dias</SelectItem>\r\n                    <SelectItem value=\"10\">10 dias</SelectItem>\r\n                    <SelectItem value=\"15\">15 dias</SelectItem>\r\n                    <SelectItem value=\"20\">20 dias</SelectItem>\r\n                    <SelectItem value=\"30\">30 dias</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label>Ordem de Fornecimento</Label>\r\n                <Select value={formData.ordemFornecimento} onValueChange={(value) => handleInputChange('ordemFornecimento', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Selecione a ordem\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"unica\">Remessa √∫nica</SelectItem>\r\n                    <SelectItem value=\"demanda\">Conforme demanda</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Label>Endere√ßo de Entrega</Label>\r\n                <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('enderecoEntrega')}>\r\n                  <Sparkles size={14} className=\"mr-1\" />\r\n                  IA\r\n                </Button>\r\n              </div>\r\n              <Textarea\r\n                value={formData.enderecoEntrega}\r\n                onChange={(e) => handleInputChange('enderecoEntrega', e.target.value)}\r\n                rows={3}\r\n                placeholder=\"Endere√ßo completo de entrega...\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Checkbox\r\n                  id=\"garantia-produto\"\r\n                  checked={formData.garantiaProduto}\r\n                  onCheckedChange={(checked) => handleInputChange('garantiaProduto', checked)}\r\n                />\r\n                <Label htmlFor=\"garantia-produto\">Garantia de produto/servi√ßo exigida?</Label>\r\n              </div>\r\n\r\n              {formData.garantiaProduto && (\r\n                <div className=\"space-y-2 ml-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <Label>Condi√ß√µes de Garantia</Label>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('condicoesGarantia')}>\r\n                      <Sparkles size={14} className=\"mr-1\" />\r\n                      IA\r\n                    </Button>\r\n                  </div>\r\n                  <Textarea\r\n                    value={formData.condicoesGarantia}\r\n                    onChange={(e) => handleInputChange('condicoesGarantia', e.target.value)}\r\n                    rows={3}\r\n                    placeholder=\"Descreva as condi√ß√µes de garantia...\"\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Checkbox\r\n                  id=\"fornecimento-continuo\"\r\n                  checked={formData.fornecimentoContinuo}\r\n                  onCheckedChange={(checked) => handleInputChange('fornecimentoContinuo', checked)}\r\n                />\r\n                <Label htmlFor=\"fornecimento-continuo\">Fornecimento cont√≠nuo?</Label>\r\n              </div>\r\n\r\n              {formData.fornecimentoContinuo && (\r\n                <div className=\"space-y-2 ml-6\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <Label>Justificativa para fornecimento cont√≠nuo</Label>\r\n                    <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('justificativaFornecimento')}>\r\n                      <Sparkles size={14} className=\"mr-1\" />\r\n                      IA\r\n                    </Button>\r\n                  </div>\r\n                  <Textarea\r\n                    value={formData.justificativaFornecimento}\r\n                    onChange={(e) => handleInputChange('justificativaFornecimento', e.target.value)}\r\n                    rows={3}\r\n                    placeholder=\"Justifique a necessidade de fornecimento cont√≠nuo...\"\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      case 7: // Etapa 8: Vig√™ncia e Pagamento\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label>Prazo de Vig√™ncia do Contrato</Label>\r\n                <Select value={formData.prazoVigencia} onValueChange={(value) => handleInputChange('prazoVigencia', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Selecione o prazo\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"1\">1 m√™s</SelectItem>\r\n                    <SelectItem value=\"3\">3 meses</SelectItem>\r\n                    <SelectItem value=\"6\">6 meses</SelectItem>\r\n                    <SelectItem value=\"12\">12 meses</SelectItem>\r\n                    <SelectItem value=\"24\">24 meses</SelectItem>\r\n                    <SelectItem value=\"36\">36 meses</SelectItem>\r\n                    <SelectItem value=\"48\">48 meses</SelectItem>\r\n                    <SelectItem value=\"60\">60 meses</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label>Prazo de Substitui√ß√£o de Itens</Label>\r\n                <Select value={formData.prazoSubstituicao} onValueChange={(value) => handleInputChange('prazoSubstituicao', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Selecione o prazo\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"5\">5 dias</SelectItem>\r\n                    <SelectItem value=\"10\">10 dias</SelectItem>\r\n                    <SelectItem value=\"15\">15 dias</SelectItem>\r\n                    <SelectItem value=\"20\">20 dias</SelectItem>\r\n                    <SelectItem value=\"30\">30 dias</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label>Prazo para Recebimento Definitivo</Label>\r\n                <Select value={formData.prazoRecebimento} onValueChange={(value) => handleInputChange('prazoRecebimento', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Selecione\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"5\">5 dias</SelectItem>\r\n                    <SelectItem value=\"10\">10 dias</SelectItem>\r\n                    <SelectItem value=\"15\">15 dias</SelectItem>\r\n                    <SelectItem value=\"20\">20 dias</SelectItem>\r\n                    <SelectItem value=\"30\">30 dias</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label>Prazo de Liquida√ß√£o</Label>\r\n                <Select value={formData.prazoLiquidacao} onValueChange={(value) => handleInputChange('prazoLiquidacao', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Selecione\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"5\">5 dias</SelectItem>\r\n                    <SelectItem value=\"10\">10 dias</SelectItem>\r\n                    <SelectItem value=\"15\">15 dias</SelectItem>\r\n                    <SelectItem value=\"20\">20 dias</SelectItem>\r\n                    <SelectItem value=\"30\">30 dias</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div className=\"space-y-2\">\r\n                <Label>Prazo de Pagamento ap√≥s emiss√£o de NFe</Label>\r\n                <Select value={formData.prazoPagamento} onValueChange={(value) => handleInputChange('prazoPagamento', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Selecione\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"antecipado\">Pagamento antecipado</SelectItem>\r\n                    <SelectItem value=\"5\">5 dias</SelectItem>\r\n                    <SelectItem value=\"10\">10 dias</SelectItem>\r\n                    <SelectItem value=\"15\">15 dias</SelectItem>\r\n                    <SelectItem value=\"20\">20 dias</SelectItem>\r\n                    <SelectItem value=\"30\">30 dias</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      case 8: // Etapa 9: Gest√£o e Fiscaliza√ß√£o\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h4 className=\"font-medium\">Informa√ß√µes dos Gestores</h4>\r\n                <Button size=\"sm\" variant=\"outline\" onClick={() => addGestorFiscal('gestores')}>\r\n                  <Plus size={16} className=\"mr-1\" />\r\n                  Adicionar Gestor\r\n                </Button>\r\n              </div>\r\n              {formData.gestores.map((gestor, index) => (\r\n                <div key={index} className=\"border rounded-lg p-4 space-y-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <h5 className=\"font-medium\">Gestor {index + 1}</h5>\r\n                    {formData.gestores.length > 1 && (\r\n                      <Button size=\"sm\" variant=\"outline\" onClick={() => removeGestorFiscal('gestores', index)}>\r\n                        <Minus size={16} />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Nome</Label>\r\n                      <Input\r\n                        value={gestor.nome}\r\n                        onChange={(e) => handleGestorFiscalChange('gestores', index, 'nome', e.target.value)}\r\n                        placeholder=\"Nome completo\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Cargo</Label>\r\n                      <Input\r\n                        value={gestor.cargo}\r\n                        onChange={(e) => handleGestorFiscalChange('gestores', index, 'cargo', e.target.value)}\r\n                        placeholder=\"Cargo do gestor\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Matr√≠cula</Label>\r\n                      <Input\r\n                        value={gestor.matricula}\r\n                        onChange={(e) => handleGestorFiscalChange('gestores', index, 'matricula', e.target.value)}\r\n                        placeholder=\"Matr√≠cula\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <h4 className=\"font-medium\">Informa√ß√µes dos Fiscais</h4>\r\n                <Button size=\"sm\" variant=\"outline\" onClick={() => addGestorFiscal('fiscais')}>\r\n                  <Plus size={16} className=\"mr-1\" />\r\n                  Adicionar Fiscal\r\n                </Button>\r\n              </div>\r\n              {formData.fiscais.map((fiscal, index) => (\r\n                <div key={index} className=\"border rounded-lg p-4 space-y-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <h5 className=\"font-medium\">Fiscal {index + 1}</h5>\r\n                    {formData.fiscais.length > 1 && (\r\n                      <Button size=\"sm\" variant=\"outline\" onClick={() => removeGestorFiscal('fiscais', index)}>\r\n                        <Minus size={16} />\r\n                      </Button>\r\n                    )}\r\n                  </div>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Nome</Label>\r\n                      <Input\r\n                        value={fiscal.nome}\r\n                        onChange={(e) => handleGestorFiscalChange('fiscais', index, 'nome', e.target.value)}\r\n                        placeholder=\"Nome completo\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Cargo</Label>\r\n                      <Input\r\n                        value={fiscal.cargo}\r\n                        onChange={(e) => handleGestorFiscalChange('fiscais', index, 'cargo', e.target.value)}\r\n                        placeholder=\"Cargo do fiscal\"\r\n                      />\r\n                    </div>\r\n                    <div className=\"space-y-2\">\r\n                      <Label>Matr√≠cula</Label>\r\n                      <Input\r\n                        value={fiscal.matricula}\r\n                        onChange={(e) => handleGestorFiscalChange('fiscais', index, 'matricula', e.target.value)}\r\n                        placeholder=\"Matr√≠cula\"\r\n                      />\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      case 9: // Etapa 10: Itens e Valor Estimado\r\n        return (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <h4 className=\"font-medium\">Itens Selecionados</h4>\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Button\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => handleInputChange('mostrarValores', !formData.mostrarValores)}\r\n                >\r\n                  {formData.mostrarValores ? <EyeOff size={16} /> : <Eye size={16} />}\r\n                  {formData.mostrarValores ? 'Ocultar' : 'Mostrar'} Valores\r\n                </Button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"border rounded-lg overflow-hidden\">\r\n              <div className=\"bg-gray-50 p-3 border-b\">\r\n                <div className=\"grid grid-cols-12 gap-4 text-sm font-medium\">\r\n                  <div className=\"col-span-4\">Item</div>\r\n                  <div className=\"col-span-2\">Unidade</div>\r\n                  <div className=\"col-span-2\">Quantidade</div>\r\n                  {formData.mostrarValores && <div className=\"col-span-2\">Valor Unit.</div>}\r\n                  {formData.mostrarValores && <div className=\"col-span-2\">Valor Total</div>}\r\n                </div>\r\n              </div>\r\n              <div className=\"max-h-96 overflow-y-auto\">\r\n                {getSelectedItems().map((item, index) => (\r\n                  <div key={index} className=\"p-3 border-b grid grid-cols-12 gap-4 text-sm\">\r\n                    <div className=\"col-span-4\">{item.nome}</div>\r\n                    <div className=\"col-span-2\">{item.unidade}</div>\r\n                    <div className=\"col-span-2\">{item.quantidade}</div>\r\n                    {formData.mostrarValores && (\r\n                      <div className=\"col-span-2\">{item.valorUnitario || 'R$ 0,00'}</div>\r\n                    )}\r\n                    {formData.mostrarValores && (\r\n                      <div className=\"col-span-2\">{item.valorEstimado}</div>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-blue-50 p-4 rounded-lg\">\r\n              <h5 className=\"font-medium mb-3\">Resumo Final</h5>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm\">\r\n                <div>\r\n                  <span className=\"font-medium\">Quantidade de itens:</span>\r\n                  <br />\r\n                  {getSelectedItems().length} itens\r\n                </div>\r\n                <div>\r\n                  <span className=\"font-medium\">Secretarias envolvidas:</span>\r\n                  <br />\r\n                  {getSecretariaInfo()}\r\n                </div>\r\n                {formData.mostrarValores && (\r\n                  <div>\r\n                    <span className=\"font-medium\">Valor total estimado:</span>\r\n                    <br />\r\n                    <span className=\"text-green-600 font-semibold\">{calculateTotalValue()}</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <Label>Observa√ß√µes Adicionais</Label>\r\n                <Button size=\"sm\" variant=\"outline\" onClick={() => generateWithAI('observacoes')}>\r\n                  <Sparkles size={14} className=\"mr-1\" />\r\n                  IA\r\n                </Button>\r\n              </div>\r\n              <Textarea\r\n                value={formData.observacoes}\r\n                onChange={(e) => handleInputChange('observacoes', e.target.value)}\r\n                rows={4}\r\n                placeholder=\"Observa√ß√µes adicionais sobre a execu√ß√£o do contrato...\"\r\n              />\r\n            </div>\r\n          </div>\r\n        );\r\n\r\n      default:\r\n        return <div>Etapa n√£o encontrada</div>;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n      <div className=\"bg-white rounded-lg shadow-lg w-full max-w-6xl h-[95vh] flex flex-col\">\r\n        {/* Header */}\r\n        <div className=\"p-6 border-b flex-shrink-0\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h2 className=\"text-xl font-bold text-gray-900\">\r\n                Criar Termo de Refer√™ncia - {formData.numero}\r\n              </h2>\r\n              <p className=\"text-gray-600\">\r\n                Etapa {currentStep + 1} de {steps.length}: {steps[currentStep].title}\r\n              </p>\r\n            </div>\r\n            <Button variant=\"ghost\" onClick={onClose}>\r\n              <X size={20} />\r\n            </Button>\r\n          </div>\r\n\r\n          {/* Progress Steps */}\r\n          <div className=\"mt-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              {steps.map((step, index) => (\r\n                <div key={index} className=\"flex flex-col items-center\">\r\n                  <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${index <= currentStep ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-600'\r\n                    }`}>\r\n                    {index < currentStep ? <CheckCircle size={16} /> : index + 1}\r\n                  </div>\r\n                  <div className={`mt-1 text-xs text-center ${index <= currentStep ? 'text-blue-600' : 'text-gray-500'\r\n                    }`}>\r\n                    {step.title}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n            <div className=\"mt-2 bg-gray-200 rounded-full h-2\">\r\n              <div\r\n                className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\r\n                style={{ width: `${((currentStep + 1) / steps.length) * 100}%` }}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 p-6 overflow-auto\">\r\n          {renderStepContent()}\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"p-6 border-t bg-gray-50 flex-shrink-0\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <Button\r\n                variant=\"outline\"\r\n                onClick={prevStep}\r\n                disabled={currentStep === 0}\r\n              >\r\n                <ArrowLeft size={16} className=\"mr-2\" />\r\n                Anterior\r\n              </Button>\r\n\r\n              {currentStep < steps.length - 1 ? (\r\n                <Button onClick={nextStep}>\r\n                  Pr√≥ximo\r\n                  <ArrowRight size={16} className=\"ml-2\" />\r\n                </Button>\r\n              ) : (\r\n                <div className=\"flex items-center space-x-2\">\r\n                  <Button variant=\"outline\" onClick={handleSave}>\r\n                    <Save size={16} className=\"mr-2\" />\r\n                    Salvar Rascunho\r\n                  </Button>\r\n                  <Button onClick={handleFinalize}>\r\n                    <CheckCircle size={16} className=\"mr-2\" />\r\n                    Finalizar TR\r\n                  </Button>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <Button variant=\"outline\" onClick={onClose}>\r\n              Fechar\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TRCreationWizard;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\TermoReferencia\\TRSelectionModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[833,836],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[833,836],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1159,1162],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1159,1162],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1207,1210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1207,1210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2267,2270],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2267,2270],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2520,2523],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2520,2523],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":78,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":78,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2686,2689],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2686,2689],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport {\r\n  Calendar,\r\n  FileText,\r\n  Package,\r\n  Building,\r\n  DollarSign,\r\n  ArrowRight,\r\n  Loader2\r\n} from 'lucide-react';\r\nimport DFDsLivresModal from './DFDsLivresModal';\r\nimport ItensEspecificosModal from './ItensEspecificosModal';\r\nimport { etpService } from '@/services/etpService';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\n\r\ninterface TRSelectionModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onOriginSelected: (origin: 'cronograma' | 'dfds-livres' | 'itens-especificos', data: any) => void;\r\n}\r\n\r\nconst TRSelectionModal = ({ open, onClose, onOriginSelected }: TRSelectionModalProps) => {\r\n  const { user } = useAuth();\r\n  const [selectedOrigin, setSelectedOrigin] = useState<'cronograma' | 'dfds-livres' | 'itens-especificos' | null>(null);\r\n  const [selectedLicitacao, setSelectedLicitacao] = useState<any>(null);\r\n  const [etps, setEtps] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [showDFDsLivresModal, setShowDFDsLivresModal] = useState(false);\r\n  const [showItensEspecificosModal, setShowItensEspecificosModal] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (open && selectedOrigin === 'cronograma') {\r\n      loadETPs();\r\n    }\r\n  }, [open, selectedOrigin, user?.prefeituraId]);\r\n\r\n  const loadETPs = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const data = await etpService.fetchConcluidos(user?.prefeituraId || undefined);\r\n      setEtps(data || []);\r\n    } catch (error) {\r\n      console.error('Erro ao carregar ETPs:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleOriginSelection = (origin: 'cronograma' | 'dfds-livres' | 'itens-especificos') => {\r\n    setSelectedOrigin(origin);\r\n\r\n    if (origin === 'dfds-livres') {\r\n      setShowDFDsLivresModal(true);\r\n    } else if (origin === 'itens-especificos') {\r\n      setShowItensEspecificosModal(true);\r\n    }\r\n  };\r\n\r\n  const handleLicitacaoSelection = (licitacao: any) => {\r\n    setSelectedLicitacao(licitacao);\r\n  };\r\n\r\n  const handleConfirmCronograma = () => {\r\n    if (selectedLicitacao) {\r\n      onOriginSelected('cronograma', selectedLicitacao);\r\n    }\r\n  };\r\n\r\n  const handleDFDsLivresSelected = (selectedDFDs: any[]) => {\r\n    setShowDFDsLivresModal(false);\r\n    onOriginSelected('dfds-livres', selectedDFDs);\r\n  };\r\n\r\n  const handleItensEspecificosSelected = (selectedItems: any[]) => {\r\n    setShowItensEspecificosModal(false);\r\n    onOriginSelected('itens-especificos', selectedItems);\r\n  };\r\n\r\n  const getPriorityColor = (prioridade: string | null) => {\r\n    switch (prioridade) {\r\n      case 'Alta':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'M√©dia':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'Baixa':\r\n        return 'bg-green-100 text-green-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Dialog open={open} onOpenChange={onClose}>\r\n        <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"text-xl font-bold text-gray-900 border-b pb-4\">\r\n              Escolha a origem do Termo de Refer√™ncia\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <div className=\"space-y-6 pt-4\">\r\n            {!selectedOrigin && (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                <Card\r\n                  className=\"cursor-pointer group hover:bg-orange-50 border-2 border-transparent hover:border-orange-200 transition-all duration-300 shadow-sm hover:shadow-md\"\r\n                  onClick={() => handleOriginSelection('cronograma')}\r\n                >\r\n                  <CardHeader className=\"pb-3\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"p-2 bg-orange-100 rounded-lg text-orange-600 group-hover:bg-orange-600 group-hover:text-white transition-colors\">\r\n                        <Calendar size={20} />\r\n                      </div>\r\n                      <CardTitle className=\"text-lg\">Cronograma de Licita√ß√µes</CardTitle>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <p className=\"text-gray-600 text-sm mb-4 leading-relaxed\">\r\n                      Crie um TR baseado em um ETP conclu√≠do sugerido pelo cronograma de licita√ß√µes.\r\n                    </p>\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"flex items-center text-xs text-gray-500\">\r\n                        <div className=\"w-1.5 h-1.5 bg-orange-400 rounded-full mr-2\" />\r\n                        ETPs Consolidados\r\n                      </div>\r\n                      <div className=\"flex items-center text-xs text-gray-500\">\r\n                        <div className=\"w-1.5 h-1.5 bg-orange-400 rounded-full mr-2\" />\r\n                        Dados de Planejamento\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                <Card\r\n                  className=\"cursor-pointer group hover:bg-blue-50 border-2 border-transparent hover:border-blue-200 transition-all duration-300 shadow-sm hover:shadow-md\"\r\n                  onClick={() => handleOriginSelection('dfds-livres')}\r\n                >\r\n                  <CardHeader className=\"pb-3\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"p-2 bg-blue-100 rounded-lg text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-colors\">\r\n                        <FileText size={20} />\r\n                      </div>\r\n                      <CardTitle className=\"text-lg\">DFDs Livres</CardTitle>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <p className=\"text-gray-600 text-sm mb-4 leading-relaxed\">\r\n                      Selecione um ou mais DFDs aprovados para compor seu Termo de Refer√™ncia.\r\n                    </p>\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"flex items-center text-xs text-gray-500\">\r\n                        <div className=\"w-1.5 h-1.5 bg-blue-400 rounded-full mr-2\" />\r\n                        M√∫ltiplas Secretarias\r\n                      </div>\r\n                      <div className=\"flex items-center text-xs text-gray-500\">\r\n                        <div className=\"w-1.5 h-1.5 bg-blue-400 rounded-full mr-2\" />\r\n                        Agrupamento Flex√≠vel\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                <Card\r\n                  className=\"cursor-pointer group hover:bg-green-50 border-2 border-transparent hover:border-green-200 transition-all duration-300 shadow-sm hover:shadow-md\"\r\n                  onClick={() => handleOriginSelection('itens-especificos')}\r\n                >\r\n                  <CardHeader className=\"pb-3\">\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <div className=\"p-2 bg-green-100 rounded-lg text-green-600 group-hover:bg-green-600 group-hover:text-white transition-colors\">\r\n                        <Package size={20} />\r\n                      </div>\r\n                      <CardTitle className=\"text-lg\">Itens Espec√≠ficos</CardTitle>\r\n                    </div>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <p className=\"text-gray-600 text-sm mb-4 leading-relaxed\">\r\n                      Escolha itens granulares de diferentes DFDs para um TR customizado.\r\n                    </p>\r\n                    <div className=\"space-y-2\">\r\n                      <div className=\"flex items-center text-xs text-gray-500\">\r\n                        <div className=\"w-1.5 h-1.5 bg-green-400 rounded-full mr-2\" />\r\n                        Controle de Lotes\r\n                      </div>\r\n                      <div className=\"flex items-center text-xs text-gray-500\">\r\n                        <div className=\"w-1.5 h-1.5 bg-green-400 rounded-full mr-2\" />\r\n                        Sele√ß√£o de Itens Avulsos\r\n                      </div>\r\n                    </div>\r\n                  </CardContent>\r\n                </Card>\r\n              </div>\r\n            )}\r\n\r\n            {selectedOrigin === 'cronograma' && (\r\n              <div className=\"space-y-4\">\r\n                <div className=\"flex items-center justify-between bg-orange-50 p-4 rounded-lg border border-orange-100\">\r\n                  <div className=\"flex items-center\">\r\n                    <Calendar className=\"text-orange-600 mr-2\" size={20} />\r\n                    <h3 className=\"text-lg font-bold text-orange-900\">Selecione um ETP do Cronograma</h3>\r\n                  </div>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    onClick={() => setSelectedOrigin(null)}\r\n                    className=\"text-orange-700 hover:bg-orange-100\"\r\n                  >\r\n                    Trocar Origem\r\n                  </Button>\r\n                </div>\r\n\r\n                {loading ? (\r\n                  <div className=\"py-20 text-center\">\r\n                    <Loader2 className=\"w-10 h-10 animate-spin mx-auto text-orange-500 mb-2\" />\r\n                    <p className=\"text-gray-500\">Buscando ETPs consolidados...</p>\r\n                  </div>\r\n                ) : etps.length === 0 ? (\r\n                  <div className=\"py-20 text-center bg-white border rounded-lg border-dashed\">\r\n                    <Calendar size={48} className=\"mx-auto text-gray-200 mb-4\" />\r\n                    <p className=\"text-gray-500\">Nenhum ETP conclu√≠do dispon√≠vel no cronograma.</p>\r\n                  </div>\r\n                ) : (\r\n                  <div className=\"grid grid-cols-1 gap-3 max-h-[400px] overflow-y-auto pr-2\">\r\n                    {etps.map((etp) => (\r\n                      <Card\r\n                        key={etp.id}\r\n                        className={`cursor-pointer transition-all border-l-4 ${selectedLicitacao?.id === etp.id\r\n                            ? 'border-orange-500 bg-orange-50 shadow-sm'\r\n                            : 'border-transparent hover:border-orange-200 hover:bg-gray-50'\r\n                          }`}\r\n                        onClick={() => handleLicitacaoSelection(etp)}\r\n                      >\r\n                        <CardContent className=\"p-4\">\r\n                          <div className=\"flex items-center justify-between\">\r\n                            <div className=\"flex-1\">\r\n                              <div className=\"flex items-center space-x-3 mb-2\">\r\n                                <h4 className=\"font-bold text-gray-900\">{etp.numeroETP}</h4>\r\n                                <Badge variant=\"outline\" className=\"text-[10px] bg-white\">CONCLU√çDO</Badge>\r\n                              </div>\r\n                              <p className=\"text-sm text-gray-600 font-medium mb-3 line-clamp-1\">{etp.titulo}</p>\r\n\r\n                              <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4 text-xs text-gray-500\">\r\n                                <div className=\"flex items-center space-x-2\">\r\n                                  <Building size={14} className=\"text-gray-400\" />\r\n                                  <span>{etp.secretaria}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center space-x-2\">\r\n                                  <Calendar size={14} className=\"text-gray-400\" />\r\n                                  <span>{new Date(etp.dataCriacao).toLocaleDateString('pt-BR')}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center space-x-2 font-bold text-green-700\">\r\n                                  <DollarSign size={14} />\r\n                                  <span>{etp.valorTotal}</span>\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                            {selectedLicitacao?.id === etp.id && (\r\n                              <div className=\"ml-4 flex items-center justify-center w-8 h-8 bg-orange-500 rounded-full text-white shadow-sm\">\r\n                                <ArrowRight size={18} />\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </CardContent>\r\n                      </Card>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n\r\n                {!loading && etps.length > 0 && selectedLicitacao && (\r\n                  <div className=\"flex justify-end pt-4 border-t\">\r\n                    <Button\r\n                      onClick={handleConfirmCronograma}\r\n                      className=\"bg-orange-500 hover:bg-orange-600 shadow-md min-w-[200px]\"\r\n                    >\r\n                      Continuar com este ETP\r\n                      <ArrowRight size={16} className=\"ml-2\" />\r\n                    </Button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      {/* Modais dos novos fluxos */}\r\n      <DFDsLivresModal\r\n        open={showDFDsLivresModal}\r\n        onClose={() => {\r\n          setShowDFDsLivresModal(false);\r\n          setSelectedOrigin(null);\r\n        }}\r\n        onContinuar={handleDFDsLivresSelected}\r\n      />\r\n\r\n      <ItensEspecificosModal\r\n        open={showItensEspecificosModal}\r\n        onClose={() => {\r\n          setShowItensEspecificosModal(false);\r\n          setSelectedOrigin(null);\r\n        }}\r\n        onContinuar={handleItensEspecificosSelected}\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport default TRSelectionModal;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\admin\\AdminLayout.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":116,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5561,5564],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5561,5564],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Outlet } from 'react-router-dom';\r\nimport AdminSidebar from './AdminSidebar';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { Menu, ChevronLeft, Bell, Search, User } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport {\r\n    DropdownMenu,\r\n    DropdownMenuContent,\r\n    DropdownMenuItem,\r\n    DropdownMenuLabel,\r\n    DropdownMenuSeparator,\r\n    DropdownMenuTrigger,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\r\n\r\nconst AdminLayout = () => {\r\n    const { user, logout } = useAuth();\r\n    const [sidebarOpen, setSidebarOpen] = useState(false);\r\n    const [sidebarCollapsed, setSidebarCollapsed] = useState(() => {\r\n        const saved = localStorage.getItem('adminSidebarCollapsed');\r\n        return saved ? JSON.parse(saved) : false;\r\n    });\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('adminSidebarCollapsed', JSON.stringify(sidebarCollapsed));\r\n    }, [sidebarCollapsed]);\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-slate-50 flex\">\r\n            <AdminSidebar\r\n                isOpen={sidebarOpen}\r\n                onToggle={() => setSidebarOpen(!sidebarOpen)}\r\n                isCollapsed={sidebarCollapsed}\r\n            />\r\n\r\n            <div className={cn(\r\n                \"flex-1 flex flex-col transition-all duration-300\",\r\n                sidebarCollapsed ? 'lg:ml-16' : 'lg:ml-64'\r\n            )}>\r\n                {/* Header Admin */}\r\n                <header className=\"h-16 bg-white border-b border-slate-200 sticky top-0 z-30 px-4 flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"icon\"\r\n                            onClick={() => setSidebarOpen(!sidebarOpen)}\r\n                            className=\"lg:hidden\"\r\n                        >\r\n                            <Menu size={20} />\r\n                        </Button>\r\n\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"icon\"\r\n                            onClick={() => setSidebarCollapsed(!sidebarCollapsed)}\r\n                            className=\"hidden lg:flex\"\r\n                        >\r\n                            {sidebarCollapsed ? <Menu size={20} /> : <ChevronLeft size={20} />}\r\n                        </Button>\r\n\r\n                        <div className=\"hidden md:flex relative w-80\">\r\n                            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400\" size={18} />\r\n                            <Input\r\n                                placeholder=\"Pesquisar no sistema...\"\r\n                                className=\"pl-10 bg-slate-100 border-transparent focus:bg-white transition-all\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <Button variant=\"ghost\" size=\"icon\" className=\"relative\">\r\n                            <Bell size={20} className=\"text-slate-600\" />\r\n                            <span className=\"absolute top-2 right-2 w-2 h-2 bg-red-500 rounded-full border-2 border-white\"></span>\r\n                        </Button>\r\n\r\n                        <DropdownMenu>\r\n                            <DropdownMenuTrigger asChild>\r\n                                <Button variant=\"ghost\" className=\"pl-2 pr-4 py-2 flex items-center gap-3 hover:bg-slate-100\">\r\n                                    <Avatar className=\"h-8 w-8 border border-slate-200\">\r\n                                        <AvatarFallback className=\"bg-primary text-white text-xs\">\r\n                                            {user?.nome?.charAt(0) || 'A'}\r\n                                        </AvatarFallback>\r\n                                    </Avatar>\r\n                                    <div className=\"hidden sm:block text-left\">\r\n                                        <p className=\"text-sm font-semibold text-slate-900 leading-none\">{user?.nome}</p>\r\n                                        <p className=\"text-xs text-slate-500 mt-1 uppercase tracking-wider font-medium\">\r\n                                            {user?.role?.replace('_', ' ')}\r\n                                        </p>\r\n                                    </div>\r\n                                </Button>\r\n                            </DropdownMenuTrigger>\r\n                            <DropdownMenuContent align=\"end\" className=\"w-56\">\r\n                                <DropdownMenuLabel>Minha Conta</DropdownMenuLabel>\r\n                                <DropdownMenuSeparator />\r\n                                <DropdownMenuItem onClick={logout} className=\"text-red-600 focus:text-red-700\">\r\n                                    Sair do Sistema\r\n                                </DropdownMenuItem>\r\n                            </DropdownMenuContent>\r\n                        </DropdownMenu>\r\n                    </div>\r\n                </header>\r\n\r\n                {/* Main Content Area */}\r\n                <main className=\"flex-1 p-6 lg:p-10 max-w-[1400px] mx-auto w-full\">\r\n                    <Outlet />\r\n                </main>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\n// Utility function copied for completeness or imported\r\nfunction cn(...inputs: any[]) {\r\n    return inputs.filter(Boolean).join(' ');\r\n}\r\n\r\nexport default AdminLayout;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\ui\\command.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":24,"column":11,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":24,"endColumn":29,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[724,775],"text":"type CommandDialogProps = DialogProps"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\r\nimport { Command as CommandPrimitive } from \"cmdk\"\r\nimport { Search } from \"lucide-react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\r\n\r\nconst Command = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive\r\n    ref={ref}\r\n    className={cn(\r\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\nCommand.displayName = CommandPrimitive.displayName\r\n\r\ninterface CommandDialogProps extends DialogProps {}\r\n\r\nconst CommandDialog = ({ children, ...props }: CommandDialogProps) => {\r\n  return (\r\n    <Dialog {...props}>\r\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\r\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\r\n          {children}\r\n        </Command>\r\n      </DialogContent>\r\n    </Dialog>\r\n  )\r\n}\r\n\r\nconst CommandInput = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Input>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\r\n>(({ className, ...props }, ref) => (\r\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\r\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\r\n    <CommandPrimitive.Input\r\n      ref={ref}\r\n      className={cn(\r\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  </div>\r\n))\r\n\r\nCommandInput.displayName = CommandPrimitive.Input.displayName\r\n\r\nconst CommandList = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.List>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.List\r\n    ref={ref}\r\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\r\n    {...props}\r\n  />\r\n))\r\n\r\nCommandList.displayName = CommandPrimitive.List.displayName\r\n\r\nconst CommandEmpty = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Empty>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\r\n>((props, ref) => (\r\n  <CommandPrimitive.Empty\r\n    ref={ref}\r\n    className=\"py-6 text-center text-sm\"\r\n    {...props}\r\n  />\r\n))\r\n\r\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\r\n\r\nconst CommandGroup = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Group>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.Group\r\n    ref={ref}\r\n    className={cn(\r\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\n\r\nCommandGroup.displayName = CommandPrimitive.Group.displayName\r\n\r\nconst CommandSeparator = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Separator>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.Separator\r\n    ref={ref}\r\n    className={cn(\"-mx-1 h-px bg-border\", className)}\r\n    {...props}\r\n  />\r\n))\r\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\r\n\r\nconst CommandItem = React.forwardRef<\r\n  React.ElementRef<typeof CommandPrimitive.Item>,\r\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\r\n>(({ className, ...props }, ref) => (\r\n  <CommandPrimitive.Item\r\n    ref={ref}\r\n    className={cn(\r\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n))\r\n\r\nCommandItem.displayName = CommandPrimitive.Item.displayName\r\n\r\nconst CommandShortcut = ({\r\n  className,\r\n  ...props\r\n}: React.HTMLAttributes<HTMLSpanElement>) => {\r\n  return (\r\n    <span\r\n      className={cn(\r\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\nCommandShortcut.displayName = \"CommandShortcut\"\r\n\r\nexport {\r\n  Command,\r\n  CommandDialog,\r\n  CommandInput,\r\n  CommandList,\r\n  CommandEmpty,\r\n  CommandGroup,\r\n  CommandItem,\r\n  CommandShortcut,\r\n  CommandSeparator,\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\components\\ui\\textarea.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[77,164],"text":"type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface TextareaProps\r\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\r\n  ({ className, ...props }, ref) => {\r\n    return (\r\n      <textarea\r\n        className={cn(\r\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n          className\r\n        )}\r\n        ref={ref}\r\n        {...props}\r\n      />\r\n    )\r\n  }\r\n)\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\contexts\\AuthContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2117,2120],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2117,2120],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useCallback, useEffect } from 'react';\r\nimport { User, AuthState, ModulePermissions, UserRole, defaultPermissionsByRole, Prefeitura } from '@/types/auth';\r\nimport { DbUser, DbPrefeitura, DbSecretaria } from '@/types/database';\r\nimport { mockUsers, mockCredentials, mockPrefeituras } from '@/data/mockAuthData';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { handleSupabaseError } from '@/utils/supabaseErrorHandler';\r\n\r\ninterface AuthContextType extends AuthState {\r\n  login: (email: string, password: string) => Promise<boolean>;\r\n  logout: () => void;\r\n  hasPermission: (module: keyof ModulePermissions) => boolean;\r\n  isSuperAdmin: () => boolean;\r\n  isAdmin: () => boolean;\r\n  isOperator: () => boolean;\r\n  startImpersonation: (userId: string) => void;\r\n  stopImpersonation: () => void;\r\n  getCurrentUser: () => User | null;\r\n  getUsersForPrefeitura: (prefeituraId: string) => User[];\r\n  createUser: (userData: Omit<User, 'id' | 'createdAt'>, password?: string) => Promise<User | null>;\r\n  updateUser: (userId: string, updates: Partial<User>) => Promise<boolean>;\r\n  deleteUser: (userId: string) => Promise<void>;\r\n  getPrefeituraById: (prefeituraId: string) => Prefeitura | undefined;\r\n  getAllPrefeituras: () => Prefeitura[];\r\n  getSecretariasForPrefeitura: (prefeituraId: string) => DbSecretaria[];\r\n  addSecretaria: (data: Omit<DbSecretaria, 'id' | 'created_at'>) => void;\r\n  switchToUser: (email: string) => void;\r\n  createPrefeitura: (prefeituraData: Pick<DbPrefeitura, 'nome' | 'cnpj' | 'uf' | 'municipio'>) => Promise<boolean>;\r\n  deletePrefeitura: (prefeituraId: string) => Promise<boolean>;\r\n  getAllUsers: () => User[];\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport const AuthProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const { toast } = useToast();\r\n  const [users, setUsers] = useState<User[]>([]);\r\n  const [prefeituras, setPrefeituras] = useState<Prefeitura[]>([]);\r\n  const [secretarias, setSecretarias] = useState<any[]>([]);\r\n  const [authState, setAuthState] = useState<AuthState>({\r\n    user: null,\r\n    isAuthenticated: false,\r\n    isLoading: true,\r\n    impersonating: null,\r\n  });\r\n\r\n  const fetchUsers = useCallback(async () => {\r\n    try {\r\n      const { data, error } = await supabase.from('usuarios_acesso').select('*');\r\n      if (error) throw error;\r\n\r\n      // Cast data to DbUser[] to ensure type safety based on our schema definition\r\n      const dbUsers = data as unknown as DbUser[];\r\n\r\n      const mappedUsers: User[] = (dbUsers || []).map(dbUser => ({\r\n        id: dbUser.id.toString(),\r\n        email: dbUser.email,\r\n        nome: dbUser.nome || dbUser.email.split('@')[0],\r\n        role: dbUser.tipo_perfil || 'operator',\r\n        prefeituraId: dbUser.prefeitura_id || null,\r\n        secretariaId: dbUser.secretaria_id || null,\r\n        permissions: (dbUser.modulos_acesso && Object.keys(dbUser.modulos_acesso).length > 0)\r\n          ? dbUser.modulos_acesso\r\n          : defaultPermissionsByRole[dbUser.tipo_perfil || 'operator'],\r\n        createdAt: dbUser.created_at || new Date().toISOString(),\r\n        status: dbUser.status || 'ativo',\r\n      }));\r\n      setUsers(mappedUsers);\r\n    } catch (error) {\r\n      handleSupabaseError(error, 'Fetching Users');\r\n    }\r\n  }, []);\r\n\r\n  const fetchPrefeituras = useCallback(async () => {\r\n    try {\r\n      const { data, error } = await supabase.from('prefeituras').select('*');\r\n      if (error) throw error;\r\n\r\n      const dbPrefeituras = data as unknown as DbPrefeitura[];\r\n\r\n      const mappedPrefeituras: Prefeitura[] = (dbPrefeituras || []).map((dbPref) => ({\r\n        id: dbPref.id,\r\n        nome: dbPref.nome,\r\n        cnpj: dbPref.cnpj,\r\n        uf: dbPref.uf,\r\n        municipio: dbPref.municipio,\r\n        logoUrl: dbPref.logo_url || undefined,\r\n        gestorPrincipal: dbPref.gestor_principal || undefined,\r\n        email: dbPref.email || undefined,\r\n        telefone: dbPref.telefone || undefined,\r\n        cargo: dbPref.cargo || undefined,\r\n        dataCadastro: dbPref.created_at || new Date().toISOString(),\r\n        status: dbPref.status || 'inativa',\r\n      }));\r\n      setPrefeituras(mappedPrefeituras);\r\n    } catch (error) {\r\n      handleSupabaseError(error, 'Fetching Prefeituras');\r\n    }\r\n  }, []);\r\n\r\n  const fetchSecretarias = useCallback(async () => {\r\n    try {\r\n      const { data, error } = await supabase.from('secretarias').select('*');\r\n      if (error) throw error;\r\n      setSecretarias(data || []);\r\n    } catch (error) {\r\n      console.error('Error fetching secretarias:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Initial load\r\n  useEffect(() => {\r\n    fetchUsers();\r\n    fetchPrefeituras();\r\n    fetchSecretarias();\r\n  }, [fetchUsers, fetchPrefeituras, fetchSecretarias]);\r\n\r\n\r\n  // Load saved auth state from localStorage\r\n  useEffect(() => {\r\n    const savedUser = localStorage.getItem('preparagov_user');\r\n    const savedImpersonating = localStorage.getItem('preparagov_impersonating');\r\n\r\n    if (savedUser) {\r\n      const user = JSON.parse(savedUser);\r\n      setAuthState({\r\n        user,\r\n        isAuthenticated: true,\r\n        isLoading: false,\r\n        impersonating: savedImpersonating ? JSON.parse(savedImpersonating) : null,\r\n      });\r\n    } else {\r\n      setAuthState(prev => ({ ...prev, isLoading: false }));\r\n    }\r\n  }, []);\r\n\r\n  const login = useCallback(async (email: string, password: string): Promise<boolean> => {\r\n    try {\r\n      let dbUser = null;\r\n      let isGlobalAdmin = false;\r\n\r\n      // 1. Tentar login via Supabase na tabela usuarios_acesso\r\n      const { data: accessUser, error: dbError, status } = await supabase\r\n        .from('usuarios_acesso')\r\n        .select('*')\r\n        .eq('email', email)\r\n        .eq('senha', password)\r\n        .maybeSingle();\r\n\r\n      if (accessUser) {\r\n        dbUser = accessUser;\r\n      } else if (!dbError) {\r\n        // 2. Tentar login via Supabase na tabela admin_users (Global Admins)\r\n        const { data: adminUser, error: adminError } = await supabase\r\n          .from('admin_users')\r\n          .select('*')\r\n          .eq('email', email)\r\n          .eq('password', password)\r\n          .maybeSingle();\r\n\r\n        if (adminUser) {\r\n          dbUser = adminUser;\r\n          isGlobalAdmin = true;\r\n        }\r\n      }\r\n\r\n      console.log('Login attempt:', { email, hasData: !!dbUser, error: dbError });\r\n\r\n      if (dbError && !isGlobalAdmin) {\r\n        console.error('Database connection error:', dbError);\r\n        toast({\r\n          title: \"Erro de Conex√£o\",\r\n          description: status === 401\r\n            ? \"Falha na autentica√ß√£o com o banco de dados. Verifique as chaves no arquivo .env.\"\r\n            : \"N√£o foi poss√≠vel conectar ao banco de dados.\",\r\n          variant: \"destructive\"\r\n        });\r\n        return false;\r\n      }\r\n\r\n      if (dbUser) {\r\n        const role = isGlobalAdmin ? 'super_admin' : (dbUser.tipo_perfil as UserRole) || 'operator';\r\n\r\n        const user: User = {\r\n          id: dbUser.id.toString(),\r\n          email: dbUser.email,\r\n          nome: dbUser.nome || dbUser.email.split('@')[0],\r\n          role: role,\r\n          prefeituraId: dbUser.prefeitura_id || null,\r\n          secretariaId: dbUser.secretaria_id || null,\r\n          permissions: isGlobalAdmin\r\n            ? defaultPermissionsByRole.super_admin\r\n            : (dbUser.modulos_acesso && Object.keys(dbUser.modulos_acesso).length > 0)\r\n              ? dbUser.modulos_acesso\r\n              : defaultPermissionsByRole[role],\r\n          createdAt: dbUser.created_at || new Date().toISOString(),\r\n          status: dbUser.status || 'ativo',\r\n        };\r\n\r\n        setAuthState({\r\n          user,\r\n          isAuthenticated: true,\r\n          isLoading: false,\r\n          impersonating: null,\r\n        });\r\n\r\n        localStorage.setItem('preparagov_user', JSON.stringify(user));\r\n        localStorage.removeItem('preparagov_impersonating');\r\n\r\n        toast({\r\n          title: \"Login realizado\",\r\n          description: `Bem-vindo, ${user.nome}!`,\r\n        });\r\n\r\n        return true;\r\n      }\r\n    } catch (err) {\r\n      handleSupabaseError(err, 'Login');\r\n    }\r\n\r\n    // 2. Fallback para Mock (Desenvolvimento)\r\n    const credential = mockCredentials.find(c => c.email === email && c.password === password);\r\n\r\n    if (!credential) {\r\n      toast({\r\n        title: \"Erro de autentica√ß√£o\",\r\n        description: \"Email ou senha incorretos\",\r\n        variant: \"destructive\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    const user = users.find(u => u.id === credential.userId);\r\n\r\n    if (!user || user.status === 'inativo') {\r\n      toast({\r\n        title: \"Acesso negado\",\r\n        description: \"Usu√°rio inativo ou n√£o encontrado\",\r\n        variant: \"destructive\",\r\n      });\r\n      return false;\r\n    }\r\n\r\n    setAuthState({\r\n      user,\r\n      isAuthenticated: true,\r\n      isLoading: false,\r\n      impersonating: null,\r\n    });\r\n\r\n    localStorage.setItem('preparagov_user', JSON.stringify(user));\r\n    localStorage.removeItem('preparagov_impersonating');\r\n\r\n    toast({\r\n      title: \"Login realizado\",\r\n      description: `Bem-vindo, ${user.nome}!`,\r\n    });\r\n\r\n    return true;\r\n  }, [users, toast]);\r\n\r\n  const logout = useCallback(() => {\r\n    setAuthState({\r\n      user: null,\r\n      isAuthenticated: false,\r\n      isLoading: false,\r\n      impersonating: null,\r\n    });\r\n    localStorage.removeItem('preparagov_user');\r\n    localStorage.removeItem('preparagov_impersonating');\r\n\r\n    toast({\r\n      title: \"Logout realizado\",\r\n      description: \"Voc√™ foi desconectado com sucesso\",\r\n    });\r\n  }, [toast]);\r\n\r\n  const getCurrentUser = useCallback((): User | null => {\r\n    // Se est√° impersonando, retorna o usu√°rio impersonado\r\n    return authState.impersonating || authState.user;\r\n  }, [authState]);\r\n\r\n  const hasPermission = useCallback((module: keyof ModulePermissions): boolean => {\r\n    const currentUser = getCurrentUser();\r\n    if (!currentUser) return false;\r\n\r\n    // Super Admin sempre tem acesso (exceto se estiver impersonando)\r\n    if (authState.user?.role === 'super_admin' && !authState.impersonating) {\r\n      return true;\r\n    }\r\n\r\n    return currentUser.permissions[module] === true;\r\n  }, [authState, getCurrentUser]);\r\n\r\n  const isSuperAdmin = useCallback((): boolean => {\r\n    return authState.user?.role === 'super_admin' && !authState.impersonating;\r\n  }, [authState]);\r\n\r\n  const isAdmin = useCallback((): boolean => {\r\n    const currentUser = getCurrentUser();\r\n    return currentUser?.role === 'admin' || currentUser?.role === 'super_admin';\r\n  }, [getCurrentUser]);\r\n\r\n  const isOperator = useCallback((): boolean => {\r\n    const currentUser = getCurrentUser();\r\n    return currentUser?.role === 'operator';\r\n  }, [getCurrentUser]);\r\n\r\n  const startImpersonation = useCallback((userId: string) => {\r\n    if (authState.user?.role !== 'super_admin') {\r\n      toast({\r\n        title: \"Acesso negado\",\r\n        description: \"Apenas Super Admin pode impersonar usu√°rios\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    const targetUser = users.find(u => u.id === userId);\r\n    if (!targetUser) {\r\n      toast({\r\n        title: \"Erro\",\r\n        description: \"Usu√°rio n√£o encontrado\",\r\n        variant: \"destructive\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    setAuthState(prev => ({\r\n      ...prev,\r\n      impersonating: targetUser,\r\n    }));\r\n\r\n    localStorage.setItem('preparagov_impersonating', JSON.stringify(targetUser));\r\n\r\n    toast({\r\n      title: \"Modo Impersona√ß√£o\",\r\n      description: `Voc√™ est√° visualizando como ${targetUser.nome}`,\r\n    });\r\n  }, [authState.user, users, toast]);\r\n\r\n  const stopImpersonation = useCallback(() => {\r\n    setAuthState(prev => ({\r\n      ...prev,\r\n      impersonating: null,\r\n    }));\r\n\r\n    localStorage.removeItem('preparagov_impersonating');\r\n\r\n    toast({\r\n      title: \"Impersona√ß√£o encerrada\",\r\n      description: \"Voc√™ voltou ao seu perfil de Super Admin\",\r\n    });\r\n  }, [toast]);\r\n\r\n  const getUsersForPrefeitura = useCallback((prefeituraId: string): User[] => {\r\n    return users.filter(u => u.prefeituraId === prefeituraId);\r\n  }, [users]);\r\n\r\n  const createUser = useCallback(async (userData: Omit<User, 'id' | 'createdAt'>, password?: string): Promise<User | null> => {\r\n    try {\r\n      const newUserPayload: Partial<DbUser> = {\r\n        email: userData.email,\r\n        senha: password || '123456', // Padr√£o se n√£o informado\r\n        nome: userData.nome,\r\n        tipo_perfil: userData.role,\r\n        prefeitura_id: userData.prefeituraId || null,\r\n        secretaria_id: userData.secretariaId || null,\r\n        modulos_acesso: userData.permissions,\r\n        status: userData.status\r\n      };\r\n\r\n      const { data, error } = await supabase\r\n        .from('usuarios_acesso')\r\n        .insert([newUserPayload])\r\n        .select()\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Cast response to DbUser\r\n      const dbUser = data as unknown as DbUser;\r\n\r\n      const newUser: User = {\r\n        id: dbUser.id,\r\n        email: dbUser.email,\r\n        nome: dbUser.nome,\r\n        role: dbUser.tipo_perfil || 'operator',\r\n        prefeituraId: dbUser.prefeitura_id,\r\n        secretariaId: dbUser.secretaria_id,\r\n        permissions: dbUser.modulos_acesso || defaultPermissionsByRole[dbUser.tipo_perfil || 'operator'],\r\n        createdAt: dbUser.created_at,\r\n        status: dbUser.status || 'ativo',\r\n      };\r\n\r\n      setUsers(prev => [...prev, newUser]);\r\n      toast({ title: \"Usu√°rio criado\", description: `${newUser.nome} foi cadastrado com sucesso` });\r\n      return newUser;\r\n    } catch (error) {\r\n      handleSupabaseError(error, 'Creating User');\r\n      return null;\r\n    }\r\n  }, [toast]);\r\n\r\n\r\n  const updateUser = useCallback(async (userId: string, updates: Partial<User>) => {\r\n    try {\r\n      const dbUpdates: Partial<DbUser> = {};\r\n      if (updates.nome) dbUpdates.nome = updates.nome;\r\n      if (updates.email) dbUpdates.email = updates.email;\r\n      if (updates.role) dbUpdates.tipo_perfil = updates.role;\r\n      if (updates.prefeituraId !== undefined) dbUpdates.prefeitura_id = updates.prefeituraId || null;\r\n      if (updates.secretariaId !== undefined) dbUpdates.secretaria_id = updates.secretariaId || null;\r\n      if (updates.permissions) dbUpdates.modulos_acesso = updates.permissions;\r\n      if (updates.status) dbUpdates.status = updates.status;\r\n\r\n      const { error } = await supabase\r\n        .from('usuarios_acesso')\r\n        .update(dbUpdates)\r\n        .eq('id', userId);\r\n\r\n      if (error) throw error;\r\n\r\n      setUsers(prev => prev.map(u => u.id === userId ? { ...u, ...updates } : u));\r\n      toast({ title: \"Usu√°rio atualizado\", description: \"As altera√ß√µes foram salvas com sucesso\" });\r\n      return true;\r\n    } catch (error) {\r\n      handleSupabaseError(error, 'Updating User');\r\n      return false;\r\n    }\r\n  }, [toast]);\r\n\r\n\r\n  const deleteUser = useCallback(async (userId: string) => {\r\n    try {\r\n      const { error } = await supabase.from('usuarios_acesso').delete().eq('id', userId);\r\n\r\n      if (error) {\r\n        // Erro de viola√ß√£o de chave estrangeira (violates foreign key constraint)\r\n        if (error.code === '23503') {\r\n          toast({\r\n            title: \"Usu√°rio em Uso\",\r\n            description: \"Este usu√°rio possui documentos (DFDs, PCAs, etc) vinculados a ele e n√£o pode ser exclu√≠do permanentemente. Recomendamos apenas desativar o usu√°rio.\",\r\n            variant: \"destructive\"\r\n          });\r\n          return;\r\n        }\r\n        throw error;\r\n      }\r\n\r\n      setUsers(prev => prev.filter(u => u.id !== userId));\r\n      toast({ title: \"Usu√°rio removido\", description: \"O usu√°rio foi exclu√≠do com sucesso\" });\r\n    } catch (error) {\r\n      handleSupabaseError(error, 'Deleting User');\r\n    }\r\n  }, [toast]);\r\n\r\n\r\n  const getPrefeituraById = useCallback((prefeituraId: string) => {\r\n    return prefeituras.find(p => p.id === prefeituraId);\r\n  }, [prefeituras]);\r\n\r\n  const getAllPrefeituras = useCallback(() => {\r\n    return prefeituras;\r\n  }, [prefeituras]);\r\n\r\n\r\n  const getSecretariasForPrefeitura = useCallback((prefeituraId: string) => {\r\n    return secretarias.filter(s => s.prefeitura_id === prefeituraId);\r\n  }, [secretarias]);\r\n\r\n  const getAllUsers = useCallback(() => {\r\n    return users;\r\n  }, [users]);\r\n\r\n\r\n  const addSecretaria = useCallback((data: Omit<DbSecretaria, 'id' | 'created_at'>) => {\r\n    setSecretarias(prev => [...prev, { ...data, id: `sec-${Date.now()}` }]);\r\n  }, []);\r\n\r\n  const createPrefeitura = useCallback(async (prefeituraData: Pick<DbPrefeitura, 'nome' | 'cnpj' | 'uf' | 'municipio'>): Promise<boolean> => {\r\n    try {\r\n      // 1. Verificar se a prefeitura j√° existe pelo CNPJ\r\n      const { data: existingPref, error: searchError } = await supabase\r\n        .from('prefeituras')\r\n        .select('id')\r\n        .eq('cnpj', prefeituraData.cnpj)\r\n        .maybeSingle();\r\n\r\n      if (searchError) throw searchError;\r\n\r\n      if (existingPref) {\r\n        toast({\r\n          title: \"Prefeitura j√° cadastrada\",\r\n          description: \"J√° existe uma prefeitura com este CNPJ no sistema.\",\r\n          variant: \"destructive\"\r\n        });\r\n        return false;\r\n      }\r\n\r\n      // 2. Inserir a prefeitura\r\n      const newPrefeitura: Partial<DbPrefeitura> = {\r\n        nome: prefeituraData.nome,\r\n        cnpj: prefeituraData.cnpj,\r\n        uf: prefeituraData.uf,\r\n        municipio: prefeituraData.municipio,\r\n        status: 'ativa'\r\n      };\r\n\r\n      const { error: prefError } = await supabase\r\n        .from('prefeituras')\r\n        .insert([newPrefeitura]);\r\n\r\n      if (prefError) throw prefError;\r\n\r\n      // Atualizar estado local\r\n      fetchPrefeituras();\r\n\r\n      toast({\r\n        title: \"Prefeitura criada\",\r\n        description: \"Os dados da prefeitura foram salvos com sucesso.\"\r\n      });\r\n      return true;\r\n    } catch (error) {\r\n      handleSupabaseError(error, 'Creating Prefeitura');\r\n      return false;\r\n    }\r\n  }, [fetchPrefeituras, toast]);\r\n\r\n  const deletePrefeitura = useCallback(async (prefeituraId: string): Promise<boolean> => {\r\n    try {\r\n      // Soft delete: Inativar usu√°rios vinculados\r\n      const { error: usersError } = await supabase\r\n        .from('usuarios_acesso')\r\n        .update({ status: 'inativo' })\r\n        .eq('prefeitura_id', prefeituraId);\r\n\r\n      if (usersError) throw usersError;\r\n\r\n      // Soft delete: Inativar a prefeitura\r\n      const { error } = await supabase\r\n        .from('prefeituras')\r\n        .update({ status: 'inativa' })\r\n        .eq('id', prefeituraId);\r\n\r\n      if (error) throw error;\r\n\r\n      fetchPrefeituras();\r\n      toast({\r\n        title: \"Prefeitura inativada\",\r\n        description: \"A prefeitura e seus usu√°rios foram inativados com sucesso.\"\r\n      });\r\n      return true;\r\n    } catch (error) {\r\n      handleSupabaseError(error, 'Inactivating Prefeitura');\r\n      return false;\r\n    }\r\n  }, [fetchPrefeituras, toast]);\r\n\r\n  const switchToUser = useCallback((email: string) => {\r\n    const user = users.find(u => u.email === email);\r\n    if (user) {\r\n      setAuthState({\r\n        user,\r\n        isAuthenticated: true,\r\n        isLoading: false,\r\n        impersonating: null,\r\n      });\r\n      localStorage.setItem('preparagov_user', JSON.stringify(user));\r\n      localStorage.removeItem('preparagov_impersonating');\r\n      toast({\r\n        title: \"Usu√°rio alterado\",\r\n        description: `Logado como ${user.nome} (${user.role})`,\r\n      });\r\n    }\r\n  }, [users, toast]);\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        ...authState,\r\n        login,\r\n        logout,\r\n        hasPermission,\r\n        isSuperAdmin,\r\n        isAdmin,\r\n        isOperator,\r\n        startImpersonation,\r\n        stopImpersonation,\r\n        getCurrentUser,\r\n        getUsersForPrefeitura,\r\n        createUser,\r\n        updateUser,\r\n        deleteUser,\r\n        getPrefeituraById,\r\n        getAllPrefeituras,\r\n        getSecretariasForPrefeitura,\r\n        addSecretaria,\r\n        switchToUser,\r\n        createPrefeitura,\r\n        deletePrefeitura,\r\n        getAllUsers,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\hooks\\useCronogramaData.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[642,645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[642,645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[714,717],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[714,717],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1047,1050],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1047,1050],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1091,1094],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1091,1094],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1207,1210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1207,1210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2209,2212],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2209,2212],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":86,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":86,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3043,3046],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3043,3046],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { useState, useEffect, useMemo } from 'react';\r\nimport { consolidateItemsByType, formatCurrency } from '../utils/pcaConsolidation';\r\nimport { supabase } from '@/lib/supabase';\r\n\r\n// Mock data - em produ√ß√£o viria do PCA\r\n\r\n\r\nconst calculateBusinessDays = (date: Date, days: number): Date => {\r\n  const result = new Date(date);\r\n  let addedDays = 0;\r\n\r\n  while (addedDays < days) {\r\n    result.setDate(result.getDate() - 1);\r\n    // Skip weekends (Saturday = 6, Sunday = 0)\r\n    if (result.getDay() !== 0 && result.getDay() !== 6) {\r\n      addedDays++;\r\n    }\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nexport const useCronogramaData = (filters: any) => {\r\n  const [consolidatedItems, setConsolidatedItems] = useState<any[]>([]);\r\n\r\n  useEffect(() => {\r\n    const fetchItems = async () => {\r\n      const { data: approved } = await supabase\r\n        .from('dfd')\r\n        .select(`\r\n          *,\r\n          dfd_items (*),\r\n          secretarias ( nome )\r\n        `)\r\n        .eq('status', 'Aprovado');\r\n\r\n      if (approved) {\r\n        const allItems: any[] = [];\r\n        approved.forEach((dfd: any) => {\r\n          if (dfd.dfd_items && Array.isArray(dfd.dfd_items)) {\r\n            dfd.dfd_items.forEach((item: any) => {\r\n              allItems.push({\r\n                id: item.id,\r\n                descricao: item.descricao_item,\r\n                quantidade: Number(item.quantidade),\r\n                valor: Number(item.valor_unitario),\r\n                unidadeMedida: item.unidade,\r\n                detalhamentoTecnico: item.codigo_item,\r\n                secretaria: dfd.secretarias?.nome || 'Secretaria n√£o informada',\r\n                prioridade: dfd.prioridade || 'M√©dia',\r\n                dataContratacao: dfd.data_prevista_contratacao,\r\n                dfdId: dfd.id,\r\n                tipoDFD: dfd.tipo_dfd || 'Outros'\r\n              });\r\n            });\r\n          }\r\n        });\r\n        setConsolidatedItems(allItems);\r\n      }\r\n    };\r\n\r\n    fetchItems();\r\n  }, [filters.ano]); // Re-fetch if year changes if implemented logic used year filter in query\r\n\r\n\r\n  const cronogramaData = useMemo(() => {\r\n    const consolidatedByType = consolidateItemsByType(consolidatedItems);\r\n    const cronogramaItems: any[] = [];\r\n\r\n    Object.entries(consolidatedByType).forEach(([tipoDFDPrincipal, items]) => {\r\n      items.forEach((item) => {\r\n        const dataContratacao = new Date(item.dataContratacaoOficial);\r\n        const dataSugeridaAbertura = calculateBusinessDays(dataContratacao, 30);\r\n\r\n        // Extrair informa√ß√µes das secretarias\r\n        const secretariasNomes = Object.keys(item.secretarias);\r\n        const secretariasSiglas = secretariasNomes.map(nome => {\r\n          const palavras = nome.split(' ').filter(p => p !== 'de' && p !== 'da' && p !== 'do');\r\n          if (palavras.length >= 2) {\r\n            return palavras.slice(1, 3).map(p => p.charAt(0).toUpperCase()).join('');\r\n          }\r\n          return nome.substring(0, 3).toUpperCase();\r\n        });\r\n\r\n        const dfdIds = Object.values(item.secretarias).map((sec: any) => sec.dfdId);\r\n\r\n        // Criar itens consolidados simples\r\n        const itensConsolidados = [{\r\n          descricao: item.descricao,\r\n          unidadeMedida: item.unidadeMedida,\r\n          quantidadeTotal: item.quantidadeTotal,\r\n          valorTotal: item.valorTotal,\r\n          detalhamentoTecnico: item.detalhamentoTecnico\r\n        }];\r\n\r\n        cronogramaItems.push({\r\n          id: item.id,\r\n          tipoDFD: tipoDFDPrincipal,\r\n          dataContratacao: item.dataContratacaoOficial,\r\n          dataSugeridaAbertura: dataSugeridaAbertura.toISOString().split('T')[0],\r\n          prioridade: item.prioridadeOficial,\r\n          secretariasNomes: secretariasNomes,\r\n          secretariasSiglas: secretariasSiglas,\r\n          dfdIds: dfdIds,\r\n          valorTotal: formatCurrency(item.valorTotal),\r\n          quantidadeTotal: item.quantidadeTotal,\r\n          unidadeMedida: item.unidadeMedida,\r\n          itensConsolidados: itensConsolidados,\r\n          // Armazenar dados das secretarias sem refer√™ncia circular\r\n          secretariasData: { ...item.secretarias }\r\n        });\r\n      });\r\n    });\r\n\r\n    return cronogramaItems.sort((a, b) =>\r\n      new Date(a.dataContratacao).getTime() - new Date(b.dataContratacao).getTime()\r\n    );\r\n  }, [consolidatedItems]);\r\n\r\n  const secretarias = useMemo(() => {\r\n    const allSecretarias = new Set<string>();\r\n    cronogramaData.forEach(item => {\r\n      item.secretariasNomes.forEach((sec: string) => allSecretarias.add(sec));\r\n    });\r\n    return Array.from(allSecretarias).sort();\r\n  }, [cronogramaData]);\r\n\r\n  const tiposDFD = useMemo(() => {\r\n    const allTipos = new Set<string>();\r\n    cronogramaData.forEach(item => allTipos.add(item.tipoDFD));\r\n    return Array.from(allTipos).sort();\r\n  }, [cronogramaData]);\r\n\r\n  const filteredData = useMemo(() => {\r\n    return cronogramaData.filter(item => {\r\n      const anoContratacao = new Date(item.dataContratacao).getFullYear().toString();\r\n\r\n      if (filters.ano && anoContratacao !== filters.ano) return false;\r\n      if (filters.secretaria && filters.secretaria !== 'all' && !item.secretariasNomes.includes(filters.secretaria)) return false;\r\n      if (filters.prioridade && filters.prioridade !== 'all' && item.prioridade !== filters.prioridade) return false;\r\n      if (filters.tipoDFD && filters.tipoDFD !== 'all' && item.tipoDFD !== filters.tipoDFD) return false;\r\n\r\n      return true;\r\n    });\r\n  }, [cronogramaData, filters]);\r\n\r\n  return {\r\n    cronogramaData,\r\n    secretarias,\r\n    tiposDFD,\r\n    filteredData\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\hooks\\useETPCreation.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2531,2534],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2531,2534],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":83,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2608,2611],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2608,2611],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2662,2665],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2662,2665],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2750,2753],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2750,2753],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":141,"column":60,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":63,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5176,5179],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5176,5179],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":167,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":167,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5717,5720],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5717,5720],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\..","line":256,"column":58,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":256,"endColumn":59,"suggestions":[{"messageId":"removeEscape","fix":{"range":[9251,9252],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[9251,9251],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\nimport { supabase } from '@/lib/supabase';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\n\r\ninterface SelectedDFD {\r\n  id: string; // Changed to string for UUID\r\n  objeto: string;\r\n  valorEstimado: string;\r\n  tipoDFD: string;\r\n  secretaria?: string;\r\n  prioridade: string;\r\n  dataContratacao?: string;\r\n  numeroDFD?: string;\r\n  status?: string;\r\n  usedInETP?: boolean;\r\n  secretario?: string;\r\n  responsavelDemanda?: string;\r\n}\r\n\r\ninterface ETPFormData {\r\n  selectedDFDs: SelectedDFD[];\r\n  descricaoDemanda: string;\r\n  requisitosContratacao: string;\r\n  alternativasExistem: boolean;\r\n  alternativasDescricao: string;\r\n  descricaoSolucao: string;\r\n  justificativaParcelamento: string;\r\n  resultadosPretendidos: string;\r\n  providenciasExistem: boolean;\r\n  providenciasDescricao: string;\r\n  contratacoesCorrelatas: boolean;\r\n  contratacoesDescricao: string;\r\n  impactosAmbientais: boolean;\r\n  impactosDescricao: string;\r\n  observacoesGerais: string;\r\n  conclusaoTecnica: string;\r\n}\r\n\r\nexport const useETPCreation = () => {\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [formData, setFormData] = useState<ETPFormData>({\r\n    selectedDFDs: [],\r\n    descricaoDemanda: '',\r\n    requisitosContratacao: '',\r\n    alternativasExistem: false,\r\n    alternativasDescricao: '',\r\n    descricaoSolucao: '',\r\n    justificativaParcelamento: '',\r\n    resultadosPretendidos: '',\r\n    providenciasExistem: false,\r\n    providenciasDescricao: '',\r\n    contratacoesCorrelatas: false,\r\n    contratacoesDescricao: '',\r\n    impactosAmbientais: false,\r\n    impactosDescricao: '',\r\n    observacoesGerais: '',\r\n    conclusaoTecnica: ''\r\n  });\r\n  const { toast } = useToast();\r\n  const { user } = useAuth();\r\n  const [availableDFDs, setAvailableDFDs] = useState<SelectedDFD[]>([]);\r\n\r\n  useEffect(() => {\r\n    const fetchDFDs = async () => {\r\n      try {\r\n        // 1. Fetch Approved DFDs\r\n        const { data, error } = await supabase\r\n          .from('dfd')\r\n          .select('*')\r\n          .eq('status', 'Aprovado');\r\n\r\n        if (error) throw error;\r\n\r\n        // 2. Fetch Users & Secretarias for details\r\n        const { data: usersData } = await supabase.from('usuarios_acesso').select('id, nome');\r\n        const { data: secretariasData } = await supabase.from('secretarias').select('id, nome');\r\n        const { data: usedData } = await supabase.from('etp_dfd').select('dfd_id');\r\n\r\n        const usedIds = new Set(usedData?.map((u: any) => u.dfd_id));\r\n\r\n        const formatted: SelectedDFD[] = data.map((d: any) => {\r\n          const user = usersData?.find((u: any) => u.id === d.created_by);\r\n          const secretaria = secretariasData?.find((s: any) => s.id === d.secretaria_id);\r\n\r\n          return {\r\n            id: d.id,\r\n            objeto: d.objeto,\r\n            valorEstimado: new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(d.valor_estimado_total || 0),\r\n            tipoDFD: d.tipo_dfd,\r\n            status: d.status,\r\n            prioridade: d.prioridade || 'M√©dia',\r\n            numeroDFD: d.numero_dfd || 'N/A',\r\n            dataContratacao: d.data_prevista_contratacao,\r\n            secretaria: secretaria?.nome || 'N√£o informada',\r\n            secretario: 'N√£o informado',\r\n            responsavelDemanda: user?.nome || 'N√£o informado',\r\n            usedInETP: usedIds.has(d.id)\r\n          };\r\n        });\r\n        setAvailableDFDs(formatted);\r\n      } catch (error) {\r\n        console.error(error);\r\n      }\r\n    };\r\n    fetchDFDs();\r\n  }, []);\r\n\r\n  const steps = [\r\n    { id: 0, title: 'Sele√ß√£o de DFDs', description: 'Selecione os DFDs vinculados' },\r\n    { id: 1, title: 'Descri√ß√£o da Demanda', description: 'Detalhe a demanda' },\r\n    { id: 2, title: 'Requisitos', description: 'Requisitos da contrata√ß√£o' },\r\n    { id: 3, title: 'Alternativas', description: 'Alternativas poss√≠veis' },\r\n    { id: 4, title: 'Solu√ß√£o', description: 'Descri√ß√£o da solu√ß√£o' },\r\n    { id: 5, title: 'Parcelamento', description: 'Justificativa do parcelamento' },\r\n    { id: 6, title: 'Resultados', description: 'Resultados pretendidos' },\r\n    { id: 7, title: 'Provid√™ncias', description: 'Provid√™ncias pr√©vias' },\r\n    { id: 8, title: 'Contrata√ß√µes', description: 'Contrata√ß√µes correlatas' },\r\n    { id: 9, title: 'Impactos', description: 'Impactos ambientais' },\r\n    { id: 10, title: 'Observa√ß√µes', description: 'Observa√ß√µes gerais' },\r\n    { id: 11, title: 'Conclus√£o', description: 'Conclus√£o t√©cnica' },\r\n    { id: 12, title: 'Resumo', description: 'Resumo final' }\r\n  ];\r\n\r\n  // Salvar progresso no localStorage\r\n  useEffect(() => {\r\n    localStorage.setItem('etp-creation-progress', JSON.stringify({ currentStep, formData }));\r\n  }, [currentStep, formData]);\r\n\r\n  // Carregar progresso do localStorage\r\n  useEffect(() => {\r\n    const saved = localStorage.getItem('etp-creation-progress');\r\n    if (saved) {\r\n      const { currentStep: savedStep, formData: savedData } = JSON.parse(saved);\r\n      setCurrentStep(savedStep);\r\n      setFormData(savedData);\r\n    }\r\n  }, []);\r\n\r\n  const updateFormData = (field: keyof ETPFormData, value: any) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const loadETP = async (etpId: string) => {\r\n    try {\r\n      // Fetch ETP details\r\n      const { data: etp, error } = await supabase\r\n        .from('etp')\r\n        .select(`\r\n          *,\r\n          etp_dfd (\r\n            dfd (\r\n              *\r\n            )\r\n          )\r\n        `)\r\n        .eq('id', etpId)\r\n        .single();\r\n\r\n      if (error) throw error;\r\n\r\n      // Map to form data\r\n      const selectedDFDs = etp.etp_dfd.map((item: any) => ({\r\n        id: item.dfd.id,\r\n        objeto: item.dfd.objeto,\r\n        valorEstimado: new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(item.dfd.valor_estimado_total || 0),\r\n        tipoDFD: item.dfd.tipo_dfd,\r\n        status: item.dfd.status,\r\n        prioridade: item.dfd.prioridade,\r\n        numeroDFD: item.dfd.numero_dfd,\r\n        dataContratacao: item.dfd.data_prevista_contratacao,\r\n        secretaria: 'Carregando...', // We can improve this if needed by fetching secretarias\r\n        responsavelDemanda: 'Carregando...'\r\n      }));\r\n\r\n      setFormData({\r\n        selectedDFDs,\r\n        descricaoDemanda: etp.descricao_demanda || '',\r\n        requisitosContratacao: etp.requisitos_contratacao || '',\r\n        alternativasExistem: etp.alternativas_existem || false,\r\n        alternativasDescricao: etp.alternativas_descricao || '',\r\n        descricaoSolucao: etp.descricao_solucao || '',\r\n        justificativaParcelamento: etp.justificativa_parcelamento || '',\r\n        resultadosPretendidos: etp.resultados_pretendidos || '',\r\n        providenciasExistem: etp.providencias_existem || false,\r\n        providenciasDescricao: etp.providencias_descricao || '',\r\n        contratacoesCorrelatas: etp.contratacoes_correlatas || false,\r\n        contratacoesDescricao: etp.contratacoes_descricao || '',\r\n        impactosAmbientais: etp.impactos_ambientais || false,\r\n        impactosDescricao: etp.impactos_descricao || '',\r\n        observacoesGerais: etp.observacoes_gerais || '',\r\n        conclusaoTecnica: etp.conclusao_tecnica || ''\r\n      });\r\n\r\n      setCurrentStep(0); // Start at beginning or determine step\r\n    } catch (error) {\r\n      console.error('Error loading ETP:', error);\r\n      toast({\r\n        title: \"Erro ao carregar\",\r\n        description: \"N√£o foi poss√≠vel carregar os dados do ETP.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const generateDemandDescription = (dfds: SelectedDFD[]) => {\r\n    if (dfds.length === 0) return '';\r\n\r\n    // Calculate total value\r\n    const totalValue = dfds.reduce((sum, dfd) => {\r\n      const value = parseFloat(dfd.valorEstimado.replace(/[R$.,\\s]/g, '').replace(',', '.')) || 0;\r\n      return sum + value;\r\n    }, 0);\r\n\r\n    const formatCurrency = (value: number) => {\r\n      return new Intl.NumberFormat('pt-BR', {\r\n        style: 'currency',\r\n        currency: 'BRL'\r\n      }).format(value);\r\n    };\r\n\r\n    const dfdDescriptions = dfds.map(dfd =>\r\n      `DFD n¬∫ ${dfd.numeroDFD} ‚Äì ${dfd.objeto} (${dfd.tipoDFD})\r\nSecret√°rio: ${dfd.secretario || 'N√£o informado'} | Respons√°vel pela Demanda: ${dfd.responsavelDemanda || 'N√£o informado'}\r\nValor estimado: ${dfd.valorEstimado}`\r\n    ).join('\\n\\n');\r\n\r\n    return `Demanda consolidada baseada nos seguintes DFDs aprovados:\r\n\r\n${dfdDescriptions}\r\n\r\n---\r\n\r\n**Valor Total da Demanda: ${formatCurrency(totalValue)}**`;\r\n  };\r\n\r\n  const selectDFDs = (dfds: SelectedDFD[]) => {\r\n    updateFormData('selectedDFDs', dfds);\r\n\r\n    // Auto-generate enhanced demand description\r\n    const description = generateDemandDescription(dfds);\r\n    updateFormData('descricaoDemanda', description);\r\n  };\r\n\r\n  const generateWithAI = async (field: keyof ETPFormData) => {\r\n    // Generate context from selected DFDs\r\n    const dfdContext = formData.selectedDFDs.map(d =>\r\n      `${d.objeto} (Valor: ${d.valorEstimado}, Prioridade: ${d.prioridade})`\r\n    ).join(', ');\r\n\r\n    const totalValue = formData.selectedDFDs.reduce((acc, d) => {\r\n      const val = parseFloat(d.valorEstimado.replace(/[R$\\.,]/g, '')) / 100;\r\n      return acc + (isNaN(val) ? 0 : val);\r\n    }, 0);\r\n\r\n    const isHighValue = totalValue > 50000; // Exemplo de regra de neg√≥cio simples\r\n\r\n    const aiContent: Record<string, () => string> = {\r\n      descricaoDemanda: () => `A administra√ß√£o p√∫blica necessita realizar a contrata√ß√£o de ${dfdContext} para garantir a continuidade e efici√™ncia dos servi√ßos prestados. Esta demanda surge da necessidade de adequa√ß√£o √†s atividades final√≠sticas do √≥rg√£o, visando otimizar recursos e atender ao interesse p√∫blico.`,\r\n\r\n      requisitosContratacao: () => `A contrata√ß√£o deve atender aos seguintes requisitos t√©cnicos e operacionais: conformidade com as normas t√©cnicas vigentes (ABNT/ISO), garantia m√≠nima de 12 meses, sustentabilidade ambiental com prefer√™ncia por materiais recicl√°veis ou de baixo impacto, e compatibilidade com a infraestrutura existente.`,\r\n\r\n      alternativasDescricao: () => `Foram analisadas as seguintes alternativas para atender √† demanda: \r\n1. Utiliza√ß√£o de recursos humanos e materiais pr√≥prios (invi√°vel por insufici√™ncia de estoque/quadro);\r\n2. Contrata√ß√£o de servi√ßo cont√≠nuo (n√£o aplic√°vel ao objeto);\r\n3. Aquisi√ß√£o parcelada conforme necessidade (mais vantajosa);\r\nA alternativa escolhida foi a aquisi√ß√£o por meio de licita√ß√£o p√∫blica, garantindo ampla concorr√™ncia e melhor pre√ßo.`,\r\n\r\n      descricaoSolucao: () => `A solu√ß√£o proposta consiste na aquisi√ß√£o de ${formData.selectedDFDs.length} item(ns) conforme especificado nos DFDs, com entrega parcelada. Esta solu√ß√£o foi definida considerando o hist√≥rico de consumo e a proje√ß√£o de demanda para o pr√≥ximo exerc√≠cio financeiro.`,\r\n\r\n      justificativaParcelamento: () => `O parcelamento da contrata√ß√£o se justifica t√©cnica e economicamente, pois permite a amplia√ß√£o da competividade e o melhor gerenciamento de estoques, evitando deteriora√ß√£o de materiais e custos desnecess√°rios de armazenamento, conforme preconiza a legisla√ß√£o vigente.`,\r\n\r\n      resultadosPretendidos: () => `Espera-se com esta contrata√ß√£o: \r\n- Atendimento integral da demanda das secretarias solicitantes;\r\n- Redu√ß√£o de custos operacionais atrav√©s de equipamentos/materiais mais eficientes;\r\n- Melhoria na qualidade do servi√ßo p√∫blico prestado ao cidad√£o;\r\n- Execu√ß√£o de 100% do or√ßamento planejado para esta rubrica.`,\r\n\r\n      providenciasDescricao: () => `Dever√£o ser tomadas as seguintes provid√™ncias pr√©vias:\r\n- Verifica√ß√£o de disponibilidade or√ßament√°ria;\r\n- Designa√ß√£o de equipe de fiscaliza√ß√£o do contrato;\r\n- Adequa√ß√£o do espa√ßo f√≠sico para recebimento dos itens;\r\n- Elabora√ß√£o de minuta de edital e termo de refer√™ncia.`,\r\n\r\n      contratacoesDescricao: () => `N√£o existem contrata√ß√µes correlatas ou interdependentes diretas que impe√ßam ou condicionem o in√≠cio desta execu√ß√£o. Entretanto, esta aquisi√ß√£o complementa os contratos de manuten√ß√£o preventiva j√° vigentes.`,\r\n\r\n      impactosDescricao: () => `Os impactos ambientais s√£o considerados baixos. A contratada dever√° responsabilizar-se pela log√≠stica reversa de embalagens e res√≠duos gerados durante o fornecimento, conforme Pol√≠tica Nacional de Res√≠duos S√≥lidos.`,\r\n\r\n      observacoesGerais: () => `A estimativa de pre√ßos foi baseada em pesquisa de mercado realizada no Banco de Pre√ßos e Painel de Pre√ßos do Governo Federal, garantindo a vantajosidade da contrata√ß√£o.`,\r\n\r\n      conclusaoTecnica: () => `Diante do exposto, conclui-se que a contrata√ß√£o √© vi√°vel tecnica e economicamente, necess√°ria para o funcionamento do √≥rg√£o e est√° em conformidade com o planejamento estrat√©gico da administra√ß√£o. Recomenda-se o prosseguimento do feito.`\r\n    };\r\n\r\n    const generator = aiContent[field];\r\n    if (generator) {\r\n      updateFormData(field, generator());\r\n\r\n      toast({\r\n        title: \"Conte√∫do Gerado por IA\",\r\n        description: \"Conte√∫do sugerido com base nos DFDs selecionados.\",\r\n      });\r\n    } else {\r\n      toast({\r\n        title: \"Erro na Gera√ß√£o\",\r\n        description: \"Campo n√£o suportado para gera√ß√£o autom√°tica.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const nextStep = () => {\r\n    if (currentStep < steps.length - 1) {\r\n      setCurrentStep(currentStep + 1);\r\n    }\r\n  };\r\n\r\n  const prevStep = () => {\r\n    if (currentStep > 0) {\r\n      setCurrentStep(currentStep - 1);\r\n    }\r\n  };\r\n\r\n  const canProceed = () => {\r\n    switch (currentStep) {\r\n      case 0:\r\n        return formData.selectedDFDs.length > 0;\r\n      case 1:\r\n        return formData.descricaoDemanda.trim() !== '';\r\n      case 2:\r\n        return formData.requisitosContratacao.trim() !== '';\r\n      case 3:\r\n        return !formData.alternativasExistem || formData.alternativasDescricao.trim() !== '';\r\n      case 4:\r\n        return formData.descricaoSolucao.trim() !== '';\r\n      case 5:\r\n        return formData.justificativaParcelamento.trim() !== '';\r\n      case 6:\r\n        return formData.resultadosPretendidos.trim() !== '';\r\n      case 7:\r\n        return !formData.providenciasExistem || formData.providenciasDescricao.trim() !== '';\r\n      case 8:\r\n        return !formData.contratacoesCorrelatas || formData.contratacoesDescricao.trim() !== '';\r\n      case 9:\r\n        return !formData.impactosAmbientais || formData.impactosDescricao.trim() !== '';\r\n      case 10:\r\n        return formData.observacoesGerais.trim() !== '';\r\n      case 11:\r\n        return formData.conclusaoTecnica.trim() !== '';\r\n      default:\r\n        return true;\r\n    }\r\n  };\r\n\r\n  const generateETPNumber = async () => {\r\n    const year = new Date().getFullYear();\r\n\r\n    // Get count of ETPs for current year\r\n    const { count, error } = await supabase\r\n      .from('etp')\r\n      .select('*', { count: 'exact', head: true })\r\n      .gte('created_at', `${year}-01-01`)\r\n      .lte('created_at', `${year}-12-31`);\r\n\r\n    if (error) {\r\n      console.error('Error generating ETP number:', error);\r\n      return `001/${year}`; // Fallback\r\n    }\r\n\r\n    const nextNumber = (count || 0) + 1;\r\n    return `${String(nextNumber).padStart(3, '0')}/${year}`;\r\n  };\r\n\r\n  const saveETP = async () => {\r\n    try {\r\n      const numeroETP = await generateETPNumber();\r\n\r\n      // 1. Create ETP Record\r\n      const { data: etpData, error: etpError } = await supabase\r\n        .from('etp')\r\n        .insert([{\r\n          numero_etp: numeroETP, // Added number generation\r\n          status: 'Em Elabora√ß√£o',\r\n          descricao_demanda: formData.descricaoDemanda,\r\n          requisitos_contratacao: formData.requisitosContratacao,\r\n          alternativas_existem: formData.alternativasExistem,\r\n          alternativas_descricao: formData.alternativasDescricao,\r\n          descricao_solucao: formData.descricaoSolucao,\r\n          justificativa_parcelamento: formData.justificativaParcelamento,\r\n          resultados_pretendidos: formData.resultadosPretendidos,\r\n          providencias_existem: formData.providenciasExistem,\r\n          providencias_descricao: formData.providenciasDescricao,\r\n          contratacoes_correlatas: formData.contratacoesCorrelatas,\r\n          contratacoes_descricao: formData.contratacoesDescricao,\r\n          impactos_ambientais: formData.impactosAmbientais,\r\n          impactos_descricao: formData.impactosDescricao,\r\n          observacoes_gerais: formData.observacoesGerais,\r\n          conclusao_tecnica: formData.conclusaoTecnica,\r\n          created_by: user?.id,\r\n          prefeitura_id: user?.prefeituraId\r\n        }])\r\n        .select()\r\n        .single();\r\n\r\n      if (etpError) throw etpError;\r\n\r\n      // 2. Link DFDs\r\n      if (formData.selectedDFDs.length > 0) {\r\n        const links = formData.selectedDFDs.map(dfd => ({\r\n          etp_id: etpData.id,\r\n          dfd_id: dfd.id\r\n        }));\r\n\r\n        const { error: linkError } = await supabase\r\n          .from('etp_dfd')\r\n          .insert(links);\r\n\r\n        if (linkError) throw linkError;\r\n      }\r\n\r\n      toast({\r\n        title: \"ETP Salvo\",\r\n        description: \"Estudo T√©cnico Preliminar salvo com sucesso no sistema.\",\r\n      });\r\n      localStorage.removeItem('etp-creation-progress');\r\n    } catch (error) {\r\n      console.error(error);\r\n      toast({\r\n        title: \"Erro ao salvar\",\r\n        description: \"N√£o foi poss√≠vel salvar o ETP.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const generatePDF = () => {\r\n    const generateETPId = () => {\r\n      return `ETP-${new Date().getFullYear()}-${String(Math.floor(Math.random() * 1000)).padStart(3, '0')}`;\r\n    };\r\n\r\n    const etpId = generateETPId();\r\n    const fileName = `${etpId.replace('-', '_')}.pdf`;\r\n\r\n    // Simulate PDF generation\r\n    toast({\r\n      title: \"PDF Gerado com Sucesso\",\r\n      description: `Documento ${fileName} foi gerado e est√° pronto para download.`,\r\n    });\r\n\r\n    // In a real implementation, you would use a library like jsPDF or html2pdf\r\n    // to generate the actual PDF from the preview content\r\n    console.log(`Generating PDF: ${fileName}`);\r\n    console.log('ETP Data:', formData);\r\n  };\r\n\r\n  return {\r\n    currentStep,\r\n    setCurrentStep,\r\n    formData,\r\n    updateFormData,\r\n    steps,\r\n    availableDFDs,\r\n    selectDFDs,\r\n    generateWithAI,\r\n    nextStep,\r\n    prevStep,\r\n    canProceed,\r\n    saveETP,\r\n    generatePDF,\r\n    loadETP\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\hooks\\usePCAData.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[845,848],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[845,848],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[907,910],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[907,910],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1037,1040],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1037,1040],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":23,"column":68,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":71,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1282,1285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1282,1285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1356,1359],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1356,1359],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2026,2029],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2026,2029],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2070,2073],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2070,2073],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2186,2189],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2186,2189],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":90,"column":55,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":90,"endColumn":58,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3590,3593],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3590,3593],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3642,3645],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3642,3645],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":92,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3730,3733],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3730,3733],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-expressions","severity":2,"message":"Expected an assignment or function call and instead saw an expression.","line":110,"column":7,"nodeType":"ExpressionStatement","messageId":"unusedExpression","endLine":110,"endColumn":8},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":156,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5783,5786],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5783,5786],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":161,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":161,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5899,5902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5899,5902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":185,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6505,6508],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6505,6508],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":209,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":209,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7224,7227],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7224,7227],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":236,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7928,7931],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7928,7931],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":263,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8712,8715],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8712,8715],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":268,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":268,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8831,8834],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8831,8834],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":295,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":295,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9582,9585],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9582,9585],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":351,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":351,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11255,11258],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11255,11258],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":21,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from 'react';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { DbDFD } from '@/types/database';\r\n\r\nexport const usePCAData = () => {\r\n  const [selectedYear, setSelectedYear] = useState(new Date().getFullYear().toString());\r\n  const [showPendingModal, setShowPendingModal] = useState(false);\r\n  const [showCancellationModal, setShowCancellationModal] = useState(false);\r\n  const [showPCAModal, setShowPCAModal] = useState(false);\r\n  const [showDFDViewModal, setShowDFDViewModal] = useState(false);\r\n  const [showScheduleModal, setShowScheduleModal] = useState(false);\r\n  const [showRemoveModal, setShowRemoveModal] = useState(false);\r\n  const [showExportModal, setShowExportModal] = useState(false);\r\n  const [selectedDFD, setSelectedDFD] = useState<any>(null);\r\n  const [dfdToRemove, setDFDToRemove] = useState<any>(null);\r\n  const [pcaPublished, setPcaPublished] = useState(false);\r\n  const [scheduleFilters, setScheduleFilters] = useState<any>(null);\r\n  const { toast } = useToast();\r\n\r\n  const [approvedDFDs, setApprovedDFDs] = useState<DbDFD[]>([]);\r\n  const [pendingDFDs, setPendingDFDs] = useState<DbDFD[]>([]);\r\n  const [cancellationRequests, setCancellationRequests] = useState<any[]>([]);\r\n  const [consolidatedItems, setConsolidatedItems] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  const fetchData = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      // Fetch Approved DFDs with Items and Secretaria\r\n      const { data: approved, error: approvedError } = await supabase\r\n        .from('dfd')\r\n        .select(`\r\n          *,\r\n          dfd_items (*),\r\n          secretarias ( nome )\r\n        `)\r\n        .eq('status', 'Aprovado')\r\n        .eq('ano_contratacao', parseInt(selectedYear));\r\n\r\n      if (approvedError) throw approvedError;\r\n\r\n      setApprovedDFDs(approved || []);\r\n\r\n      // Process consolidated items\r\n      if (approved) {\r\n        const allItems: any[] = [];\r\n        approved.forEach((dfd: any) => {\r\n          if (dfd.dfd_items && Array.isArray(dfd.dfd_items)) {\r\n            dfd.dfd_items.forEach((item: any) => {\r\n              allItems.push({\r\n                id: item.id,\r\n                descricao: item.descricao_item,\r\n                quantidade: Number(item.quantidade),\r\n                valor: Number(item.valor_unitario),\r\n                unidadeMedida: item.unidade,\r\n                detalhamentoTecnico: item.codigo_item,\r\n                secretaria: dfd.secretarias?.nome || 'Secretaria n√£o informada',\r\n                prioridade: dfd.prioridade || 'M√©dia',\r\n                dataContratacao: dfd.data_prevista_contratacao,\r\n                dfdId: dfd.id,\r\n                tipoDFD: dfd.tipo_dfd || 'Outros'\r\n              });\r\n            });\r\n          }\r\n        });\r\n        setConsolidatedItems(allItems);\r\n      }\r\n\r\n      // Fetch Pending DFDs\r\n      const { data: pending, error: pendingError } = await supabase\r\n        .from('dfd')\r\n        .select('*')\r\n        .eq('status', 'Pendente')\r\n        .eq('ano_contratacao', parseInt(selectedYear));\r\n\r\n      if (pendingError) throw pendingError;\r\n\r\n      // Fetch Users detailed info\r\n      const { data: usersData } = await supabase\r\n        .from('usuarios_acesso')\r\n        .select('*'); // Select all to get cargo, secretaria_id etc\r\n\r\n      // Fetch Secretarias\r\n      const { data: secretariasData } = await supabase\r\n        .from('secretarias')\r\n        .select('id, nome');\r\n\r\n      const mappedPending = (pending || []).map((dfd: any) => {\r\n        const user = usersData?.find((u: any) => u.id === dfd.created_by);\r\n        const secretaria = secretariasData?.find((s: any) => s.id === user?.secretaria_id);\r\n\r\n        return {\r\n          ...dfd,\r\n          tipoDFD: dfd.tipo_dfd,\r\n          valorEstimado: new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(dfd.valor_estimado_total || 0),\r\n          anoContratacao: dfd.ano_contratacao,\r\n          userName: user?.nome || 'Usu√°rio Desconhecido',\r\n          requisitante: {\r\n            nome: user?.nome || 'N√£o informado',\r\n            email: user?.email || 'N√£o informado',\r\n            cargo: user?.cargo || 'N√£o informado',\r\n            secretaria: secretaria?.nome || 'N√£o informada'\r\n          }\r\n        };\r\n      });\r\n\r\n      setPendingDFDs(mappedPending);\r\n      b\r\n      // Fetch Cancellation Requests\r\n      const { data: cancellations, error: cancellationsError } = await supabase\r\n        .from('dfd')\r\n        .select(`\r\n          *,\r\n          secretarias ( nome )\r\n        `)\r\n        .eq('solicitacao_cancelamento', true)\r\n        .eq('ano_contratacao', parseInt(selectedYear));\r\n\r\n      if (cancellationsError) throw cancellationsError;\r\n      setCancellationRequests(cancellations || []);\r\n\r\n      // Check PCA Config\r\n      const { data: pcaConfig, error: pcaError } = await supabase\r\n        .from('pca_config')\r\n        .select('*')\r\n        .eq('ano', parseInt(selectedYear))\r\n        .maybeSingle();\r\n\r\n      if (pcaError && pcaError.code !== 'PGRST116') throw pcaError;\r\n      setPcaPublished(pcaConfig?.status === 'Publicado');\r\n\r\n    } catch (error) {\r\n      console.error('Error fetching PCA data:', error);\r\n      toast({\r\n        title: \"Erro ao carregar dados\",\r\n        description: \"N√£o foi poss√≠vel carregar os dados do PCA.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [selectedYear, toast]);\r\n\r\n  useEffect(() => {\r\n    fetchData(); // Initial fetch\r\n\r\n    const interval = setInterval(() => {\r\n      fetchData();\r\n    }, 3000); // 3 seconds auto-refresh\r\n\r\n    return () => clearInterval(interval);\r\n  }, [fetchData]);\r\n\r\n  const handleViewDFD = (dfd: any) => {\r\n    setSelectedDFD(dfd);\r\n    setShowDFDViewModal(true);\r\n  };\r\n\r\n  const handleApproveDFD = async (dfd: any) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('dfd')\r\n        .update({ status: 'Aprovado' })\r\n        .eq('id', dfd.id);\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: \"DFD Aprovado\",\r\n        description: `O DFD \"${dfd.objeto}\" foi aprovado e inclu√≠do no PCA.`,\r\n      });\r\n      setShowPendingModal(false);\r\n      fetchData();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Erro ao aprovar\",\r\n        description: \"N√£o foi poss√≠vel aprovar o DFD.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleRejectDFD = async (dfd: any, justification: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('dfd')\r\n        .update({ status: 'Reprovado', justificativa: justification }) // Add justificativa rejection logic if needed field\r\n        .eq('id', dfd.id);\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: \"DFD Recusado\",\r\n        description: `O DFD \"${dfd.objeto}\" foi recusado e devolvido.`,\r\n      });\r\n      setShowPendingModal(false);\r\n      fetchData();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Erro ao reprovar\",\r\n        description: \"N√£o foi poss√≠vel reprovar o DFD.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleApproveCancellation = async (dfd: any) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('dfd')\r\n        .update({\r\n          status: 'Cancelado',\r\n          solicitacao_cancelamento: false\r\n        })\r\n        .eq('id', dfd.id);\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: \"Cancelamento Aprovado\",\r\n        description: `O DFD \"${dfd.objeto}\" foi retirado do PCA.`,\r\n      });\r\n      setShowCancellationModal(false);\r\n      fetchData();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Erro ao aprovar cancelamento\",\r\n        description: \"N√£o foi poss√≠vel processar a solicita√ß√£o.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDenyCancellation = async (dfd: any, justification: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('dfd')\r\n        .update({\r\n          solicitacao_cancelamento: false,\r\n          justificativa: justification // Opcional: salvar por que foi negado\r\n        })\r\n        .eq('id', dfd.id);\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: \"Cancelamento Negado\",\r\n        description: `A solicita√ß√£o de cancelamento do DFD \"${dfd.objeto}\" foi negada.`,\r\n      });\r\n      setShowCancellationModal(false);\r\n      fetchData();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Erro ao negar cancelamento\",\r\n        description: \"N√£o foi poss√≠vel processar a solicita√ß√£o.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleRemoveFromPCA = (dfd: any) => {\r\n    setDFDToRemove(dfd);\r\n    setShowRemoveModal(true);\r\n  };\r\n\r\n  const handleConfirmRemoval = async (dfd: any, justification: string) => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('dfd')\r\n        .update({\r\n          status: 'Cancelado',\r\n          justificativa_cancelamento: justification\r\n        })\r\n        .eq('id', dfd.id);\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: \"DFD Retirado do PCA\",\r\n        description: `O DFD \"${dfd.objeto}\" foi retirado do PCA com a justificativa fornecida.`,\r\n      });\r\n      setShowRemoveModal(false);\r\n      fetchData();\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Erro ao retirar do PCA\",\r\n        description: \"N√£o foi poss√≠vel processar a solicita√ß√£o.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleGenerateSchedule = (filters: any) => {\r\n    setScheduleFilters(filters);\r\n    toast({\r\n      title: \"Cronograma Gerado\",\r\n      description: `Cronograma ${filters.periodicity} gerado com sucesso para o ano ${filters.year}.`,\r\n    });\r\n    console.log('Generated schedule with filters:', filters);\r\n  };\r\n\r\n  const handlePrintSchedule = () => {\r\n    window.print();\r\n    toast({\r\n      title: \"Imprimindo Cronograma\",\r\n      description: \"O cronograma est√° sendo preparado para impress√£o.\",\r\n    });\r\n  };\r\n\r\n  const handlePublishPNCP = async () => {\r\n    try {\r\n      const { error } = await supabase\r\n        .from('pca_config')\r\n        .upsert({\r\n          ano: parseInt(selectedYear),\r\n          status: 'Publicado',\r\n          data_publicacao: new Date().toISOString()\r\n        }, { onConflict: 'ano' }); // Add prefeitura_id constraint if needed\r\n\r\n      if (error) throw error;\r\n\r\n      toast({\r\n        title: \"PCA Publicado\",\r\n        description: \"O PCA foi publicado/atualizado no Portal Nacional de Contrata√ß√µes P√∫blicas.\",\r\n      });\r\n      setPcaPublished(true);\r\n    } catch (error) {\r\n      toast({\r\n        title: \"Erro ao publicar\",\r\n        description: \"N√£o foi poss√≠vel publicar o PCA.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const totalItens = approvedDFDs.reduce((acc, dfd) => acc + 1, 0);\r\n\r\n  const formatCurrency = (value: number) => {\r\n    return new Intl.NumberFormat('pt-BR', {\r\n      style: 'currency',\r\n      currency: 'BRL'\r\n    }).format(value);\r\n  };\r\n\r\n  const calculateTotalValue = () => {\r\n    let total = 0;\r\n    approvedDFDs.forEach(dfd => {\r\n      if (dfd.dfd_items && Array.isArray(dfd.dfd_items)) {\r\n        dfd.dfd_items.forEach((item: any) => {\r\n          total += (Number(item.quantidade) * Number(item.valor_unitario));\r\n        });\r\n      }\r\n    });\r\n    return formatCurrency(total);\r\n  };\r\n\r\n  const valorTotal = calculateTotalValue();\r\n\r\n  return {\r\n    selectedYear,\r\n    setSelectedYear,\r\n    showPendingModal,\r\n    setShowPendingModal,\r\n    showCancellationModal,\r\n    setShowCancellationModal,\r\n    showPCAModal,\r\n    setShowPCAModal,\r\n    showDFDViewModal,\r\n    setShowDFDViewModal,\r\n    showScheduleModal,\r\n    setShowScheduleModal,\r\n    showRemoveModal,\r\n    setShowRemoveModal,\r\n    showExportModal,\r\n    setShowExportModal,\r\n    selectedDFD,\r\n    setSelectedDFD,\r\n    dfdToRemove,\r\n    setDFDToRemove,\r\n    pcaPublished,\r\n    setPcaPublished,\r\n    scheduleFilters,\r\n    setScheduleFilters,\r\n    approvedDFDs,\r\n    pendingDFDs,\r\n    cancellationRequests,\r\n    consolidatedItems,\r\n    totalItens,\r\n    valorTotal,\r\n    handleViewDFD,\r\n    handleApproveDFD,\r\n    handleRejectDFD,\r\n    handleApproveCancellation,\r\n    handleDenyCancellation,\r\n    handleRemoveFromPCA,\r\n    handleConfirmRemoval,\r\n    handleGenerateSchedule,\r\n    handlePrintSchedule,\r\n    handlePublishPNCP\r\n  };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\pages\\CronogramaLicitacoes.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":42,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1540,1543],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1540,1543],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2405,2408],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2405,2408],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2529,2532],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2529,2532],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from '@/components/ui/tooltip';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { \r\n  Download, \r\n  Eye, \r\n  FileText, \r\n  Filter,\r\n  Calendar,\r\n  Building,\r\n  Clock,\r\n  CheckCircle,\r\n} from 'lucide-react';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport {\r\n  Pagination,\r\n  PaginationContent,\r\n  PaginationItem,\r\n  PaginationLink,\r\n  PaginationNext,\r\n  PaginationPrevious,\r\n} from \"@/components/ui/pagination\";\r\nimport CronogramaItemsModal from '../components/CronogramaLicitacoes/CronogramaItemsModal';\r\nimport { useCronogramaData } from '../hooks/useCronogramaData';\r\nimport { formatDate, getPriorityColor } from '../utils/pcaConsolidation';\r\n\r\nconst CronogramaLicitacoes = () => {\r\n  const [filters, setFilters] = useState({\r\n    ano: '2024',\r\n    secretaria: 'all',\r\n    prioridade: 'all',\r\n    tipoDFD: 'all'\r\n  });\r\n  const [currentFilter, setCurrentFilter] = useState<string>('all');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [showItemsModal, setShowItemsModal] = useState(false);\r\n  const [selectedLicitacao, setSelectedLicitacao] = useState<any>(null);\r\n  const { toast } = useToast();\r\n  const itemsPerPage = 5;\r\n\r\n  const { \r\n    cronogramaData,\r\n    secretarias,\r\n    tiposDFD,\r\n    filteredData \r\n  } = useCronogramaData(filters);\r\n\r\n  // Apply status filter\r\n  const statusFilteredData = filteredData.filter(item => {\r\n    switch (currentFilter) {\r\n      case 'em-elaboracao':\r\n        return item.status === 'Em Elabora√ß√£o';\r\n      case 'concluidos':\r\n        return item.status === 'Conclu√≠do';\r\n      case 'publicados':\r\n        return item.status === 'Publicado';\r\n      default:\r\n        return true;\r\n    }\r\n  });\r\n\r\n  // Pagination\r\n  const totalPages = Math.ceil(statusFilteredData.length / itemsPerPage);\r\n  const startIndex = (currentPage - 1) * itemsPerPage;\r\n  const paginatedData = statusFilteredData.slice(startIndex, startIndex + itemsPerPage);\r\n\r\n  const handleViewItems = (licitacao: any) => {\r\n    setSelectedLicitacao(licitacao);\r\n    setShowItemsModal(true);\r\n  };\r\n\r\n  const handleCreateTR = (licitacao: any) => {\r\n    toast({\r\n      title: \"Redirecionando para TR\",\r\n      description: `Criando Termo de Refer√™ncia para: ${licitacao.tipoDFD}`,\r\n    });\r\n  };\r\n\r\n  const handleExportPDF = () => {\r\n    toast({\r\n      title: \"Exportando PDF\",\r\n      description: \"Cronograma de licita√ß√µes est√° sendo gerado em PDF.\",\r\n    });\r\n  };\r\n\r\n  const handleExportXLS = () => {\r\n    toast({\r\n      title: \"Exportando Excel\",\r\n      description: \"Cronograma de licita√ß√µes est√° sendo gerado em Excel.\",\r\n    });\r\n  };\r\n\r\n  const updateFilter = (key: string, value: string) => {\r\n    setFilters(prev => ({ ...prev, [key]: value }));\r\n  };\r\n\r\n  const handleFilterChange = (filter: string) => {\r\n    setCurrentFilter(filter);\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const handlePageChange = (page: number) => {\r\n    setCurrentPage(page);\r\n  };\r\n\r\n  return (\r\n    <TooltipProvider>\r\n      <div className=\"space-y-6\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">Cronograma de Licita√ß√µes</h1>\r\n            <p className=\"text-gray-600\">\r\n              Visualize e gerencie o cronograma de licita√ß√µes baseado nos dados do PCA\r\n            </p>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Button variant=\"outline\" onClick={handleExportPDF}>\r\n              <Download size={16} className=\"mr-2\" />\r\n              Exportar PDF\r\n            </Button>\r\n            <Button variant=\"outline\" onClick={handleExportXLS}>\r\n              <Download size={16} className=\"mr-2\" />\r\n              Exportar Excel\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Statistics Cards - Now clickable filters */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n          <Card \r\n            className={`cursor-pointer transition-all hover:shadow-md ${\r\n              currentFilter === 'all' ? 'ring-2 ring-blue-500' : ''\r\n            }`}\r\n            onClick={() => handleFilterChange('all')}\r\n          >\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n                  <Calendar size={20} className=\"text-blue-600\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-gray-600\">Total de Licita√ß√µes</p>\r\n                  <p className=\"text-xl font-bold text-gray-900\">{filteredData.length}</p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card \r\n            className={`cursor-pointer transition-all hover:shadow-md ${\r\n              currentFilter === 'em-elaboracao' ? 'ring-2 ring-yellow-500' : ''\r\n            }`}\r\n            onClick={() => handleFilterChange('em-elaboracao')}\r\n          >\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"p-2 bg-yellow-100 rounded-lg\">\r\n                  <Clock size={20} className=\"text-yellow-600\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-gray-600\">Em Elabora√ß√£o</p>\r\n                  <p className=\"text-xl font-bold text-gray-900\">\r\n                    {filteredData.filter(item => item.status === 'Em Elabora√ß√£o').length}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card \r\n            className={`cursor-pointer transition-all hover:shadow-md ${\r\n              currentFilter === 'concluidos' ? 'ring-2 ring-green-500' : ''\r\n            }`}\r\n            onClick={() => handleFilterChange('concluidos')}\r\n          >\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"p-2 bg-green-100 rounded-lg\">\r\n                  <CheckCircle size={20} className=\"text-green-600\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-gray-600\">Conclu√≠dos</p>\r\n                  <p className=\"text-xl font-bold text-gray-900\">\r\n                    {filteredData.filter(item => item.status === 'Conclu√≠do').length}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n\r\n          <Card \r\n            className={`cursor-pointer transition-all hover:shadow-md ${\r\n              currentFilter === 'publicados' ? 'ring-2 ring-purple-500' : ''\r\n            }`}\r\n            onClick={() => handleFilterChange('publicados')}\r\n          >\r\n            <CardContent className=\"p-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <div className=\"p-2 bg-purple-100 rounded-lg\">\r\n                  <Building size={20} className=\"text-purple-600\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-gray-600\">Publicados</p>\r\n                  <p className=\"text-xl font-bold text-gray-900\">\r\n                    {filteredData.filter(item => item.status === 'Publicado').length}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </CardContent>\r\n          </Card>\r\n        </div>\r\n\r\n        {/* Filters */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center\">\r\n              <Filter size={20} className=\"mr-2\" />\r\n              Filtros\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-700 mb-2 block\">\r\n                  Ano de Contrata√ß√£o\r\n                </label>\r\n                <Select value={filters.ano} onValueChange={(value) => updateFilter('ano', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Selecione o ano\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"2024\">2024</SelectItem>\r\n                    <SelectItem value=\"2025\">2025</SelectItem>\r\n                    <SelectItem value=\"2026\">2026</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n              \r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-700 mb-2 block\">\r\n                  Secretaria\r\n                </label>\r\n                <Select value={filters.secretaria} onValueChange={(value) => updateFilter('secretaria', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Todas as secretarias\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">Todas as secretarias</SelectItem>\r\n                    {secretarias.map((secretaria) => (\r\n                      <SelectItem key={secretaria} value={secretaria}>\r\n                        {secretaria}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-700 mb-2 block\">\r\n                  Prioridade\r\n                </label>\r\n                <Select value={filters.prioridade} onValueChange={(value) => updateFilter('prioridade', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Todas as prioridades\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">Todas as prioridades</SelectItem>\r\n                    <SelectItem value=\"Alta\">Alta</SelectItem>\r\n                    <SelectItem value=\"M√©dia\">M√©dia</SelectItem>\r\n                    <SelectItem value=\"Baixa\">Baixa</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-sm font-medium text-gray-700 mb-2 block\">\r\n                  Tipo de DFD\r\n                </label>\r\n                <Select value={filters.tipoDFD} onValueChange={(value) => updateFilter('tipoDFD', value)}>\r\n                  <SelectTrigger>\r\n                    <SelectValue placeholder=\"Todos os tipos\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">Todos os tipos</SelectItem>\r\n                    {tiposDFD.map((tipo) => (\r\n                      <SelectItem key={tipo} value={tipo}>\r\n                        {tipo}\r\n                      </SelectItem>\r\n                    ))}\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Cronograma Table */}\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"flex items-center\">\r\n              <Calendar size={20} className=\"mr-2\" />\r\n              Cronograma de Licita√ß√µes - {filters.ano}\r\n              {currentFilter !== 'all' && (\r\n                <span className=\"text-sm font-normal text-gray-600 ml-2\">\r\n                  - {currentFilter === 'em-elaboracao' ? 'Em Elabora√ß√£o' : \r\n                     currentFilter === 'concluidos' ? 'Conclu√≠dos' : \r\n                     'Publicados'}\r\n                </span>\r\n              )}\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent>\r\n            {statusFilteredData.length === 0 ? (\r\n              <div className=\"text-center py-8\">\r\n                <Calendar size={48} className=\"mx-auto text-gray-400 mb-4\" />\r\n                <p className=\"text-gray-500\">\r\n                  {currentFilter === 'all' \r\n                    ? 'Nenhuma licita√ß√£o encontrada para os filtros selecionados.' \r\n                    : `Nenhuma licita√ß√£o ${currentFilter === 'em-elaboracao' ? 'em elabora√ß√£o' : \r\n                                         currentFilter === 'concluidos' ? 'conclu√≠da' : \r\n                                         'publicada'} encontrada.`}\r\n                </p>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                <div className=\"overflow-x-auto\">\r\n                  <Table>\r\n                    <TableHeader>\r\n                      <TableRow>\r\n                        <TableHead>Tipo de DFD</TableHead>\r\n                        <TableHead>Data de Contrata√ß√£o</TableHead>\r\n                        <TableHead>Data Sugerida de Abertura</TableHead>\r\n                        <TableHead>Prioridade</TableHead>\r\n                        <TableHead>Secretarias Envolvidas</TableHead>\r\n                        <TableHead>Valor Total</TableHead>\r\n                        <TableHead>A√ß√µes</TableHead>\r\n                      </TableRow>\r\n                    </TableHeader>\r\n                    <TableBody>\r\n                      {paginatedData.map((licitacao) => (\r\n                        <TableRow key={licitacao.id}>\r\n                          <TableCell>\r\n                            <div className=\"font-medium\">\r\n                              {licitacao.tipoDFD}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell>{formatDate(licitacao.dataContratacao)}</TableCell>\r\n                          <TableCell>{formatDate(licitacao.dataSugeridaAbertura)}</TableCell>\r\n                          <TableCell>\r\n                            <Badge className={getPriorityColor(licitacao.prioridade)}>\r\n                              {licitacao.prioridade}\r\n                            </Badge>\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"flex flex-wrap gap-1\">\r\n                              {licitacao.secretariasSiglas.slice(0, 3).map((sigla: string, index: number) => (\r\n                                <Tooltip key={index}>\r\n                                  <TooltipTrigger>\r\n                                    <Badge variant=\"outline\" className=\"text-xs cursor-help\">\r\n                                      {sigla}\r\n                                    </Badge>\r\n                                  </TooltipTrigger>\r\n                                  <TooltipContent>\r\n                                    <p>{licitacao.secretariasNomes[index]}</p>\r\n                                  </TooltipContent>\r\n                                </Tooltip>\r\n                              ))}\r\n                              {licitacao.secretariasSiglas.length > 3 && (\r\n                                <Tooltip>\r\n                                  <TooltipTrigger>\r\n                                    <Badge variant=\"outline\" className=\"text-xs cursor-help\">\r\n                                      +{licitacao.secretariasSiglas.length - 3}\r\n                                    </Badge>\r\n                                  </TooltipTrigger>\r\n                                  <TooltipContent>\r\n                                    <div className=\"space-y-1\">\r\n                                      {licitacao.secretariasNomes.slice(3).map((nome: string, index: number) => (\r\n                                        <p key={index}>{nome}</p>\r\n                                      ))}\r\n                                    </div>\r\n                                  </TooltipContent>\r\n                                </Tooltip>\r\n                              )}\r\n                            </div>\r\n                          </TableCell>\r\n                          <TableCell className=\"font-medium\">\r\n                            {licitacao.valorTotal}\r\n                          </TableCell>\r\n                          <TableCell>\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              <Button\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleViewItems(licitacao)}\r\n                              >\r\n                                <Eye size={14} className=\"mr-1\" />\r\n                                Ver Itens\r\n                              </Button>\r\n                              <Button\r\n                                variant=\"outline\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleCreateTR(licitacao)}\r\n                                className=\"bg-orange-50 border-orange-200 text-orange-700 hover:bg-orange-100\"\r\n                              >\r\n                                <FileText size={14} className=\"mr-1\" />\r\n                                Criar TR\r\n                              </Button>\r\n                            </div>\r\n                          </TableCell>\r\n                        </TableRow>\r\n                      ))}\r\n                    </TableBody>\r\n                  </Table>\r\n                </div>\r\n\r\n                {/* Pagination */}\r\n                {totalPages > 1 && (\r\n                  <div className=\"mt-6 flex justify-center\">\r\n                    <Pagination>\r\n                      <PaginationContent>\r\n                        <PaginationItem>\r\n                          <PaginationPrevious \r\n                            onClick={() => handlePageChange(Math.max(1, currentPage - 1))}\r\n                            className={currentPage === 1 ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                          />\r\n                        </PaginationItem>\r\n                        \r\n                        {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\r\n                          <PaginationItem key={page}>\r\n                            <PaginationLink\r\n                              onClick={() => handlePageChange(page)}\r\n                              isActive={currentPage === page}\r\n                              className=\"cursor-pointer\"\r\n                            >\r\n                              {page}\r\n                            </PaginationLink>\r\n                          </PaginationItem>\r\n                        ))}\r\n                        \r\n                        <PaginationItem>\r\n                          <PaginationNext \r\n                            onClick={() => handlePageChange(Math.min(totalPages, currentPage + 1))}\r\n                            className={currentPage === totalPages ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                          />\r\n                        </PaginationItem>\r\n                      </PaginationContent>\r\n                    </Pagination>\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* Items Modal */}\r\n        <CronogramaItemsModal\r\n          isOpen={showItemsModal}\r\n          onClose={() => setShowItemsModal(false)}\r\n          licitacao={selectedLicitacao}\r\n        />\r\n      </div>\r\n    </TooltipProvider>\r\n  );\r\n};\r\n\r\nexport default CronogramaLicitacoes;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\pages\\DFD.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[742,745],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[742,745],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1220,1223],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1220,1223],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":44,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":44,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1840,1843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1840,1843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":54,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":54,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2135,2138],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2135,2138],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":69,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2864,2867],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2864,2867],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3768,3771],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3768,3771],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport { Plus, FileText, Clock, CheckCircle, Building } from 'lucide-react';\r\nimport DFDForm from '../components/DFD/DFDForm';\r\nimport DFDList from '../components/DFD/DFDList';\r\nimport ActionConfirmModal from '../components/DFD/ActionConfirmModal';\r\nimport DFDViewModal from '../components/DFD/DFDViewModal';\r\nimport { dfdService } from '@/services/dfdService';\r\n\r\nconst DFD = () => {\r\n  console.log('DFD component rendering...');\r\n\r\n  const [showForm, setShowForm] = useState(false);\r\n  const [editingDFD, setEditingDFD] = useState<any>(null);\r\n  const [filters, setFilters] = useState({\r\n    tipoDFD: '',\r\n    prioridade: '',\r\n    anoContratacao: '',\r\n    status: ''\r\n  });\r\n  const [currentFilter, setCurrentFilter] = useState<string>('all');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [showActionModal, setShowActionModal] = useState(false);\r\n  const [actionType, setActionType] = useState<'cancel' | 'delete' | 'remove-pca'>('cancel');\r\n  const [selectedDFD, setSelectedDFD] = useState<any>(null);\r\n  const [actionJustification, setActionJustification] = useState('');\r\n  const [showViewModal, setShowViewModal] = useState(false);\r\n  const { toast } = useToast();\r\n\r\n  // Check for filter from dashboard navigation\r\n  useEffect(() => {\r\n    const dashboardFilter = sessionStorage.getItem('documentFilter');\r\n    if (dashboardFilter === 'em-elaboracao') {\r\n      setCurrentFilter('em-elaboracao');\r\n      sessionStorage.removeItem('documentFilter'); // Clean up\r\n    }\r\n  }, []);\r\n\r\n  console.log('DFD state:', { showForm, filters, currentPage });\r\n\r\n  // State for DFDs\r\n  const [dfds, setDfds] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Fetch DFDs\r\n  const fetchDFDs = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const data = await dfdService.getAll();\r\n      if (data) {\r\n        // Map DB to Frontend Model\r\n        const mappedData = data.map((d: any) => ({\r\n          id: d.id,\r\n          objeto: d.objeto,\r\n          tipoDFD: d.tipo_dfd,\r\n          valor: new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(d.valor_estimado_total || 0),\r\n          status: d.status,\r\n          data: new Date(d.created_at).toLocaleDateString(),\r\n          prioridade: d.prioridade,\r\n          anoContratacao: d.ano_contratacao?.toString(),\r\n          descricaoDemanda: d.descricao_demanda,\r\n          justificativa: d.justificativa,\r\n          dataPrevista: d.data_prevista_contratacao,\r\n          justificativaPrioridade: d.justificativa_prioridade,\r\n          descricaoSucinta: d.descricao_sucinta,\r\n          // Map Items\r\n          itens: d.dfd_items?.map((i: any) => ({\r\n            id: i.id,\r\n            codigo: i.codigo_item,\r\n            descricao: i.descricao_item,\r\n            unidade: i.unidade,\r\n            quantidade: Number(i.quantidade),\r\n            valorReferencia: Number(i.valor_unitario),\r\n            tabelaReferencia: i.tabela_referencia\r\n          })) || []\r\n        }));\r\n        setDfds(mappedData);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching DFDs:', error);\r\n      toast({\r\n        title: \"Erro ao carregar DFDs\",\r\n        description: \"N√£o foi poss√≠vel carregar as demandas. Tente novamente.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDFDs();\r\n  }, []);\r\n\r\n  // Filter logic applied to fetched data\r\n  const allDFDs = dfds; // Remapping to keep existing logic working with minimal changes\r\n\r\n  const handleAction = (dfd: any, action: 'cancel' | 'delete' | 'remove-pca' | 'view' | 'edit') => {\r\n    console.log('handleAction called:', dfd, action);\r\n\r\n    switch (action) {\r\n      case 'view':\r\n        setSelectedDFD(dfd);\r\n        setShowViewModal(true);\r\n        break;\r\n      case 'edit':\r\n        setEditingDFD(dfd);\r\n        setShowForm(true);\r\n        break;\r\n      case 'cancel':\r\n      case 'delete':\r\n      case 'remove-pca':\r\n        setSelectedDFD(dfd);\r\n        setActionType(action);\r\n        setShowActionModal(true);\r\n        break;\r\n    }\r\n  };\r\n\r\n  const confirmAction = async () => {\r\n    if (!selectedDFD) return;\r\n\r\n    try {\r\n      console.log('confirmAction called:', actionType);\r\n\r\n      if (actionType === 'delete') {\r\n        await dfdService.delete(selectedDFD.id);\r\n      } else if (actionType === 'cancel') {\r\n        await dfdService.cancel(selectedDFD.id, actionJustification);\r\n      } else if (actionType === 'remove-pca') {\r\n        await dfdService.requestCancellation(selectedDFD.id, actionJustification);\r\n      }\r\n\r\n      const actionMessages = {\r\n        'cancel': 'DFD cancelado com sucesso',\r\n        'delete': 'DFD exclu√≠do permanentemente',\r\n        'remove-pca': 'Solicita√ß√£o de retirada do PCA enviada'\r\n      };\r\n\r\n      toast({\r\n        title: \"A√ß√£o realizada\",\r\n        description: actionMessages[actionType],\r\n      });\r\n\r\n      setShowActionModal(false);\r\n      setActionJustification('');\r\n      setSelectedDFD(null);\r\n      fetchDFDs(); // Refresh list\r\n    } catch (error) {\r\n      console.error(`Error performing ${actionType}:`, error);\r\n      toast({\r\n        title: \"Erro ao realizar a√ß√£o\",\r\n        description: \"Ocorreu um erro no servidor. Tente novamente.\",\r\n        variant: \"destructive\"\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleFormBack = () => {\r\n    setShowForm(false);\r\n    setEditingDFD(null);\r\n  };\r\n\r\n  const handleFilterChange = (filter: string) => {\r\n    setCurrentFilter(filter);\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  if (showForm) {\r\n    console.log('Rendering DFDForm...');\r\n    return <DFDForm onBack={handleFormBack} editingDFD={editingDFD} />;\r\n  }\r\n\r\n  console.log('Rendering main DFD page...');\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">DFD - Documentos de Formaliza√ß√£o</h1>\r\n          <p className=\"text-gray-600\">Gerencie as demandas de contrata√ß√£o</p>\r\n        </div>\r\n        <Button onClick={() => setShowForm(true)} className=\"bg-orange-500 hover:bg-orange-600\">\r\n          <Plus size={16} className=\"mr-2\" />\r\n          Novo DFD\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Statistics Cards - Now clickable filters */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md ${currentFilter === 'all' ? 'ring-2 ring-blue-500' : ''\r\n            }`}\r\n          onClick={() => handleFilterChange('all')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-blue-100 rounded-lg\">\r\n                <FileText size={20} className=\"text-blue-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Total de DFDs</p>\r\n                <p className=\"text-xl font-bold text-gray-900\">{allDFDs.length}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md ${currentFilter === 'em-elaboracao' ? 'ring-2 ring-yellow-500' : ''\r\n            }`}\r\n          onClick={() => handleFilterChange('em-elaboracao')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-yellow-100 rounded-lg\">\r\n                <Clock size={20} className=\"text-yellow-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Em Elabora√ß√£o</p>\r\n                <p className=\"text-xl font-bold text-gray-900\">\r\n                  {allDFDs.filter(dfd => dfd.status === 'Em Elabora√ß√£o').length}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md ${currentFilter === 'aprovados' ? 'ring-2 ring-green-500' : ''\r\n            }`}\r\n          onClick={() => handleFilterChange('aprovados')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-green-100 rounded-lg\">\r\n                <CheckCircle size={20} className=\"text-green-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Aprovados</p>\r\n                <p className=\"text-xl font-bold text-gray-900\">\r\n                  {allDFDs.filter(dfd => dfd.status === 'Aprovado').length}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md ${currentFilter === 'pendentes' ? 'ring-2 ring-orange-500' : ''\r\n            }`}\r\n          onClick={() => handleFilterChange('pendentes')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-orange-100 rounded-lg\">\r\n                <Building size={20} className=\"text-orange-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-sm text-gray-600\">Pendentes</p>\r\n                <p className=\"text-xl font-bold text-gray-900\">\r\n                  {allDFDs.filter(dfd => dfd.status === 'Pendente Aprova√ß√£o').length}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      <DFDList\r\n        filters={filters}\r\n        onFilterChange={setFilters}\r\n        currentPage={currentPage}\r\n        onPageChange={setCurrentPage}\r\n        onAction={handleAction}\r\n        currentFilter={currentFilter}\r\n        dfds={allDFDs}\r\n      />\r\n\r\n      <ActionConfirmModal\r\n        open={showActionModal}\r\n        onClose={() => setShowActionModal(false)}\r\n        actionType={actionType}\r\n        dfd={selectedDFD}\r\n        justification={actionJustification}\r\n        onJustificationChange={setActionJustification}\r\n        onConfirm={confirmAction}\r\n      />\r\n\r\n      <DFDViewModal\r\n        open={showViewModal}\r\n        onClose={() => setShowViewModal(false)}\r\n        dfd={selectedDFD}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DFD;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\pages\\ETP.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1054,1057],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1054,1057],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1192,1195],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1192,1195],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1393,1396],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1393,1396],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":57,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":57,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2006,2009],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2006,2009],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":58,"column":70,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":73,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2086,2089],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2086,2089],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2237,2240],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2237,2240],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":112,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3628,3631],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3628,3631],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":130,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4013,4016],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4013,4016],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":141,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4284,4287],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4284,4287],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":299,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":299,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10566,10569],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10566,10569],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":10,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { supabase } from '@/lib/supabase';\r\nimport { Card, CardContent } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Progress } from '@/components/ui/progress';\r\nimport {\r\n  Save,\r\n  Download,\r\n  ArrowRight,\r\n  ArrowLeft,\r\n  FileText\r\n} from 'lucide-react';\r\nimport { useETPCreation } from '../hooks/useETPCreation';\r\nimport ETPDashboard from '../components/ETP/ETPDashboard';\r\nimport ETPViewModal from '../components/ETP/ETPViewModal';\r\nimport DFDSelectionStep from '../components/ETP/DFDSelectionStep';\r\nimport FormStep from '../components/ETP/FormStep';\r\nimport SummaryStep from '../components/ETP/SummaryStep';\r\nimport DFDListPagination from '../components/DFD/DFDListPagination';\r\nimport { useToast } from '@/hooks/use-toast';\r\n\r\ntype ViewMode = 'dashboard' | 'creation' | 'completed' | 'inProgress' | 'view';\r\n\r\nconst ETP = () => {\r\n  const [viewMode, setViewMode] = useState<ViewMode>('dashboard');\r\n  const [selectedETP, setSelectedETP] = useState<any>(null);\r\n  const [viewModalOpen, setViewModalOpen] = useState(false);\r\n  const [selectedETPForView, setSelectedETPForView] = useState<any>(null);\r\n  const [completedPage, setCompletedPage] = useState(1);\r\n  const [inProgressPage, setInProgressPage] = useState(1);\r\n  const { toast } = useToast();\r\n\r\n  const [etps, setEtps] = useState<any[]>([]);\r\n\r\n  useEffect(() => {\r\n    const fetchETPs = async () => {\r\n      try {\r\n        // 1. Fetch ETPs with related DFDs\r\n        const { data, error } = await supabase\r\n          .from('etp')\r\n          .select(`\r\n            *,\r\n            etp_dfd (\r\n              dfd (\r\n                valor_estimado_total\r\n              )\r\n            )\r\n          `);\r\n\r\n        if (error) throw error;\r\n\r\n        // 2. Fetch Users for \"Respons√°vel\"\r\n        const { data: usersData } = await supabase\r\n          .from('usuarios_acesso')\r\n          .select('id, nome');\r\n\r\n        const formatted = data.map((etp: any) => {\r\n          const totalValue = etp.etp_dfd?.reduce((acc: number, item: any) => {\r\n            return acc + (item.dfd?.valor_estimado_total || 0);\r\n          }, 0) || 0;\r\n\r\n          const responsavel = usersData?.find((u: any) => u.id === etp.created_by)?.nome || 'N√£o identificado';\r\n\r\n          return {\r\n            id: etp.id,\r\n            titulo: `ETP ${etp.numero_etp || 'Sem N√∫mero'}`,\r\n            numeroETP: etp.numero_etp || 'Rascunho',\r\n            status: etp.status,\r\n            totalDFDs: etp.etp_dfd?.length || 0,\r\n            valorTotal: new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalValue),\r\n            currentStep: etp.status === 'Em Elabora√ß√£o' ? 12 : 12,\r\n            responsavel: responsavel,\r\n            dataCriacao: etp.created_at,\r\n            dataUltimaEdicao: etp.created_at\r\n          };\r\n        });\r\n        setEtps(formatted);\r\n      } catch (error) {\r\n        console.error('Error fetching ETPs:', error);\r\n        toast({\r\n          title: \"Erro ao carregar ETPs\",\r\n          description: \"N√£o foi poss√≠vel carregar a lista de ETPs.\",\r\n          variant: \"destructive\"\r\n        });\r\n      }\r\n    };\r\n    fetchETPs();\r\n  }, [viewMode]);\r\n\r\n  const {\r\n    currentStep,\r\n    setCurrentStep,\r\n    formData,\r\n    updateFormData,\r\n    steps,\r\n    availableDFDs,\r\n    selectDFDs,\r\n    generateWithAI,\r\n    nextStep,\r\n    prevStep,\r\n    canProceed,\r\n    saveETP,\r\n    generatePDF,\r\n    loadETP\r\n  } = useETPCreation();\r\n\r\n  const handleCreateNew = () => {\r\n    setViewMode('creation');\r\n    setCurrentStep(0);\r\n  };\r\n\r\n  const handleViewETP = (etp: any) => {\r\n    setSelectedETPForView(etp);\r\n    setViewModalOpen(true);\r\n  };\r\n\r\n  const handleCloseViewModal = () => {\r\n    setViewModalOpen(false);\r\n    setSelectedETPForView(null);\r\n  };\r\n\r\n  const handleViewCompleted = () => {\r\n    setViewMode('completed');\r\n  };\r\n\r\n  const handleViewInProgress = () => {\r\n    setViewMode('inProgress');\r\n  };\r\n\r\n  const handleContinueETP = (etp: any) => {\r\n    setSelectedETP(etp);\r\n    loadETP(etp.id); // Load data\r\n    setViewMode('creation');\r\n\r\n    toast({\r\n      title: \"ETP Carregado\",\r\n      description: `Continuando o preenchimento do ${etp.numeroETP}.`,\r\n    });\r\n  };\r\n\r\n  const handleGeneratePDF = (etp: any) => {\r\n    const fileName = `${etp.numeroETP.replace('-', '_')}.pdf`;\r\n\r\n    toast({\r\n      title: \"PDF Gerado com Sucesso\",\r\n      description: `Documento ${fileName} foi gerado e est√° pronto para download.`,\r\n    });\r\n  };\r\n\r\n  const handleBackToDashboard = () => {\r\n    setViewMode('dashboard');\r\n    setSelectedETP(null);\r\n  };\r\n\r\n  const renderCurrentStep = () => {\r\n    switch (currentStep) {\r\n      case 0:\r\n        return (\r\n          <DFDSelectionStep\r\n            availableDFDs={availableDFDs}\r\n            selectedDFDs={formData.selectedDFDs}\r\n            onSelectDFDs={selectDFDs}\r\n          />\r\n        );\r\n      case 1:\r\n        return (\r\n          <FormStep\r\n            title=\"Descri√ß√£o da Demanda\"\r\n            description=\"Detalhamento da necessidade identificada\"\r\n            value={formData.descricaoDemanda}\r\n            onValueChange={(value) => updateFormData('descricaoDemanda', value)}\r\n            onGenerateAI={() => generateWithAI('descricaoDemanda')}\r\n            rows={8}\r\n          />\r\n        );\r\n      case 2:\r\n        return (\r\n          <FormStep\r\n            title=\"Requisitos da Contrata√ß√£o\"\r\n            description=\"Especifica√ß√£o dos requisitos t√©cnicos e legais\"\r\n            value={formData.requisitosContratacao}\r\n            onValueChange={(value) => updateFormData('requisitosContratacao', value)}\r\n            onGenerateAI={() => generateWithAI('requisitosContratacao')}\r\n          />\r\n        );\r\n      case 3:\r\n        return (\r\n          <FormStep\r\n            title=\"Alternativas Poss√≠veis\"\r\n            description=\"An√°lise de alternativas para atender √† demanda\"\r\n            value={formData.alternativasDescricao}\r\n            onValueChange={(value) => updateFormData('alternativasDescricao', value)}\r\n            onGenerateAI={() => generateWithAI('alternativasDescricao')}\r\n            hasCondition={true}\r\n            conditionLabel=\"Existem outras poss√≠veis alternativas?\"\r\n            conditionValue={formData.alternativasExistem}\r\n            onConditionChange={(value) => updateFormData('alternativasExistem', value)}\r\n          />\r\n        );\r\n      case 4:\r\n        return (\r\n          <FormStep\r\n            title=\"Descri√ß√£o da Solu√ß√£o\"\r\n            description=\"Detalhamento da solu√ß√£o proposta\"\r\n            value={formData.descricaoSolucao}\r\n            onValueChange={(value) => updateFormData('descricaoSolucao', value)}\r\n            onGenerateAI={() => generateWithAI('descricaoSolucao')}\r\n          />\r\n        );\r\n      case 5:\r\n        return (\r\n          <FormStep\r\n            title=\"Justificativa do Parcelamento\"\r\n            description=\"Fundamenta√ß√£o para parcelamento ou n√£o da contrata√ß√£o\"\r\n            value={formData.justificativaParcelamento}\r\n            onValueChange={(value) => updateFormData('justificativaParcelamento', value)}\r\n            onGenerateAI={() => generateWithAI('justificativaParcelamento')}\r\n          />\r\n        );\r\n      case 6:\r\n        return (\r\n          <FormStep\r\n            title=\"Resultados Pretendidos\"\r\n            description=\"Objetivos e metas esperadas com a contrata√ß√£o\"\r\n            value={formData.resultadosPretendidos}\r\n            onValueChange={(value) => updateFormData('resultadosPretendidos', value)}\r\n            onGenerateAI={() => generateWithAI('resultadosPretendidos')}\r\n          />\r\n        );\r\n      case 7:\r\n        return (\r\n          <FormStep\r\n            title=\"Provid√™ncias Pr√©vias\"\r\n            description=\"A√ß√µes necess√°rias antes da contrata√ß√£o\"\r\n            value={formData.providenciasDescricao}\r\n            onValueChange={(value) => updateFormData('providenciasDescricao', value)}\r\n            onGenerateAI={() => generateWithAI('providenciasDescricao')}\r\n            hasCondition={true}\r\n            conditionLabel=\"Existem provid√™ncias pr√©vias necess√°rias?\"\r\n            conditionValue={formData.providenciasExistem}\r\n            onConditionChange={(value) => updateFormData('providenciasExistem', value)}\r\n          />\r\n        );\r\n      case 8:\r\n        return (\r\n          <FormStep\r\n            title=\"Contrata√ß√µes Correlatas\"\r\n            description=\"Contrata√ß√µes relacionadas ou interdependentes\"\r\n            value={formData.contratacoesDescricao}\r\n            onValueChange={(value) => updateFormData('contratacoesDescricao', value)}\r\n            onGenerateAI={() => generateWithAI('contratacoesDescricao')}\r\n            hasCondition={true}\r\n            conditionLabel=\"Existem contrata√ß√µes correlatas ou interdependentes?\"\r\n            conditionValue={formData.contratacoesCorrelatas}\r\n            onConditionChange={(value) => updateFormData('contratacoesCorrelatas', value)}\r\n          />\r\n        );\r\n      case 9:\r\n        return (\r\n          <FormStep\r\n            title=\"Impactos Ambientais\"\r\n            description=\"An√°lise de poss√≠veis impactos ao meio ambiente\"\r\n            value={formData.impactosDescricao}\r\n            onValueChange={(value) => updateFormData('impactosDescricao', value)}\r\n            onGenerateAI={() => generateWithAI('impactosDescricao')}\r\n            hasCondition={true}\r\n            conditionLabel=\"Existem poss√≠veis impactos ambientais?\"\r\n            conditionValue={formData.impactosAmbientais}\r\n            onConditionChange={(value) => updateFormData('impactosAmbientais', value)}\r\n          />\r\n        );\r\n      case 10:\r\n        return (\r\n          <FormStep\r\n            title=\"Observa√ß√µes Gerais\"\r\n            description=\"Informa√ß√µes adicionais relevantes\"\r\n            value={formData.observacoesGerais}\r\n            onValueChange={(value) => updateFormData('observacoesGerais', value)}\r\n            onGenerateAI={() => generateWithAI('observacoesGerais')}\r\n          />\r\n        );\r\n      case 11:\r\n        return (\r\n          <FormStep\r\n            title=\"Conclus√£o T√©cnica\"\r\n            description=\"Parecer t√©cnico final sobre a contrata√ß√£o\"\r\n            value={formData.conclusaoTecnica}\r\n            onValueChange={(value) => updateFormData('conclusaoTecnica', value)}\r\n            onGenerateAI={() => generateWithAI('conclusaoTecnica')}\r\n          />\r\n        );\r\n      case 12:\r\n        return <SummaryStep formData={formData} onGeneratePDF={generatePDF} />;\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  const renderListView = (title: string, etps: any[], isCompleted: boolean) => {\r\n    const itemsPerPage = 5;\r\n    const currentPage = isCompleted ? completedPage : inProgressPage;\r\n    const setCurrentPage = isCompleted ? setCompletedPage : setInProgressPage;\r\n\r\n    const totalPages = Math.ceil(etps.length / itemsPerPage);\r\n    const startIndex = (currentPage - 1) * itemsPerPage;\r\n    const paginatedETPs = etps.slice(startIndex, startIndex + itemsPerPage);\r\n\r\n    const handlePageChange = (page: number) => {\r\n      setCurrentPage(page);\r\n    };\r\n\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">{title}</h1>\r\n            <p className=\"text-gray-600\">Lista de estudos t√©cnicos por status</p>\r\n          </div>\r\n          <Button variant=\"outline\" onClick={handleBackToDashboard}>\r\n            Voltar ao Painel\r\n          </Button>\r\n        </div>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"space-y-4\">\r\n              {paginatedETPs.map((etp) => (\r\n                <div\r\n                  key={etp.id}\r\n                  className=\"border rounded-lg p-4 hover:bg-gray-50 transition-colors\"\r\n                >\r\n                  <div className=\"flex items-start justify-between\">\r\n                    <div className=\"space-y-2 flex-1\">\r\n                      <h3 className=\"font-medium text-gray-900\">{etp.titulo}</h3>\r\n                      <p className=\"text-sm text-blue-600 font-medium\">{etp.numeroETP}</p>\r\n                      <div className=\"flex items-center space-x-4 text-sm text-gray-600\">\r\n                        <span>{etp.totalDFDs} DFD(s) vinculado(s)</span>\r\n                        <span>‚Ä¢</span>\r\n                        <span className=\"font-semibold\">{etp.valorTotal}</span>\r\n                      </div>\r\n                      {!isCompleted && etp.currentStep && (\r\n                        <div className=\"text-xs text-gray-500\">\r\n                          Progresso: Etapa {etp.currentStep + 1}/13\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex items-center space-x-2\">\r\n                      {isCompleted ? (\r\n                        <>\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleViewETP(etp)}\r\n                          >\r\n                            <FileText size={14} className=\"mr-1\" />\r\n                            Visualizar Documento\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                            onClick={() => handleGeneratePDF(etp)}\r\n                          >\r\n                            <Download size={14} className=\"mr-1\" />\r\n                            Gerar PDF\r\n                          </Button>\r\n                        </>\r\n                      ) : (\r\n                        <Button\r\n                          variant=\"outline\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleContinueETP(etp)}\r\n                          className=\"bg-orange-50 border-orange-200 text-orange-700 hover:bg-orange-100\"\r\n                        >\r\n                          Continuar Preenchimento\r\n                        </Button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n\r\n              {etps.length === 0 && (\r\n                <div className=\"text-center py-8\">\r\n                  <p className=\"text-gray-500\">Nenhum ETP encontrado.</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Pagina√ß√£o */}\r\n            {totalPages > 1 && (\r\n              <div className=\"mt-6\">\r\n                <DFDListPagination\r\n                  currentPage={currentPage}\r\n                  totalPages={totalPages}\r\n                  onPageChange={handlePageChange}\r\n                />\r\n              </div>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n\r\n        {/* ETP View Modal */}\r\n        <ETPViewModal\r\n          isOpen={viewModalOpen}\r\n          onClose={handleCloseViewModal}\r\n          etp={selectedETPForView}\r\n          onGeneratePDF={handleGeneratePDF}\r\n        />\r\n      </div>\r\n    );\r\n  };\r\n\r\n  // Dashboard view\r\n  if (viewMode === 'dashboard') {\r\n    return (\r\n      <ETPDashboard\r\n        etps={etps}\r\n        onCreateNew={handleCreateNew}\r\n        onViewETP={handleViewETP}\r\n        onViewCompleted={handleViewCompleted}\r\n        onViewInProgress={handleViewInProgress}\r\n        onContinueETP={handleContinueETP}\r\n        onGeneratePDF={handleGeneratePDF}\r\n      />\r\n    );\r\n  }\r\n\r\n  if (viewMode === 'completed') {\r\n    const completedETPs = etps.filter(e => e.status === 'Conclu√≠do');\r\n    return renderListView('ETPs Conclu√≠dos', completedETPs, true);\r\n  }\r\n\r\n  if (viewMode === 'inProgress') {\r\n    const inProgressETPs = etps.filter(e => e.status === 'Em Elabora√ß√£o');\r\n    return renderListView('ETPs em Andamento', inProgressETPs, false);\r\n  }\r\n\r\n  // Individual ETP view\r\n  if (viewMode === 'view' && selectedETP) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">{selectedETP.titulo}</h1>\r\n            <p className=\"text-gray-600\">{selectedETP.numeroETP}</p>\r\n          </div>\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Button variant=\"outline\" onClick={handleBackToDashboard}>\r\n              Voltar ao Painel\r\n            </Button>\r\n            <Button\r\n              variant=\"outline\"\r\n              onClick={() => handleGeneratePDF(selectedETP)}\r\n            >\r\n              <Download size={16} className=\"mr-2\" />\r\n              Gerar PDF\r\n            </Button>\r\n          </div>\r\n        </div>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-6\">\r\n            <div className=\"space-y-4\">\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-gray-700\">Status</label>\r\n                  <p className=\"text-sm text-gray-900\">{selectedETP.status}</p>\r\n                </div>\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-gray-700\">Valor Total</label>\r\n                  <p className=\"text-sm text-gray-900\">{selectedETP.valorTotal}</p>\r\n                </div>\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-gray-700\">DFDs Vinculados</label>\r\n                  <p className=\"text-sm text-gray-900\">{selectedETP.totalDFDs}</p>\r\n                </div>\r\n                <div>\r\n                  <label className=\"text-sm font-medium text-gray-700\">Respons√°vel</label>\r\n                  <p className=\"text-sm text-gray-900\">{selectedETP.responsavel}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Creation mode - existing ETP creation flow\r\n  const progress = ((currentStep + 1) / steps.length) * 100;\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">ETP - Estudo T√©cnico Preliminar</h1>\r\n          <p className=\"text-gray-600\">\r\n            Elabora√ß√£o dos estudos t√©cnicos para fundamentar as contrata√ß√µes\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Progress Bar */}\r\n      <Card>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-sm font-medium text-gray-700\">\r\n                Progresso: {currentStep + 1} de {steps.length}\r\n              </span>\r\n              <span className=\"text-sm text-gray-500\">{Math.round(progress)}% conclu√≠do</span>\r\n            </div>\r\n            <Progress value={progress} className=\"h-2\" />\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Steps Navigation */}\r\n      <Card>\r\n        <CardContent className=\"p-6\">\r\n          <div className=\"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-2\">\r\n            {steps.map((step) => (\r\n              <button\r\n                key={step.id}\r\n                onClick={() => setCurrentStep(step.id)}\r\n                className={`p-3 text-sm rounded-lg border transition-colors ${currentStep === step.id\r\n                  ? 'bg-orange-500 text-white border-orange-500'\r\n                  : step.id < currentStep\r\n                    ? 'bg-green-50 text-green-700 border-green-200'\r\n                    : 'bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100'\r\n                  }`}\r\n              >\r\n                <div className=\"font-medium\">{step.id + 1}</div>\r\n                <div className=\"text-xs mt-1\">{step.title}</div>\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Current Step Content */}\r\n      {renderCurrentStep()}\r\n\r\n      {/* Navigation Buttons */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <Button\r\n          variant=\"outline\"\r\n          onClick={prevStep}\r\n          disabled={currentStep === 0}\r\n        >\r\n          <ArrowLeft size={16} className=\"mr-2\" />\r\n          Anterior\r\n        </Button>\r\n        <Button\r\n          onClick={currentStep === steps.length - 1 ? async () => {\r\n            await saveETP();\r\n            setViewMode('dashboard');\r\n          } : nextStep}\r\n          disabled={!canProceed()}\r\n          className=\"bg-orange-500 hover:bg-orange-600\"\r\n        >\r\n          {currentStep === steps.length - 1 ? (\r\n            <>\r\n              <Save size={16} className=\"mr-2\" />\r\n              Concluir\r\n            </>\r\n          ) : (\r\n            <>\r\n              Pr√≥ximo\r\n              <ArrowRight size={16} className=\"ml-2\" />\r\n            </>\r\n          )}\r\n        </Button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ETP;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\pages\\Edital.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1342,1345],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1342,1345],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":185,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6313,6316],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6313,6316],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":201,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":201,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6660,6663],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6660,6663],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport {\r\n  Plus,\r\n  FileText,\r\n  Edit,\r\n  CheckCircle,\r\n  Globe,\r\n  Eye,\r\n  Download,\r\n  Filter,\r\n  Loader2,\r\n  Calendar\r\n} from 'lucide-react';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport {\r\n  Pagination,\r\n  PaginationContent,\r\n  PaginationItem,\r\n  PaginationLink,\r\n  PaginationNext,\r\n  PaginationPrevious,\r\n} from \"@/components/ui/pagination\";\r\nimport TRSelectionModal from '../components/Edital/TRSelectionModal';\r\nimport EditalWizard from '../components/Edital/EditalWizard';\r\nimport { editalService } from '@/services/editalService';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { DbEdital, DbTermoReferencia } from '@/types/database';\r\n\r\nconst Edital = () => {\r\n  const { user } = useAuth();\r\n  const [showSelectionModal, setShowSelectionModal] = useState(false);\r\n  const [showWizard, setShowWizard] = useState(false);\r\n  const [selectedTR, setSelectedTR] = useState<any>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [editaisData, setEditaisData] = useState<DbEdital[]>([]);\r\n  const [counts, setCounts] = useState({ total: 0, elaboracao: 0, concluidos: 0, publicados: 0 });\r\n  const [filters, setFilters] = useState({\r\n    secretaria: 'all',\r\n    status: 'all',\r\n    ano: '2025'\r\n  });\r\n  const [currentFilter, setCurrentFilter] = useState<string>('all');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const { toast } = useToast();\r\n  const itemsPerPage = 5;\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, [user?.prefeituraId]);\r\n\r\n  const loadData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const [list, stats] = await Promise.all([\r\n        editalService.fetchEditais(user?.prefeituraId || undefined),\r\n        editalService.getCountsByStatus(user?.prefeituraId || undefined)\r\n      ]);\r\n      setEditaisData(list);\r\n      setCounts(stats);\r\n    } catch (error) {\r\n      console.error('Erro ao carregar Editais:', error);\r\n      toast({\r\n        title: \"Erro ao carregar\",\r\n        description: \"N√£o foi poss√≠vel carregar os dados dos Editais.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const secretarias = [...new Set(editaisData.map(e => e.secretaria_id || 'N√£o informada'))];\r\n\r\n  const filteredEditais = editaisData.filter(edital => {\r\n    const matchesSecretaria = filters.secretaria === 'all' || edital.secretaria_id === filters.secretaria;\r\n    const matchesStatus = filters.status === 'all' || edital.status === filters.status;\r\n    const matchesAno = filters.ano === 'all' || (edital.created_at && edital.created_at.startsWith(filters.ano));\r\n\r\n    return matchesSecretaria && matchesStatus && matchesAno;\r\n  });\r\n\r\n  const statusFilteredEditais = filteredEditais.filter(edital => {\r\n    switch (currentFilter) {\r\n      case 'em-elaboracao':\r\n        return edital.status === 'Em Elabora√ß√£o' || edital.status === 'Rascunho';\r\n      case 'concluidos':\r\n        return edital.status === 'Conclu√≠do';\r\n      case 'publicados':\r\n        return edital.status === 'Publicado';\r\n      default:\r\n        return true;\r\n    }\r\n  });\r\n\r\n  const totalPages = Math.ceil(statusFilteredEditais.length / itemsPerPage);\r\n  const startIndex = (currentPage - 1) * itemsPerPage;\r\n  const paginatedEditais = statusFilteredEditais.slice(startIndex, startIndex + itemsPerPage);\r\n\r\n  const handleFilterChange = (filter: string) => {\r\n    setCurrentFilter(filter);\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const handlePageChange = (page: number) => {\r\n    setCurrentPage(page);\r\n  };\r\n\r\n  const updateFilter = (key: string, value: string) => {\r\n    setFilters(prev => ({ ...prev, [key]: value }));\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const formatCurrency = (value: number | null) => {\r\n    if (value === null) return 'R$ 0,00';\r\n    return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value);\r\n  };\r\n\r\n  const formatDate = (dateString: string | undefined) => {\r\n    if (!dateString) return '-';\r\n    return new Date(dateString).toLocaleDateString('pt-BR');\r\n  };\r\n\r\n  const getStatusBadge = (status: string | null) => {\r\n    switch (status) {\r\n      case 'Em Elabora√ß√£o':\r\n      case 'Rascunho':\r\n        return <Badge className=\"bg-yellow-100 text-yellow-800 border-yellow-200 shadow-sm\">Em Elabora√ß√£o</Badge>;\r\n      case 'Conclu√≠do':\r\n        return <Badge className=\"bg-green-100 text-green-800 border-green-200 shadow-sm\">Conclu√≠do</Badge>;\r\n      case 'Publicado':\r\n      case 'Publicado no PNCP':\r\n        return <Badge className=\"bg-blue-100 text-blue-800 border-blue-200 shadow-sm\">Publicado</Badge>;\r\n      default:\r\n        return <Badge variant=\"outline\">{status || 'N/A'}</Badge>;\r\n    }\r\n  };\r\n\r\n  const handleViewEdital = (edital: DbEdital) => {\r\n    toast({\r\n      title: \"Visualizando Edital\",\r\n      description: `Abrindo detalhes do edital: ${edital.numero_edital}`,\r\n    });\r\n  };\r\n\r\n  const handleEditEdital = (edital: DbEdital) => {\r\n    toast({\r\n      title: \"Editando Edital\",\r\n      description: `Abrindo editor para: ${edital.numero_edital}`,\r\n    });\r\n  };\r\n\r\n  const handleDownloadEdital = (edital: DbEdital) => {\r\n    toast({\r\n      title: \"Download iniciado\",\r\n      description: `Baixando edital: ${edital.numero_edital}`,\r\n    });\r\n  };\r\n\r\n  const handlePublishEdital = async (edital: DbEdital) => {\r\n    try {\r\n      setLoading(true);\r\n      await editalService.publishEdital(edital.id);\r\n      toast({\r\n        title: \"Publicado no PNCP\",\r\n        description: `Edital ${edital.numero_edital} publicado com sucesso.`,\r\n      });\r\n      loadData();\r\n    } catch (error) {\r\n      console.error('Erro ao publicar edital:', error);\r\n      toast({\r\n        title: \"Erro na publica√ß√£o\",\r\n        description: \"N√£o foi poss√≠vel publicar o edital no PNCP.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleTRSelect = (tr: any) => {\r\n    setSelectedTR(tr);\r\n    setShowSelectionModal(false);\r\n    setShowWizard(true);\r\n  };\r\n\r\n  const handleCloseSelectionModal = () => {\r\n    setShowSelectionModal(false);\r\n  };\r\n\r\n  const handleCloseWizard = () => {\r\n    setShowWizard(false);\r\n    setSelectedTR(null);\r\n    loadData();\r\n  };\r\n\r\n  const handleSaveEdital = (editalData: any) => {\r\n    toast({\r\n      title: \"Edital Salvo\",\r\n      description: \"Edital foi salvo com sucesso.\",\r\n    });\r\n    setShowWizard(false);\r\n    setSelectedTR(null);\r\n    loadData();\r\n  };\r\n\r\n  if (showWizard && selectedTR) {\r\n    return <EditalWizard selectedTR={selectedTR} onClose={handleCloseWizard} onSave={handleSaveEdital} />;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">Editais</h1>\r\n          <p className=\"text-gray-600 font-medium\">\r\n            Gerencie os editais de licita√ß√£o da prefeitura\r\n          </p>\r\n        </div>\r\n        <Button onClick={() => setShowSelectionModal(true)} className=\"bg-orange-500 hover:bg-orange-600 shadow-md\">\r\n          <Plus size={16} className=\"mr-2\" />\r\n          Novo Edital\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Statistics Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md border-b-4 ${currentFilter === 'all' ? 'border-b-blue-500 shadow-sm' : 'border-b-transparent hover:border-b-blue-200'\r\n            }`}\r\n          onClick={() => handleFilterChange('all')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-blue-50 rounded-lg\">\r\n                <FileText size={20} className=\"text-blue-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 font-bold uppercase\">Total</p>\r\n                <p className=\"text-xl font-black text-gray-900\">{counts.total}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md border-b-4 ${currentFilter === 'em-elaboracao' ? 'border-b-yellow-500 shadow-sm' : 'border-b-transparent hover:border-b-yellow-200'\r\n            }`}\r\n          onClick={() => handleFilterChange('em-elaboracao')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-yellow-50 rounded-lg\">\r\n                <Edit size={20} className=\"text-yellow-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 font-bold uppercase\">Em Elabora√ß√£o</p>\r\n                <p className=\"text-xl font-black text-gray-900\">{counts.elaboracao}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md border-b-4 ${currentFilter === 'concluidos' ? 'border-b-green-500 shadow-sm' : 'border-b-transparent hover:border-b-green-200'\r\n            }`}\r\n          onClick={() => handleFilterChange('concluidos')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-green-50 rounded-lg\">\r\n                <CheckCircle size={20} className=\"text-green-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 font-bold uppercase\">Conclu√≠dos</p>\r\n                <p className=\"text-xl font-black text-gray-900\">{counts.concluidos}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md border-b-4 ${currentFilter === 'publicados' ? 'border-b-purple-500 shadow-sm' : 'border-b-transparent hover:border-b-purple-200'\r\n            }`}\r\n          onClick={() => handleFilterChange('publicados')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-purple-50 rounded-lg\">\r\n                <Globe size={20} className=\"text-purple-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 font-bold uppercase\">Publicados</p>\r\n                <p className=\"text-xl font-black text-gray-900\">{counts.publicados}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <Card className=\"bg-gray-50/50 border-none shadow-sm\">\r\n        <CardContent className=\"p-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n            <div>\r\n              <label className=\"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1 block ml-1\">\r\n                Ano de Refer√™ncia\r\n              </label>\r\n              <Select value={filters.ano} onValueChange={(value) => updateFilter('ano', value)}>\r\n                <SelectTrigger className=\"bg-white\">\r\n                  <SelectValue placeholder=\"Selecione o ano\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">Todos os anos</SelectItem>\r\n                  <SelectItem value=\"2024\">2024</SelectItem>\r\n                  <SelectItem value=\"2025\">2025</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-1 block ml-1\">\r\n                Filtrar por Status\r\n              </label>\r\n              <Select value={filters.status} onValueChange={(value) => updateFilter('status', value)}>\r\n                <SelectTrigger className=\"bg-white\">\r\n                  <SelectValue placeholder=\"Todos os status\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">Todos os status</SelectItem>\r\n                  <SelectItem value=\"Em Elabora√ß√£o\">Em Elabora√ß√£o</SelectItem>\r\n                  <SelectItem value=\"Conclu√≠do\">Conclu√≠do</SelectItem>\r\n                  <SelectItem value=\"Publicado\">Publicado</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n\r\n            <div className=\"flex items-end\">\r\n              <Button variant=\"outline\" onClick={() => { setFilters({ secretaria: 'all', status: 'all', ano: '2025' }); setCurrentFilter('all'); }} className=\"w-full bg-white\">\r\n                Limpar Filtros\r\n              </Button>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Editais List */}\r\n      <Card className=\"shadow-sm border-gray-100 overflow-hidden\">\r\n        <CardHeader className=\"bg-white pb-2 flex flex-row items-center justify-between border-b\">\r\n          <CardTitle className=\"text-lg font-bold flex items-center space-x-2\">\r\n            <FileText size={20} className=\"text-orange-500\" />\r\n            <span>Documentos ({statusFilteredEditais.length})</span>\r\n          </CardTitle>\r\n          {loading && <Loader2 className=\"w-5 h-5 animate-spin text-orange-500\" />}\r\n        </CardHeader>\r\n        <CardContent className=\"p-0\">\r\n          {loading ? (\r\n            <div className=\"py-20 text-center\">\r\n              <Loader2 className=\"w-10 h-10 animate-spin mx-auto mb-4 text-orange-500\" />\r\n              <p className=\"text-gray-500\">Buscando editais...</p>\r\n            </div>\r\n          ) : statusFilteredEditais.length === 0 ? (\r\n            <div className=\"text-center py-20 bg-gray-50/20\">\r\n              <FileText size={48} className=\"mx-auto text-gray-200 mb-4\" />\r\n              <p className=\"text-gray-500 font-medium font-bold\">\r\n                Nenhum edital encontrado.\r\n              </p>\r\n              <Button variant=\"outline\" size=\"sm\" className=\"mt-4\" onClick={() => setShowSelectionModal(true)}>\r\n                Criar Novo Edital\r\n              </Button>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              <div className=\"overflow-x-auto\">\r\n                <Table>\r\n                  <TableHeader className=\"bg-gray-50\">\r\n                    <TableRow>\r\n                      <TableHead className=\"font-bold\">N√∫mero / Data</TableHead>\r\n                      <TableHead className=\"font-bold\">Objeto / Modalidade</TableHead>\r\n                      <TableHead className=\"font-bold text-center\">Valor Estimado</TableHead>\r\n                      <TableHead className=\"font-bold text-center\">Status</TableHead>\r\n                      <TableHead className=\"font-bold text-right\">A√á√ïES</TableHead>\r\n                    </TableRow>\r\n                  </TableHeader>\r\n                  <TableBody>\r\n                    {paginatedEditais.map((edital) => (\r\n                      <TableRow key={edital.id} className=\"hover:bg-gray-50/50 transition-colors\">\r\n                        <TableCell>\r\n                          <div className=\"font-black text-blue-600 text-sm\">{edital.numero_edital || 'S/N'}</div>\r\n                          <div className=\"text-[10px] text-gray-500 font-bold uppercase flex items-center mt-1\">\r\n                            <Calendar size={10} className=\"mr-1\" />\r\n                            {formatDate(edital.created_at)}\r\n                          </div>\r\n                        </TableCell>\r\n                        <TableCell className=\"max-w-md\">\r\n                          <div className=\"font-bold text-gray-900 text-sm line-clamp-1\">{edital.objeto}</div>\r\n                          <div className=\"text-[10px] text-gray-400 font-black uppercase mt-1\">{edital.modalidade}</div>\r\n                        </TableCell>\r\n                        <TableCell className=\"text-center\">\r\n                          <div className=\"font-black text-gray-900 border-l-4 border-l-green-500 pl-2 inline-block\">\r\n                            {formatCurrency(edital.valor_estimado)}\r\n                          </div>\r\n                        </TableCell>\r\n                        <TableCell className=\"text-center\">\r\n                          {getStatusBadge(edital.status)}\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <div className=\"flex items-center justify-end gap-2\">\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleViewEdital(edital)}\r\n                              className=\"h-8 w-8 p-0\"\r\n                              title=\"Ver\"\r\n                            >\r\n                              <Eye size={16} className=\"text-gray-400\" />\r\n                            </Button>\r\n\r\n                            {(edital.status === 'Em Elabora√ß√£o' || edital.status === 'Rascunho') && (\r\n                              <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleEditEdital(edital)}\r\n                                className=\"h-8 w-8 p-0\"\r\n                                title=\"Editar\"\r\n                              >\r\n                                <Edit size={16} className=\"text-orange-500\" />\r\n                              </Button>\r\n                            )}\r\n\r\n                            {edital.status === 'Conclu√≠do' && (\r\n                              <div className=\"flex items-center gap-1\">\r\n                                <Button\r\n                                  variant=\"ghost\"\r\n                                  size=\"sm\"\r\n                                  onClick={() => handleDownloadEdital(edital)}\r\n                                  className=\"h-8 w-8 p-0\"\r\n                                  title=\"Baixar PDF\"\r\n                                >\r\n                                  <Download size={16} className=\"text-green-600\" />\r\n                                </Button>\r\n                                <Button\r\n                                  variant=\"ghost\"\r\n                                  size=\"sm\"\r\n                                  onClick={() => handlePublishEdital(edital)}\r\n                                  className=\"h-8 w-8 p-0 text-purple-600\"\r\n                                  title=\"Publicar no PNCP\"\r\n                                >\r\n                                  <Globe size={16} />\r\n                                </Button>\r\n                              </div>\r\n                            )}\r\n\r\n                            {(edital.status === 'Publicado' || edital.status === 'Publicado no PNCP') && (\r\n                              <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleDownloadEdital(edital)}\r\n                                className=\"h-8 w-8 p-0\"\r\n                                title=\"Baixar PDF\"\r\n                              >\r\n                                <Download size={16} className=\"text-blue-600\" />\r\n                              </Button>\r\n                            )}\r\n                          </div>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    ))}\r\n                  </TableBody>\r\n                </Table>\r\n              </div>\r\n\r\n              {/* Pagination */}\r\n              {totalPages > 1 && (\r\n                <div className=\"py-4 border-t px-6 flex items-center justify-between bg-white\">\r\n                  <p className=\"text-[10px] font-bold text-gray-400 uppercase\">\r\n                    Mostrando {startIndex + 1}-{Math.min(startIndex + itemsPerPage, statusFilteredEditais.length)} de {statusFilteredEditais.length}\r\n                  </p>\r\n                  <Pagination className=\"w-auto\">\r\n                    <PaginationContent>\r\n                      <PaginationItem>\r\n                        <PaginationPrevious\r\n                          onClick={() => handlePageChange(Math.max(1, currentPage - 1))}\r\n                          className={currentPage === 1 ? 'pointer-events-none opacity-50 text-[10px]' : 'cursor-pointer text-[10px]'}\r\n                        />\r\n                      </PaginationItem>\r\n\r\n                      {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\r\n                        <PaginationItem key={page} className=\"hidden md:block\">\r\n                          <PaginationLink\r\n                            onClick={() => handlePageChange(page)}\r\n                            isActive={currentPage === page}\r\n                            className=\"cursor-pointer h-8 w-8 text-xs\"\r\n                          >\r\n                            {page}\r\n                          </PaginationLink>\r\n                        </PaginationItem>\r\n                      ))}\r\n\r\n                      <PaginationItem>\r\n                        <PaginationNext\r\n                          onClick={() => handlePageChange(Math.min(totalPages, currentPage + 1))}\r\n                          className={currentPage === totalPages ? 'pointer-events-none opacity-50 text-[10px]' : 'cursor-pointer text-[10px]'}\r\n                        />\r\n                      </PaginationItem>\r\n                    </PaginationContent>\r\n                  </Pagination>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {showSelectionModal && (\r\n        <TRSelectionModal\r\n          onClose={handleCloseSelectionModal}\r\n          onSelect={handleTRSelect}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Edital;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\pages\\GerenciarUsuarios.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":165,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5073,5076],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5073,5076],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter } from '@/components/ui/dialog';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Separator } from '@/components/ui/separator';\r\nimport { cn } from '@/lib/utils';\r\nimport { generateRandomPassword } from '@/utils/auth';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport {\r\n  Users,\r\n  UserPlus,\r\n  Search,\r\n  Shield,\r\n  Edit,\r\n  Key,\r\n  Trash2,\r\n  AlertTriangle\r\n} from 'lucide-react';\r\nimport {\r\n  User,\r\n  ModulePermissions,\r\n  roleLabels,\r\n  moduleLabels,\r\n  defaultPermissionsByRole\r\n} from '@/types/auth';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { zodResolver } from '@hookform/resolvers/zod';\r\nimport { userSchema, UserFormData } from '@/schemas/auth';\r\n\r\n\r\n// M√≥dulos que podem ser configurados para operadores\r\nconst configurableModules: (keyof ModulePermissions)[] = [\r\n  'dfd',\r\n  'pca',\r\n  'etp',\r\n  'mapaRiscos',\r\n  'cronograma',\r\n  'termoReferencia',\r\n  'edital',\r\n];\r\n\r\nconst GerenciarUsuarios = () => {\r\n  const {\r\n    toast\r\n  } = useToast();\r\n  const {\r\n    getCurrentUser,\r\n    getUsersForPrefeitura,\r\n    createUser,\r\n    updateUser,\r\n    deleteUser,\r\n    getPrefeituraById,\r\n    getAllPrefeituras,\r\n    getSecretariasForPrefeitura,\r\n    isAdmin,\r\n    isSuperAdmin,\r\n    getAllUsers\r\n  } = useAuth();\r\n\r\n  const currentUser = getCurrentUser();\r\n  const prefeituraId = currentUser?.prefeituraId;\r\n  const prefeitura = prefeituraId ? getPrefeituraById(prefeituraId) : null;\r\n  const prefeiturasDisponiveis = getAllPrefeituras().filter(p => p.status === 'ativa');\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [showUserModal, setShowUserModal] = useState(false);\r\n  const [editingUser, setEditingUser] = useState<User | null>(null);\r\n\r\n  const { register, handleSubmit, control, reset, setValue, watch, formState: { errors } } = useForm<UserFormData>({\r\n    resolver: zodResolver(userSchema),\r\n    defaultValues: {\r\n      nome: '',\r\n      email: '',\r\n      password: '',\r\n      role: 'operator',\r\n      prefeituraId: '',\r\n      secretariaId: '',\r\n      permissions: { ...defaultPermissionsByRole.operator },\r\n      status: 'ativo',\r\n    }\r\n  });\r\n\r\n  const formData = watch(); // Para manter compatibilidade tempor√°ria com o resto do c√≥digo que usa formData\r\n\r\n  const secretariasDisponiveis = formData.prefeituraId\r\n    ? getSecretariasForPrefeitura(formData.prefeituraId)\r\n    : [];\r\n\r\n  // Busca usu√°rios\r\n  const users = isSuperAdmin()\r\n    ? getAllUsers().filter(u => u.id !== currentUser?.id)\r\n    : (prefeituraId ? getUsersForPrefeitura(prefeituraId).filter(u => u.id !== currentUser?.id) : []);\r\n\r\n  const filteredUsers = users.filter(u =>\r\n    u.nome.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n    u.email.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const resetForm = () => {\r\n    reset({\r\n      nome: '',\r\n      email: '',\r\n      password: '',\r\n      role: 'operator',\r\n      prefeituraId: currentUser?.prefeituraId || '',\r\n      secretariaId: currentUser?.secretariaId || '',\r\n      permissions: { ...defaultPermissionsByRole.operator },\r\n      status: 'ativo',\r\n    });\r\n    setEditingUser(null);\r\n  };\r\n\r\n  const handleOpenModal = (user?: User) => {\r\n    if (user) {\r\n      setEditingUser(user);\r\n      reset({\r\n        nome: user.nome,\r\n        email: user.email,\r\n        password: '',\r\n        role: user.role,\r\n        prefeituraId: user.prefeituraId || '',\r\n        secretariaId: user.secretariaId || '',\r\n        permissions: { ...user.permissions },\r\n        status: user.status,\r\n      });\r\n    } else {\r\n      resetForm();\r\n    }\r\n    setShowUserModal(true);\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setShowUserModal(false);\r\n    resetForm();\r\n  };\r\n\r\n  const handleRoleChange = (role: 'admin' | 'operator') => {\r\n    setValue('role', role);\r\n    setValue('permissions', role === 'admin'\r\n      ? { ...defaultPermissionsByRole.admin }\r\n      : { ...defaultPermissionsByRole.operator }\r\n    );\r\n  };\r\n\r\n  const handleGeneratePassword = () => {\r\n    const newPassword = generateRandomPassword();\r\n    setValue('password', newPassword);\r\n    toast({\r\n      title: \"Senha Gerada\",\r\n      description: `A nova senha √©: ${newPassword}`,\r\n    });\r\n  };\r\n\r\n  const handlePermissionToggle = (module: keyof ModulePermissions) => {\r\n    const currentPermissions = form.getValues('permissions');\r\n    setValue(`permissions.${module}`, !currentPermissions[module]);\r\n  };\r\n\r\n  const form = { getValues: (key: any) => watch(key) }; // Mock para compatibilidade tempor√°ria\r\n\r\n\r\n  const onSubmit = async (data: UserFormData) => {\r\n    let success = false;\r\n    if (editingUser) {\r\n      success = await updateUser(editingUser.id, {\r\n        nome: data.nome,\r\n        email: data.email,\r\n        role: data.role,\r\n        prefeituraId: data.prefeituraId,\r\n        secretariaId: data.secretariaId,\r\n        permissions: data.permissions,\r\n        status: data.status,\r\n      });\r\n    } else {\r\n      const newUser = await createUser({\r\n        nome: data.nome,\r\n        email: data.email,\r\n        role: data.role,\r\n        prefeituraId: data.prefeituraId,\r\n        secretariaId: data.secretariaId,\r\n        permissions: data.permissions,\r\n        status: data.status,\r\n      }, data.password);\r\n      success = !!newUser;\r\n    }\r\n\r\n    if (success) {\r\n      handleCloseModal();\r\n    }\r\n  };\r\n\r\n  const handleDeleteUser = (userId: string) => {\r\n    deleteUser(userId);\r\n  };\r\n\r\n  const handleResetPassword = (user: User) => {\r\n    toast({\r\n      title: \"Senha redefinida\",\r\n      description: `Nova senha enviada para ${user.email}`,\r\n    });\r\n  };\r\n\r\n  const getActivePermissionsCount = (permissions: ModulePermissions) => {\r\n    if (!permissions) return 0;\r\n    return configurableModules.filter(m => permissions[m]).length;\r\n  };\r\n\r\n  if (!isAdmin() && !isSuperAdmin()) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-96\">\r\n        <Card className=\"p-8 text-center\">\r\n          <Shield className=\"mx-auto text-gray-400 mb-4\" size={48} />\r\n          <h2 className=\"text-xl font-semibold mb-2\">Acesso Restrito</h2>\r\n          <p className=\"text-muted-foreground\">\r\n            Voc√™ n√£o tem permiss√£o para acessar esta p√°gina.\r\n          </p>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold flex items-center gap-2\">\r\n            <Users className=\"text-orange-500\" />\r\n            Gerenciar Usu√°rios\r\n          </h1>\r\n          <p className=\"text-muted-foreground\">\r\n            {prefeitura ? prefeitura.nome : 'Gerencie os usu√°rios da sua organiza√ß√£o'}\r\n          </p>\r\n        </div>\r\n        <Button onClick={() => handleOpenModal()}>\r\n          <UserPlus size={16} className=\"mr-2\" />\r\n          Novo Usu√°rio\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Stats */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">Total de Usu√°rios</p>\r\n                <p className=\"text-3xl font-bold\">{users.length}</p>\r\n              </div>\r\n              <Users className=\"h-8 w-8 text-orange-500\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">Administradores</p>\r\n                <p className=\"text-3xl font-bold text-blue-600\">\r\n                  {users.filter(u => u.role === 'admin').length}\r\n                </p>\r\n              </div>\r\n              <Shield className=\"h-8 w-8 text-blue-500\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card>\r\n          <CardContent className=\"pt-6\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-muted-foreground\">Operadores</p>\r\n                <p className=\"text-3xl font-bold text-green-600\">\r\n                  {users.filter(u => u.role === 'operator').length}\r\n                </p>\r\n              </div>\r\n              <Users className=\"h-8 w-8 text-green-500\" />\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Search */}\r\n      <div className=\"relative max-w-md\">\r\n        <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" size={18} />\r\n        <Input\r\n          placeholder=\"Buscar por nome ou email...\"\r\n          value={searchTerm}\r\n          onChange={(e) => setSearchTerm(e.target.value)}\r\n          className=\"pl-10\"\r\n        />\r\n      </div>\r\n\r\n      {/* Users Table */}\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>Usu√°rios Cadastrados</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          {filteredUsers.length === 0 ? (\r\n            <div className=\"text-center py-12 text-muted-foreground\">\r\n              <Users className=\"mx-auto mb-4 text-gray-300\" size={48} />\r\n              <p>Nenhum usu√°rio encontrado</p>\r\n              <Button variant=\"link\" onClick={() => handleOpenModal()}>\r\n                Cadastrar primeiro usu√°rio\r\n              </Button>\r\n            </div>\r\n          ) : (\r\n            <Table>\r\n              <TableHeader>\r\n                <TableRow>\r\n                  <TableHead>Nome</TableHead>\r\n                  <TableHead>Email</TableHead>\r\n                  <TableHead>Perfil</TableHead>\r\n                  <TableHead>M√≥dulos</TableHead>\r\n                  <TableHead>Status</TableHead>\r\n                  <TableHead className=\"text-right\">A√ß√µes</TableHead>\r\n                </TableRow>\r\n              </TableHeader>\r\n              <TableBody>\r\n                {filteredUsers.map((user) => (\r\n                  <TableRow key={user.id}>\r\n                    <TableCell className=\"font-medium\">{user.nome}</TableCell>\r\n                    <TableCell>{user.email}</TableCell>\r\n                    <TableCell>\r\n                      <Badge variant={user.role === 'admin' ? 'default' : 'secondary'}>\r\n                        {roleLabels[user.role]}\r\n                      </Badge>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <div className=\"flex flex-wrap gap-1\">\r\n                        {user.role === 'admin' ? (\r\n                          <Badge variant=\"outline\" className=\"text-xs\">Acesso Total</Badge>\r\n                        ) : (\r\n                          <Badge variant=\"outline\" className=\"text-xs\">\r\n                            {getActivePermissionsCount(user.permissions)} m√≥dulo(s)\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    </TableCell>\r\n                    <TableCell>\r\n                      <Badge\r\n                        variant=\"outline\"\r\n                        className={cn(\r\n                          user.status === 'ativo'\r\n                            ? 'text-green-600 border-green-300 bg-green-50'\r\n                            : 'text-gray-500 border-gray-300 bg-gray-50'\r\n                        )}\r\n                      >\r\n                        {user.status === 'ativo' ? 'Ativo' : 'Inativo'}\r\n                      </Badge>\r\n                    </TableCell>\r\n                    <TableCell className=\"text-right\">\r\n                      <div className=\"flex justify-end gap-1\">\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleOpenModal(user)}\r\n                          title=\"Editar\"\r\n                        >\r\n                          <Edit size={14} />\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleResetPassword(user)}\r\n                          title=\"Redefinir senha\"\r\n                        >\r\n                          <Key size={14} />\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"ghost\"\r\n                          size=\"sm\"\r\n                          onClick={() => handleDeleteUser(user.id)}\r\n                          title=\"Excluir\"\r\n                          className=\"text-red-600 hover:text-red-700 hover:bg-red-50\"\r\n                        >\r\n                          <Trash2 size={14} />\r\n                        </Button>\r\n                      </div>\r\n                    </TableCell>\r\n                  </TableRow>\r\n                ))}\r\n              </TableBody>\r\n            </Table>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* User Modal */}\r\n      <Dialog open={showUserModal} onOpenChange={setShowUserModal}>\r\n        <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\">\r\n          <DialogHeader>\r\n            <DialogTitle className=\"flex items-center gap-2\">\r\n              {editingUser ? <Edit size={20} /> : <UserPlus size={20} />}\r\n              {editingUser ? 'Editar Usu√°rio' : 'Novo Usu√°rio'}\r\n            </DialogTitle>\r\n          </DialogHeader>\r\n\r\n          <form onSubmit={handleSubmit(onSubmit)}>\r\n            <div className=\"space-y-6 py-4\">\r\n              {/* Basic Info */}\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"nome\">Nome Completo *</Label>\r\n                  <Input\r\n                    id=\"nome\"\r\n                    {...register('nome')}\r\n                    placeholder=\"Ex: Jo√£o da Silva\"\r\n                  />\r\n                  {errors.nome && <span className=\"text-sm text-red-500\">{errors.nome.message}</span>}\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label htmlFor=\"email\">Email *</Label>\r\n                  <Input\r\n                    id=\"email\"\r\n                    type=\"email\"\r\n                    {...register('email')}\r\n                    placeholder=\"Ex: joao@prefeitura.gov.br\"\r\n                  />\r\n                  {errors.email && <span className=\"text-sm text-red-500\">{errors.email.message}</span>}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Role & Status & Password */}\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>Perfil de Acesso</Label>\r\n                  <Controller\r\n                    name=\"role\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <Select onValueChange={(val) => {\r\n                        field.onChange(val);\r\n                        handleRoleChange(val as 'admin' | 'operator');\r\n                      }} value={field.value}>\r\n                        <SelectTrigger className=\"w-full text-slate-900\">\r\n                          <SelectValue />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"admin\">Administrador</SelectItem>\r\n                          <SelectItem value=\"operator\">Operador</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    )}\r\n                  />\r\n                  {errors.role && <span className=\"text-sm text-red-500\">{errors.role.message}</span>}\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label>Status</Label>\r\n                  <Controller\r\n                    name=\"status\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <Select onValueChange={field.onChange} value={field.value}>\r\n                        <SelectTrigger className=\"w-full text-slate-900\">\r\n                          <SelectValue />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          <SelectItem value=\"ativo\">Ativo</SelectItem>\r\n                          <SelectItem value=\"inativo\">Inativo</SelectItem>\r\n                        </SelectContent>\r\n                      </Select>\r\n                    )}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              {!editingUser && (\r\n                <div className=\"grid grid-cols-2 gap-4 items-end\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"password\">Senha Tempor√°ria</Label>\r\n                    <Input\r\n                      id=\"password\"\r\n                      {...register('password')}\r\n                      placeholder=\"Senha do usu√°rio\"\r\n                    />\r\n                  </div>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    type=\"button\"\r\n                    onClick={handleGeneratePassword}\r\n                    className=\"gap-2\"\r\n                  >\r\n                    <Key size={16} />\r\n                    Gerar Senha\r\n                  </Button>\r\n                </div>\r\n              )}\r\n\r\n\r\n              {/* Prefeitura & Secretaria Selection */}\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>Prefeitura *</Label>\r\n                  <Controller\r\n                    name=\"prefeituraId\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <Select\r\n                        value={field.value}\r\n                        onValueChange={(v) => {\r\n                          field.onChange(v);\r\n                          setValue('secretariaId', ''); // Limpa secretaria ao mudar prefeitura\r\n                        }}\r\n                      >\r\n                        <SelectTrigger className=\"w-full text-slate-900\">\r\n                          <SelectValue placeholder=\"Selecione uma prefeitura\" />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          {prefeiturasDisponiveis.map(p => (\r\n                            <SelectItem key={p.id} value={p.id}>{p.nome}</SelectItem>\r\n                          ))}\r\n                        </SelectContent>\r\n                      </Select>\r\n                    )}\r\n                  />\r\n                  {errors.prefeituraId && <span className=\"text-sm text-red-500\">{errors.prefeituraId.message}</span>}\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label>Secretaria *</Label>\r\n                  <Controller\r\n                    name=\"secretariaId\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <Select\r\n                        value={field.value}\r\n                        onValueChange={field.onChange}\r\n                        disabled={!watch('prefeituraId')}\r\n                      >\r\n                        <SelectTrigger className=\"w-full text-slate-900\">\r\n                          <SelectValue placeholder={watch('prefeituraId') ? \"Selecione uma secretaria\" : \"Selecione a prefeitura primeiro\"} />\r\n                        </SelectTrigger>\r\n                        <SelectContent>\r\n                          {secretariasDisponiveis.map(s => (\r\n                            <SelectItem key={s.id} value={s.id}>{s.nome}</SelectItem>\r\n                          ))}\r\n                        </SelectContent>\r\n                      </Select>\r\n                    )}\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <Separator />\r\n\r\n              {/* Permissions (only for operators) */}\r\n              {watch('role') === 'operator' && (\r\n                <div className=\"space-y-4\">\r\n                  <div>\r\n                    <Label className=\"text-base font-semibold\">Permiss√µes de M√≥dulos</Label>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                      Selecione quais m√≥dulos este usu√°rio poder√° acessar\r\n                    </p>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-2 gap-3\">\r\n                    {configurableModules.map((module) => (\r\n                      <div\r\n                        key={module}\r\n                        className={cn(\r\n                          \"flex items-center justify-between p-3 rounded-lg border transition-colors\",\r\n                          watch(`permissions.${module}`)\r\n                            ? \"bg-orange-50 border-orange-200\"\r\n                            : \"bg-gray-50 border-gray-200\"\r\n                        )}\r\n                      >\r\n                        <Label\r\n                          htmlFor={module}\r\n                          className=\"cursor-pointer flex-1\"\r\n                        >\r\n                          {moduleLabels[module]}\r\n                        </Label>\r\n                        <Switch\r\n                          id={module}\r\n                          checked={watch(`permissions.${module}`)}\r\n                          onCheckedChange={() => handlePermissionToggle(module)}\r\n                        />\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {watch('role') === 'admin' && (\r\n                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\r\n                  <p className=\"text-sm text-blue-800\">\r\n                    <strong>Administradores</strong> t√™m acesso completo a todos os m√≥dulos do sistema,\r\n                    incluindo a gest√£o de usu√°rios da organiza√ß√£o.\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <DialogFooter>\r\n              <Button type=\"button\" variant=\"outline\" onClick={handleCloseModal}>\r\n                Cancelar\r\n              </Button>\r\n              <Button type=\"submit\">\r\n                {editingUser ? 'Salvar Altera√ß√µes' : 'Cadastrar Usu√°rio'}\r\n              </Button>\r\n            </DialogFooter>\r\n          </form>\r\n        </DialogContent>\r\n      </Dialog>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default GerenciarUsuarios;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\pages\\MapaRiscos.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":35,"column":11,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":35,"endColumn":16,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[1391,1435],"text":"type Risco = DbMapaRiscosItem"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport {\r\n  Plus,\r\n  Sparkles,\r\n  Save,\r\n  Trash2,\r\n  Edit,\r\n  AlertTriangle,\r\n  Shield,\r\n  Target,\r\n  FileText,\r\n  ArrowLeft,\r\n  Eye,\r\n  Download\r\n} from 'lucide-react';\r\nimport ETPSelectionModal from '../components/MapaRiscos/ETPSelectionModal';\r\nimport MapaRiscosCards from '../components/MapaRiscos/MapaRiscosCards';\r\nimport MapaRiscosOverviewCards from '../components/MapaRiscos/MapaRiscosOverviewCards';\r\nimport MapaRiscosPreview from '../components/MapaRiscos/MapaRiscosPreview';\r\nimport AIRiskSuggestions from '../components/MapaRiscos/AIRiskSuggestions';\r\nimport ETPSummaryCard from '../components/MapaRiscos/ETPSummaryCard';\r\nimport { mapaRiscosService } from '@/services/mapaRiscosService';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { DbMapaRiscos, DbMapaRiscosItem } from '@/types/database';\r\n\r\n// Tipos auxiliares corrigidos\r\ninterface Risco extends DbMapaRiscosItem { }\r\ninterface MapaRisco extends DbMapaRiscos {\r\n  totalRiscos?: number;\r\n}\r\n\r\ninterface ETP {\r\n  id: string;\r\n  titulo: string;\r\n  numeroETP: string;\r\n  secretaria: string;\r\n  dataCriacao: string;\r\n  valorTotal: string;\r\n  descricaoDemanda: string;\r\n  status: string;\r\n}\r\n\r\ninterface DFD {\r\n  id: string;\r\n  numero: string;\r\n  nome: string;\r\n  valor: string;\r\n  tipo: string;\r\n}\r\n\r\nconst MapaRiscos = () => {\r\n  const [step, setStep] = useState<'overview' | 'list-concluidos' | 'list-elaboracao' | 'select-etp' | 'create-risks'>('overview');\r\n  const [selectedETP, setSelectedETP] = useState<ETP | null>(null);\r\n  const [etpSelectionOpen, setEtpSelectionOpen] = useState(false);\r\n  const [previewOpen, setPreviewOpen] = useState(false);\r\n  const [aiSuggestionsOpen, setAiSuggestionsOpen] = useState(false);\r\n  const [currentMapaId, setCurrentMapaId] = useState<string | null>(null);\r\n\r\n  const [etpDFDs, setEtpDFDs] = useState<DFD[]>([]);\r\n  const [riscos, setRiscos] = useState<Risco[]>([]);\r\n  const [mapas, setMapas] = useState<MapaRisco[]>([]);\r\n  const [counts, setCounts] = useState({ concluidos: 0, elaboracao: 0, total: 0 });\r\n\r\n  const [showForm, setShowForm] = useState(false);\r\n  const [editingRisk, setEditingRisk] = useState<Risco | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n\r\n  const [formData, setFormData] = useState({\r\n    categoria: '',\r\n    descricao: '',\r\n    causaProvavel: '',\r\n    consequencia: '',\r\n    probabilidade: '',\r\n    impacto: '',\r\n    mitigacao: '',\r\n    planoContingencia: '',\r\n    responsavel: ''\r\n  });\r\n\r\n  const categorias = ['T√©cnico', 'Or√ßament√°rio', 'Operacional', 'Legal', 'Ambiental', 'Cronograma', 'Jur√≠dico', 'Log√≠stico'];\r\n  const niveis = ['Baixa', 'M√©dia', 'Alta'];\r\n\r\n  const calcularNivel = (probabilidade: string, impacto: string) => {\r\n    const matriz = {\r\n      'Baixa': { 'Baixo': 'Baixo', 'M√©dio': 'Baixo', 'Alto': 'M√©dio' },\r\n      'M√©dia': { 'Baixo': 'Baixo', 'M√©dio': 'M√©dio', 'Alto': 'Alto' },\r\n      'Alta': { 'Baixo': 'M√©dio', 'M√©dio': 'Alto', 'Alto': 'Alto' }\r\n    };\r\n    return matriz[probabilidade as keyof typeof matriz]?.[impacto as keyof typeof matriz['Baixa']] || 'Baixo';\r\n  };\r\n\r\n  const getNivelColor = (nivel: string) => {\r\n    switch (nivel) {\r\n      case 'Alto':\r\n        return 'bg-red-100 text-red-800';\r\n      case 'M√©dio':\r\n        return 'bg-yellow-100 text-yellow-800';\r\n      case 'Baixo':\r\n        return 'bg-green-100 text-green-800';\r\n      default:\r\n        return 'bg-gray-100 text-gray-800';\r\n    }\r\n  };\r\n\r\n  const getCategoriaColor = (categoria: string) => {\r\n    const colors = {\r\n      'T√©cnico': 'bg-blue-100 text-blue-800',\r\n      'Or√ßament√°rio': 'bg-purple-100 text-purple-800',\r\n      'Operacional': 'bg-orange-100 text-orange-800',\r\n      'Legal': 'bg-gray-100 text-gray-800',\r\n      'Ambiental': 'bg-green-100 text-green-800',\r\n      'Cronograma': 'bg-pink-100 text-pink-800',\r\n      'Jur√≠dico': 'bg-indigo-100 text-indigo-800',\r\n      'Log√≠stico': 'bg-cyan-100 text-cyan-800'\r\n    };\r\n    return colors[categoria as keyof typeof colors] || 'bg-gray-100 text-gray-800';\r\n  };\r\n\r\n  useEffect(() => {\r\n    loadOverviewData();\r\n  }, [user?.prefeituraId]);\r\n\r\n  const loadOverviewData = async () => {\r\n    try {\r\n      const countsData = await mapaRiscosService.getCountsByStatus(user?.prefeituraId || undefined);\r\n      setCounts(countsData);\r\n    } catch (error) {\r\n      console.error('Erro ao carregar dashboard de riscos:', error);\r\n    }\r\n  };\r\n\r\n  const loadMapas = async (status?: 'concluido' | 'elaboracao') => {\r\n    try {\r\n      setLoading(true);\r\n      const data = await mapaRiscosService.fetchMapasRiscos(user?.prefeituraId || undefined);\r\n      if (status) {\r\n        setMapas(data.filter(m => m.status === status));\r\n      } else {\r\n        setMapas(data);\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao carregar mapas:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const loadMapaFull = async (id: string) => {\r\n    try {\r\n      setLoading(true);\r\n      const data = await mapaRiscosService.fetchMapaRisco(id);\r\n      setCurrentMapaId(data.id);\r\n      setRiscos(data.mapa_riscos_itens || []);\r\n      if (data.etp_id) {\r\n        setSelectedETP({\r\n          id: data.etp_id,\r\n          titulo: data.etp_titulo || '',\r\n          numeroETP: data.etp_numero || '',\r\n          secretaria: data.secretaria || '',\r\n          dataCriacao: '',\r\n          valorTotal: '',\r\n          descricaoDemanda: '',\r\n          status: 'concluido'\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao carregar detalhes do mapa:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleViewConcluidos = () => {\r\n    loadMapas('concluido');\r\n    setStep('list-concluidos');\r\n  };\r\n\r\n  const handleViewElaboracao = () => {\r\n    loadMapas('elaboracao');\r\n    setStep('list-elaboracao');\r\n  };\r\n\r\n  const handleBackToOverview = () => {\r\n    loadOverviewData();\r\n    setStep('overview');\r\n    setSelectedETP(null);\r\n    setCurrentMapaId(null);\r\n    setRiscos([]);\r\n    setEtpDFDs([]);\r\n  };\r\n\r\n  const handleSelectETP = (etp: ETP) => {\r\n    setSelectedETP(etp);\r\n    setStep('create-risks');\r\n    setEtpSelectionOpen(false);\r\n    toast({\r\n      title: \"ETP Selecionado\",\r\n      description: `Mapa de Riscos ser√° criado para o ${etp.numeroETP}.`,\r\n    });\r\n  };\r\n\r\n  const handleStartNewMap = () => {\r\n    setStep('select-etp');\r\n    setEtpSelectionOpen(true);\r\n  };\r\n\r\n  const handleViewPreview = async (mapa: MapaRisco) => {\r\n    await loadMapaFull(mapa.id!);\r\n    setPreviewOpen(true);\r\n  };\r\n\r\n  const handleContinueEditing = (mapa: MapaRisco) => {\r\n    loadMapaFull(mapa.id!);\r\n    setStep('create-risks');\r\n    toast({\r\n      title: \"Carregando Mapa\",\r\n      description: `Continuando edi√ß√£o do ${mapa.titulo}`,\r\n    });\r\n  };\r\n\r\n  const handleExportPDF = (mapa?: MapaRisco) => {\r\n    window.print();\r\n  };\r\n\r\n  const handleSaveDraft = async () => {\r\n    try {\r\n      setLoading(true);\r\n      if (currentMapaId) {\r\n        await mapaRiscosService.updateMapaRiscos(currentMapaId, {\r\n          titulo: selectedETP ? `Mapa de Riscos - ${selectedETP.numeroETP}` : 'Novo Mapa de Riscos',\r\n          updated_at: new Date().toISOString()\r\n        });\r\n      } else {\r\n        const newMapa = await mapaRiscosService.createMapaRiscos({\r\n          titulo: selectedETP ? `Mapa de Riscos - ${selectedETP.numeroETP}` : 'Novo Mapa de Riscos',\r\n          etp_id: selectedETP?.id,\r\n          etp_numero: selectedETP?.numeroETP,\r\n          etp_titulo: selectedETP?.titulo,\r\n          secretaria: selectedETP?.secretaria,\r\n          status: 'elaboracao',\r\n          prefeitura_id: user?.prefeituraId || '',\r\n          created_by: user?.id || ''\r\n        });\r\n        setCurrentMapaId(newMapa.id);\r\n      }\r\n\r\n      toast({\r\n        title: \"Rascunho Salvo\",\r\n        description: \"Mapa de riscos salvo como rascunho com sucesso.\",\r\n      });\r\n    } catch (error) {\r\n      console.error('Erro ao salvar rascunho:', error);\r\n      toast({\r\n        title: \"Erro ao salvar\",\r\n        description: \"N√£o foi poss√≠vel salvar o rascunho.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleFinalizeMapa = async () => {\r\n    try {\r\n      setLoading(true);\r\n      if (!currentMapaId) {\r\n        await handleSaveDraft();\r\n      }\r\n\r\n      if (currentMapaId) {\r\n        await mapaRiscosService.finalizeMapaRiscos(currentMapaId);\r\n        toast({\r\n          title: \"Mapa Finalizado\",\r\n          description: \"Mapa de riscos finalizado com sucesso!\",\r\n        });\r\n        handleBackToOverview();\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao finalizar mapa:', error);\r\n      toast({\r\n        title: \"Erro ao finalizar\",\r\n        description: \"N√£o foi poss√≠vel finalizar o mapa.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleInputChange = (field: string, value: string) => {\r\n    setFormData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const nivel = calcularNivel(formData.probabilidade, formData.impacto);\r\n\r\n      if (!currentMapaId) {\r\n        await handleSaveDraft();\r\n      }\r\n\r\n      if (editingRisk) {\r\n        await mapaRiscosService.updateRiscoItem(editingRisk.id!, {\r\n          categoria: formData.categoria,\r\n          descricao: formData.descricao,\r\n          causa_provavel: formData.causaProvavel,\r\n          consequencia: formData.consequencia,\r\n          probabilidade: formData.probabilidade,\r\n          impacto: formData.impacto,\r\n          nivel,\r\n          mitigacao: formData.mitigacao,\r\n          plano_contingencia: formData.planoContingencia,\r\n          responsavel: formData.responsavel\r\n        });\r\n        toast({\r\n          title: \"Risco Atualizado\",\r\n          description: \"Risco atualizado com sucesso.\",\r\n        });\r\n      } else if (currentMapaId) {\r\n        await mapaRiscosService.addRiscoItem(currentMapaId, {\r\n          categoria: formData.categoria,\r\n          descricao: formData.descricao,\r\n          causa_provavel: formData.causaProvavel,\r\n          consequencia: formData.consequencia,\r\n          probabilidade: formData.probabilidade,\r\n          impacto: formData.impacto,\r\n          nivel,\r\n          mitigacao: formData.mitigacao,\r\n          plano_contingencia: formData.planoContingencia,\r\n          responsavel: formData.responsavel\r\n        });\r\n        toast({\r\n          title: \"Risco Adicionado\",\r\n          description: \"Novo risco adicionado ao mapa.\",\r\n        });\r\n      }\r\n\r\n      if (currentMapaId) {\r\n        const mapaData = await mapaRiscosService.fetchMapaRisco(currentMapaId);\r\n        setRiscos(mapaData.mapa_riscos_itens || []);\r\n      }\r\n\r\n      setShowForm(false);\r\n      setEditingRisk(null);\r\n      setFormData({\r\n        categoria: '',\r\n        descricao: '',\r\n        causaProvavel: '',\r\n        consequencia: '',\r\n        probabilidade: '',\r\n        impacto: '',\r\n        mitigacao: '',\r\n        planoContingencia: '',\r\n        responsavel: ''\r\n      });\r\n    } catch (error) {\r\n      console.error('Erro ao salvar risco:', error);\r\n      toast({\r\n        title: \"Erro ao salvar risco\",\r\n        description: \"Ocorreu um erro ao salvar os dados.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleEdit = (risk: Risco) => {\r\n    setEditingRisk(risk);\r\n    setFormData({\r\n      categoria: risk.categoria,\r\n      descricao: risk.descricao,\r\n      causaProvavel: risk.causa_provavel || '',\r\n      consequencia: risk.consequencia || '',\r\n      probabilidade: risk.probabilidade,\r\n      impacto: risk.impacto,\r\n      mitigacao: risk.mitigacao,\r\n      planoContingencia: risk.plano_contingencia || '',\r\n      responsavel: risk.responsavel || ''\r\n    });\r\n    setShowForm(true);\r\n  };\r\n\r\n  const handleDelete = async (id: string) => {\r\n    try {\r\n      setLoading(true);\r\n      await mapaRiscosService.deleteRiscoItem(id);\r\n      setRiscos(prev => prev.filter(risk => risk.id !== id));\r\n      toast({\r\n        title: \"Risco Removido\",\r\n        description: \"Risco removido do mapa.\",\r\n      });\r\n    } catch (error) {\r\n      console.error('Erro ao remover risco:', error);\r\n      toast({\r\n        title: \"Erro ao remover\",\r\n        description: \"N√£o foi poss√≠vel remover o risco.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAcceptAIRisk = async (aiRisk: Omit<DbMapaRiscosItem, 'id' | 'mapa_riscos_id'>) => {\r\n    try {\r\n      setLoading(true);\r\n      if (!currentMapaId) {\r\n        await handleSaveDraft();\r\n      }\r\n\r\n      if (currentMapaId) {\r\n        await mapaRiscosService.addRiscoItem(currentMapaId, aiRisk);\r\n        const mapaData = await mapaRiscosService.fetchMapaRisco(currentMapaId);\r\n        setRiscos(mapaData.mapa_riscos_itens || []);\r\n        toast({\r\n          title: \"Sugest√£o Aceita\",\r\n          description: \"O risco sugerido pela IA foi adicionado ao mapa.\",\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Erro ao aceitar risco IA:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const summary = {\r\n    total: riscos.length,\r\n    alto: riscos.filter(r => r.nivel === 'Alto').length,\r\n    medio: riscos.filter(r => r.nivel === 'M√©dio').length,\r\n    baixo: riscos.filter(r => r.nivel === 'Baixo').length\r\n  };\r\n\r\n  if (step === 'overview') {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">Mapa de Riscos</h1>\r\n            <p className=\"text-gray-600\">\r\n              Identifica√ß√£o e an√°lise de riscos associados √†s contrata√ß√µes\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <MapaRiscosOverviewCards\r\n          onViewConcluidos={handleViewConcluidos}\r\n          onViewElaboracao={handleViewElaboracao}\r\n        />\r\n\r\n        <ETPSelectionModal\r\n          isOpen={etpSelectionOpen}\r\n          onClose={() => setEtpSelectionOpen(false)}\r\n          onSelectETP={handleSelectETP}\r\n          selectedETP={selectedETP}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (step === 'list-concluidos' || step === 'list-elaboracao') {\r\n    const isConcluido = step === 'list-concluidos';\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <Button\r\n              variant=\"ghost\"\r\n              onClick={handleBackToOverview}\r\n              className=\"mb-2 p-0 h-auto text-orange-600 hover:text-orange-700\"\r\n            >\r\n              <ArrowLeft size={16} className=\"mr-1\" />\r\n              Voltar ao painel inicial\r\n            </Button>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">\r\n              {isConcluido ? 'Mapas Conclu√≠dos' : 'Mapas em Elabora√ß√£o'}\r\n            </h1>\r\n            <p className=\"text-gray-600\">\r\n              {isConcluido\r\n                ? 'Visualize e gerencie mapas de riscos finalizados'\r\n                : 'Continue editando mapas de riscos em desenvolvimento'}\r\n            </p>\r\n          </div>\r\n          <Button\r\n            onClick={handleStartNewMap}\r\n            className=\"bg-orange-500 hover:bg-orange-600\"\r\n          >\r\n            <Plus size={16} className=\"mr-2\" />\r\n            Novo Mapa de Riscos\r\n          </Button>\r\n        </div>\r\n\r\n        <MapaRiscosCards\r\n          statusFilter={isConcluido ? 'concluido' : 'elaboracao'}\r\n          onViewPreview={handleViewPreview}\r\n          onContinueEditing={handleContinueEditing}\r\n          onExportPDF={handleExportPDF}\r\n        />\r\n\r\n        <MapaRiscosPreview\r\n          isOpen={previewOpen}\r\n          onClose={() => setPreviewOpen(false)}\r\n          etp={selectedETP || {\r\n            id: '',\r\n            titulo: '',\r\n            numeroETP: '',\r\n            secretaria: '',\r\n            dataCriacao: '',\r\n            valorTotal: '',\r\n            descricaoDemanda: '',\r\n            status: ''\r\n          }}\r\n          riscos={riscos}\r\n          onExportPDF={() => handleExportPDF()}\r\n        />\r\n\r\n        <ETPSelectionModal\r\n          isOpen={etpSelectionOpen}\r\n          onClose={() => setEtpSelectionOpen(false)}\r\n          onSelectETP={handleSelectETP}\r\n          selectedETP={selectedETP}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (step === 'select-etp') {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <Button\r\n              variant=\"ghost\"\r\n              onClick={handleBackToOverview}\r\n              className=\"mb-2 p-0 h-auto text-orange-600 hover:text-orange-700\"\r\n            >\r\n              <ArrowLeft size={16} className=\"mr-1\" />\r\n              Voltar ao painel inicial\r\n            </Button>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">Mapa de Riscos</h1>\r\n            <p className=\"text-gray-600\">Selecione um ETP para criar o mapa de riscos</p>\r\n          </div>\r\n        </div>\r\n\r\n        <Card>\r\n          <CardContent className=\"p-12 text-center\">\r\n            <div className=\"space-y-6\">\r\n              <div className=\"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center\">\r\n                <FileText className=\"w-8 h-8 text-orange-600\" />\r\n              </div>\r\n              <div>\r\n                <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\r\n                  Criar Novo Mapa de Riscos\r\n                </h2>\r\n                <p className=\"text-gray-600 mb-6\">\r\n                  Para criar um mapa de riscos, voc√™ precisa primeiro selecionar um ETP conclu√≠do.\r\n                  O mapa ser√° baseado nas informa√ß√µes e caracter√≠sticas do ETP escolhido.\r\n                </p>\r\n                <Button\r\n                  onClick={() => setEtpSelectionOpen(true)}\r\n                  className=\"bg-orange-500 hover:bg-orange-600\"\r\n                >\r\n                  <Plus size={16} className=\"mr-2\" />\r\n                  Selecionar ETP e Come√ßar\r\n                </Button>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <ETPSelectionModal\r\n          isOpen={etpSelectionOpen}\r\n          onClose={() => setEtpSelectionOpen(false)}\r\n          onSelectETP={handleSelectETP}\r\n          selectedETP={selectedETP}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <Button\r\n            variant=\"ghost\"\r\n            onClick={handleBackToOverview}\r\n            className=\"mb-2 p-0 h-auto text-orange-600 hover:text-orange-700\"\r\n          >\r\n            <ArrowLeft size={16} className=\"mr-1\" />\r\n            Voltar ao painel inicial\r\n          </Button>\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">\r\n            {currentMapaId ? 'Editando Mapa de Riscos' : 'Novo Mapa de Riscos'}\r\n          </h1>\r\n          <p className=\"text-gray-600\">\r\n            ETP: <span className=\"font-medium text-blue-600\">{selectedETP?.numeroETP}</span> - {selectedETP?.titulo}\r\n          </p>\r\n        </div>\r\n        <div className=\"flex items-center space-x-2\">\r\n          <Button variant=\"outline\" onClick={() => setPreviewOpen(true)}>\r\n            <Eye size={16} className=\"mr-2\" />\r\n            Preview\r\n          </Button>\r\n          <Button variant=\"outline\" onClick={handleSaveDraft}>\r\n            <Save size={16} className=\"mr-2\" />\r\n            Salvar Rascunho\r\n          </Button>\r\n          <Button variant=\"outline\" onClick={() => setAiSuggestionsOpen(true)}>\r\n            <Sparkles size={16} className=\"mr-2\" />\r\n            Sugerir Riscos com IA\r\n          </Button>\r\n          <Button onClick={() => setShowForm(true)} className=\"bg-orange-500 hover:bg-orange-600\">\r\n            <Plus size={16} className=\"mr-2\" />\r\n            Adicionar Risco Manualmente\r\n          </Button>\r\n          {riscos.length > 0 && (\r\n            <Button onClick={handleFinalizeMapa} className=\"bg-green-600 hover:bg-green-700\">\r\n              <Shield size={16} className=\"mr-2\" />\r\n              Finalizar Mapa\r\n            </Button>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {selectedETP && (\r\n        <ETPSummaryCard etp={selectedETP} dfds={etpDFDs} />\r\n      )}\r\n\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\r\n        <Card>\r\n          <CardContent className=\"p-6 text-center\">\r\n            <div className=\"text-2xl font-bold text-gray-900\">{summary.total}</div>\r\n            <p className=\"text-sm text-gray-600\">Total de Riscos</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"p-6 text-center\">\r\n            <div className=\"text-2xl font-bold text-red-600\">{summary.alto}</div>\r\n            <p className=\"text-sm text-gray-600\">Risco Alto</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"p-6 text-center\">\r\n            <div className=\"text-2xl font-bold text-yellow-600\">{summary.medio}</div>\r\n            <p className=\"text-sm text-gray-600\">Risco M√©dio</p>\r\n          </CardContent>\r\n        </Card>\r\n        <Card>\r\n          <CardContent className=\"p-6 text-center\">\r\n            <div className=\"text-2xl font-bold text-green-600\">{summary.baixo}</div>\r\n            <p className=\"text-sm text-gray-600\">Risco Baixo</p>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {riscos.length === 0 && !showForm && (\r\n        <Card>\r\n          <CardContent className=\"p-12 text-center\">\r\n            <div className=\"space-y-6\">\r\n              <div className=\"mx-auto w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center\">\r\n                <AlertTriangle className=\"w-8 h-8 text-gray-400\" />\r\n              </div>\r\n              <div>\r\n                <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\r\n                  Nenhum risco identificado\r\n                </h2>\r\n                <p className=\"text-gray-600 mb-6\">\r\n                  Comece adicionando riscos manualmente ou use nossa IA para sugerir riscos baseados no ETP selecionado.\r\n                </p>\r\n                <div className=\"flex items-center justify-center space-x-4\">\r\n                  <Button\r\n                    onClick={() => setShowForm(true)}\r\n                    className=\"bg-orange-500 hover:bg-orange-600\"\r\n                  >\r\n                    <Plus size={16} className=\"mr-2\" />\r\n                    Adicionar Risco Manualmente\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    onClick={() => setAiSuggestionsOpen(true)}\r\n                  >\r\n                    <Sparkles size={16} className=\"mr-2\" />\r\n                    Sugerir Riscos com IA\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {showForm && (\r\n        <Card className=\"border-orange-200 shadow-md\">\r\n          <CardHeader className=\"bg-orange-50/50\">\r\n            <CardTitle className=\"text-orange-800 flex items-center\">\r\n              <Edit className=\"w-5 h-5 mr-2\" />\r\n              {editingRisk ? 'Editar Risco' : 'Novo Risco Manual'}\r\n            </CardTitle>\r\n          </CardHeader>\r\n          <CardContent className=\"p-6 space-y-6\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div className=\"space-y-2\">\r\n                <Label>Categoria</Label>\r\n                <Select value={formData.categoria} onValueChange={(v) => handleInputChange('categoria', v)}>\r\n                  <SelectTrigger><SelectValue placeholder=\"Selecione...\" /></SelectTrigger>\r\n                  <SelectContent>\r\n                    {categorias.map(c => <SelectItem key={c} value={c}>{c}</SelectItem>)}\r\n                  </SelectContent>\r\n                </Select>\r\n              </div>\r\n              <div className=\"grid grid-cols-2 gap-4\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>Probabilidade</Label>\r\n                  <Select value={formData.probabilidade} onValueChange={(v) => handleInputChange('probabilidade', v)}>\r\n                    <SelectTrigger><SelectValue /></SelectTrigger>\r\n                    <SelectContent>\r\n                      {niveis.map(n => <SelectItem key={n} value={n}>{n}</SelectItem>)}\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label>Impacto</Label>\r\n                  <Select value={formData.impacto} onValueChange={(v) => handleInputChange('impacto', v)}>\r\n                    <SelectTrigger><SelectValue /></SelectTrigger>\r\n                    <SelectContent>\r\n                      {['Baixo', 'M√©dio', 'Alto'].map(n => <SelectItem key={n} value={n}>{n}</SelectItem>)}\r\n                    </SelectContent>\r\n                  </Select>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-2\">\r\n              <Label>Descri√ß√£o do Risco</Label>\r\n              <Textarea\r\n                placeholder=\"Descreva o evento de risco...\"\r\n                value={formData.descricao}\r\n                onChange={(e) => handleInputChange('descricao', e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              <div className=\"space-y-2\">\r\n                <Label>Causa Prov√°vel</Label>\r\n                <Textarea\r\n                  value={formData.causaProvavel}\r\n                  onChange={(e) => handleInputChange('causaProvavel', e.target.value)}\r\n                />\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>Consequ√™ncia</Label>\r\n                <Textarea\r\n                  value={formData.consequencia}\r\n                  onChange={(e) => handleInputChange('consequencia', e.target.value)}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"space-y-4 pt-4 border-t\">\r\n              <h3 className=\"font-medium text-gray-900 flex items-center\">\r\n                <Shield className=\"w-4 h-4 mr-2 text-green-600\" />\r\n                Medidas de Controle\r\n              </h3>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n                <div className=\"space-y-2\">\r\n                  <Label>A√ß√£o de Mitiga√ß√£o</Label>\r\n                  <Textarea\r\n                    value={formData.mitigacao}\r\n                    onChange={(e) => handleInputChange('mitigacao', e.target.value)}\r\n                  />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <Label>Plano de Conting√™ncia</Label>\r\n                  <Textarea\r\n                    value={formData.planoContingencia}\r\n                    onChange={(e) => handleInputChange('planoContingencia', e.target.value)}\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <Label>Respons√°vel</Label>\r\n                <Input\r\n                  value={formData.responsavel}\r\n                  onChange={(e) => handleInputChange('responsavel', e.target.value)}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex justify-end space-x-3 pt-6\">\r\n              <Button variant=\"outline\" onClick={() => { setShowForm(false); setEditingRisk(null); }}>\r\n                Cancelar\r\n              </Button>\r\n              <Button onClick={handleSubmit} className=\"bg-orange-500 hover:bg-orange-600\">\r\n                {editingRisk ? 'Salvar Altera√ß√µes' : 'Adicionar Risco'}\r\n              </Button>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      )}\r\n\r\n      {riscos.length > 0 && !showForm && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-lg font-semibold text-gray-900\">Riscos Identificados</h2>\r\n            <Badge variant=\"outline\">{riscos.length} riscos</Badge>\r\n          </div>\r\n          <div className=\"grid grid-cols-1 gap-4\">\r\n            {riscos.map(risk => (\r\n              <Card key={risk.id} className=\"hover:shadow-md transition-shadow\">\r\n                <CardContent className=\"p-6\">\r\n                  <div className=\"flex justify-between items-start mb-4\">\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                      <Badge className={getCategoriaColor(risk.categoria)}>{risk.categoria}</Badge>\r\n                      <Badge className={getNivelColor(risk.nivel)}>{risk.nivel}</Badge>\r\n                    </div>\r\n                    <div className=\"flex space-x-2\">\r\n                      <Button variant=\"ghost\" size=\"sm\" onClick={() => handleEdit(risk)}>\r\n                        <Edit className=\"w-4 h-4 text-gray-500\" />\r\n                      </Button>\r\n                      <Button variant=\"ghost\" size=\"sm\" onClick={() => handleDelete(risk.id!)}>\r\n                        <Trash2 className=\"w-4 h-4 text-red-500\" />\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                  <h3 className=\"font-semibold text-gray-900 mb-2\">{risk.descricao}</h3>\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-gray-600\">\r\n                    <div>\r\n                      <span className=\"font-semibold\">Mitiga√ß√£o:</span> {risk.mitigacao}\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"font-semibold\">Respons√°vel:</span> {risk.responsavel}\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <AIRiskSuggestions\r\n        isOpen={aiSuggestionsOpen}\r\n        onClose={() => setAiSuggestionsOpen(false)}\r\n        etp={selectedETP}\r\n        onAcceptRisk={handleAcceptAIRisk}\r\n      />\r\n\r\n      <MapaRiscosPreview\r\n        isOpen={previewOpen}\r\n        onClose={() => setPreviewOpen(false)}\r\n        etp={selectedETP || {\r\n          id: '',\r\n          titulo: '',\r\n          numeroETP: '',\r\n          secretaria: '',\r\n          dataCriacao: '',\r\n          valorTotal: '',\r\n          descricaoDemanda: '',\r\n          status: ''\r\n        }}\r\n        riscos={riscos}\r\n        onExportPDF={() => handleExportPDF()}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MapaRiscos;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\pages\\Perfil.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":143,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3919,3922],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3919,3922],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport React, { useState } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Switch } from '@/components/ui/switch';\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport UserManagement from '@/components/Perfil/UserManagement';\r\nimport SecretariaManagement from '@/components/Perfil/SecretariaManagement';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport {\r\n  Save,\r\n  User,\r\n  Mail,\r\n  Phone,\r\n  MapPin,\r\n  Bell,\r\n  Shield,\r\n  Settings,\r\n  LogOut,\r\n  Users,\r\n  Building,\r\n  UserCheck\r\n} from 'lucide-react';\r\n\r\nconst Perfil = () => {\r\n  const { user, logout, isSuperAdmin } = useAuth();\r\n  const { toast } = useToast();\r\n\r\n  const [userData, setUserData] = useState({\r\n    nome: user?.nome || '',\r\n    email: user?.email || '',\r\n    telefone: '(11) 98765-4321', // Mocked as not in User type yet\r\n    cargo: user?.role === 'super_admin' ? 'Super Administrador' : user?.role === 'admin' ? 'Administrador' : 'Operador',\r\n    unidade: 'Secretaria de Administra√ß√£o', // Mocked as not in User type yet\r\n    cpf: '123.456.789-00', // Mocked as not in User type yet\r\n    matricula: '12345', // Mocked as not in User type yet\r\n    isGestor: user?.role === 'super_admin' || user?.role === 'admin'\r\n  });\r\n\r\n  // Simula permiss√µes do usu√°rio atual\r\n  const [userPermissions] = useState({\r\n    criarDFD: true,\r\n    acessarPCA: false,\r\n    criarETP: true,\r\n    criarMapaRiscos: true,\r\n    criarTR: true,\r\n    criarEdital: true,\r\n    editarDadosInstitucionais: true,\r\n    visualizarRelatorios: true\r\n  });\r\n\r\n  const [preferences, setPreferences] = useState({\r\n    emailNotifications: true,\r\n    pushNotifications: false,\r\n    weeklyReport: true,\r\n    contractReminders: true\r\n  });\r\n\r\n  const [passwordData, setPasswordData] = useState({\r\n    currentPassword: '',\r\n    newPassword: '',\r\n    confirmPassword: ''\r\n  });\r\n\r\n  const handleUserDataChange = (field: string, value: string) => {\r\n    setUserData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const handlePreferenceChange = (field: string, value: boolean) => {\r\n    setPreferences(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const handlePasswordChange = (field: string, value: string) => {\r\n    setPasswordData(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const handleSaveProfile = () => {\r\n    toast({\r\n      title: \"Perfil Atualizado\",\r\n      description: \"Dados do perfil salvos com sucesso.\",\r\n    });\r\n  };\r\n\r\n  const handleSavePreferences = () => {\r\n    toast({\r\n      title: \"Prefer√™ncias Salvas\",\r\n      description: \"Configura√ß√µes atualizadas com sucesso.\",\r\n    });\r\n  };\r\n\r\n  const handleChangePassword = () => {\r\n    if (passwordData.newPassword !== passwordData.confirmPassword) {\r\n      toast({\r\n        title: \"Erro\",\r\n        description: \"As senhas n√£o coincidem.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    if (passwordData.newPassword.length < 8) {\r\n      toast({\r\n        title: \"Erro\",\r\n        description: \"A senha deve ter pelo menos 8 caracteres.\",\r\n        variant: \"destructive\"\r\n      });\r\n      return;\r\n    }\r\n\r\n    toast({\r\n      title: \"Senha Alterada\",\r\n      description: \"Senha alterada com sucesso.\",\r\n    });\r\n\r\n    setPasswordData({\r\n      currentPassword: '',\r\n      newPassword: '',\r\n      confirmPassword: ''\r\n    });\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    logout();\r\n    setTimeout(() => {\r\n      window.location.href = '/';\r\n    }, 500);\r\n  };\r\n\r\n  const getPermissionsSummary = (permissions: any): string[] => {\r\n    const activePermissions: string[] = [];\r\n    if (permissions.criarDFD) activePermissions.push('DFD');\r\n    if (permissions.acessarPCA) activePermissions.push('PCA');\r\n    if (permissions.criarETP) activePermissions.push('ETP');\r\n    if (permissions.criarMapaRiscos) activePermissions.push('Mapa Riscos');\r\n    if (permissions.criarTR) activePermissions.push('TR');\r\n    if (permissions.criarEdital) activePermissions.push('Edital');\r\n    if (permissions.editarDadosInstitucionais) activePermissions.push('Dados Inst.');\r\n    if (permissions.visualizarRelatorios) activePermissions.push('Relat√≥rios');\r\n    return activePermissions;\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold\">Perfil do Usu√°rio</h1>\r\n          <p className=\"text-muted-foreground\">Gerencie suas informa√ß√µes pessoais e configura√ß√µes</p>\r\n        </div>\r\n        <Button variant=\"outline\" onClick={handleLogout}>\r\n          <LogOut size={16} className=\"mr-2\" />\r\n          Logout\r\n        </Button>\r\n      </div>\r\n\r\n      <Tabs defaultValue=\"meus-dados\" className=\"w-full\">\r\n        <TabsList className=\"grid w-full grid-cols-3\">\r\n          <TabsTrigger value=\"meus-dados\" className=\"flex items-center space-x-2\">\r\n            <User size={16} />\r\n            <span>Meus Dados</span>\r\n          </TabsTrigger>\r\n          {(userData.isGestor || user?.role === 'admin') && (\r\n            <>\r\n              <TabsTrigger value=\"usuarios\" className=\"flex items-center space-x-2\">\r\n                <Users size={16} />\r\n                <span>Gerenciar Usu√°rios</span>\r\n              </TabsTrigger>\r\n              <TabsTrigger value=\"secretarias\" className=\"flex items-center space-x-2\">\r\n                <Building size={16} />\r\n                <span>Secretarias e Setores</span>\r\n              </TabsTrigger>\r\n            </>\r\n          )}\r\n        </TabsList>\r\n\r\n        <TabsContent value=\"meus-dados\" className=\"space-y-6\">\r\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n            {/* User Info */}\r\n            <div className=\"lg:col-span-2 space-y-6\">\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"flex items-center space-x-2\">\r\n                    <User size={20} />\r\n                    <span>Informa√ß√µes Pessoais</span>\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                  <div className=\"flex items-center space-x-4 mb-6\">\r\n                    <Avatar className=\"h-20 w-20\">\r\n                      <AvatarImage src=\"/placeholder.svg\" alt={userData.nome} />\r\n                      <AvatarFallback className=\"text-lg\">\r\n                        {userData.nome.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2)}\r\n                      </AvatarFallback>\r\n                    </Avatar>\r\n                    <div>\r\n                      <h3 className=\"text-lg font-semibold\">{userData.nome}</h3>\r\n                      <p className=\"text-muted-foreground\">{userData.cargo}</p>\r\n                      <p className=\"text-sm text-muted-foreground\">{userData.unidade}</p>\r\n                      {userData.isGestor && (\r\n                        <Badge variant=\"secondary\" className=\"mt-2\">\r\n                          <UserCheck size={12} className=\"mr-1\" />\r\n                          Gestor do Sistema\r\n                        </Badge>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"nome\">Nome Completo</Label>\r\n                      <Input\r\n                        id=\"nome\"\r\n                        value={userData.nome}\r\n                        onChange={(e) => handleUserDataChange('nome', e.target.value)}\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"email\">E-mail</Label>\r\n                      <Input\r\n                        id=\"email\"\r\n                        type=\"email\"\r\n                        value={userData.email}\r\n                        onChange={(e) => handleUserDataChange('email', e.target.value)}\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"telefone\">Telefone</Label>\r\n                      <Input\r\n                        id=\"telefone\"\r\n                        value={userData.telefone}\r\n                        onChange={(e) => handleUserDataChange('telefone', e.target.value)}\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"cpf\">CPF</Label>\r\n                      <Input\r\n                        id=\"cpf\"\r\n                        value={userData.cpf}\r\n                        onChange={(e) => handleUserDataChange('cpf', e.target.value)}\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"cargo\">Cargo</Label>\r\n                      <Input\r\n                        id=\"cargo\"\r\n                        value={userData.cargo}\r\n                        onChange={(e) => handleUserDataChange('cargo', e.target.value)}\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2\">\r\n                      <Label htmlFor=\"matricula\">Matr√≠cula</Label>\r\n                      <Input\r\n                        id=\"matricula\"\r\n                        value={userData.matricula}\r\n                        onChange={(e) => handleUserDataChange('matricula', e.target.value)}\r\n                      />\r\n                    </div>\r\n\r\n                    <div className=\"space-y-2 md:col-span-2\">\r\n                      <Label htmlFor=\"unidade\">Unidade</Label>\r\n                      <Input\r\n                        id=\"unidade\"\r\n                        value={userData.unidade}\r\n                        onChange={(e) => handleUserDataChange('unidade', e.target.value)}\r\n                      />\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"flex justify-end pt-4 border-t\">\r\n                    <Button onClick={handleSaveProfile}>\r\n                      <Save size={16} className=\"mr-2\" />\r\n                      Salvar Perfil\r\n                    </Button>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"flex items-center space-x-2\">\r\n                    <Shield size={20} />\r\n                    <span>Seguran√ßa</span>\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"currentPassword\">Senha Atual</Label>\r\n                    <Input\r\n                      id=\"currentPassword\"\r\n                      type=\"password\"\r\n                      value={passwordData.currentPassword}\r\n                      onChange={(e) => handlePasswordChange('currentPassword', e.target.value)}\r\n                      placeholder=\"Digite sua senha atual\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"newPassword\">Nova Senha</Label>\r\n                    <Input\r\n                      id=\"newPassword\"\r\n                      type=\"password\"\r\n                      value={passwordData.newPassword}\r\n                      onChange={(e) => handlePasswordChange('newPassword', e.target.value)}\r\n                      placeholder=\"Digite sua nova senha\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"space-y-2\">\r\n                    <Label htmlFor=\"confirmPassword\">Confirmar Nova Senha</Label>\r\n                    <Input\r\n                      id=\"confirmPassword\"\r\n                      type=\"password\"\r\n                      value={passwordData.confirmPassword}\r\n                      onChange={(e) => handlePasswordChange('confirmPassword', e.target.value)}\r\n                      placeholder=\"Confirme sua nova senha\"\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex justify-end pt-4 border-t\">\r\n                    <Button onClick={handleChangePassword} variant=\"outline\">\r\n                      <Shield size={16} className=\"mr-2\" />\r\n                      Alterar Senha\r\n                    </Button>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n\r\n            {/* Sidebar */}\r\n            <div className=\"space-y-6\">\r\n              {/* Permiss√µes do usu√°rio */}\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"flex items-center space-x-2\">\r\n                    <UserCheck size={20} />\r\n                    <span>Minhas Permiss√µes</span>\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-3\">\r\n                    <p className=\"text-sm text-muted-foreground mb-3\">Permiss√µes concedidas ao seu usu√°rio:</p>\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                      {getPermissionsSummary(userPermissions).map(permission => (\r\n                        <Badge key={permission} variant=\"outline\" className=\"text-xs\">\r\n                          {permission}\r\n                        </Badge>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              {/* Notifica√ß√µes */}\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle className=\"flex items-center space-x-2\">\r\n                    <Bell size={20} />\r\n                    <span>Notifica√ß√µes</span>\r\n                  </CardTitle>\r\n                </CardHeader>\r\n                <CardContent className=\"space-y-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm font-medium\">E-mail</p>\r\n                      <p className=\"text-xs text-muted-foreground\">Receber notifica√ß√µes por e-mail</p>\r\n                    </div>\r\n                    <Switch\r\n                      checked={preferences.emailNotifications}\r\n                      onCheckedChange={(checked) => handlePreferenceChange('emailNotifications', checked)}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm font-medium\">Push</p>\r\n                      <p className=\"text-xs text-muted-foreground\">Notifica√ß√µes no navegador</p>\r\n                    </div>\r\n                    <Switch\r\n                      checked={preferences.pushNotifications}\r\n                      onCheckedChange={(checked) => handlePreferenceChange('pushNotifications', checked)}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm font-medium\">Relat√≥rio Semanal</p>\r\n                      <p className=\"text-xs text-muted-foreground\">Resumo semanal das atividades</p>\r\n                    </div>\r\n                    <Switch\r\n                      checked={preferences.weeklyReport}\r\n                      onCheckedChange={(checked) => handlePreferenceChange('weeklyReport', checked)}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <p className=\"text-sm font-medium\">Lembretes de Contrato</p>\r\n                      <p className=\"text-xs text-muted-foreground\">Avisos de prazos e vencimentos</p>\r\n                    </div>\r\n                    <Switch\r\n                      checked={preferences.contractReminders}\r\n                      onCheckedChange={(checked) => handlePreferenceChange('contractReminders', checked)}\r\n                    />\r\n                  </div>\r\n\r\n                  <div className=\"flex justify-end pt-4 border-t\">\r\n                    <Button onClick={handleSavePreferences} variant=\"outline\">\r\n                      <Settings size={16} className=\"mr-2\" />\r\n                      Salvar Prefer√™ncias\r\n                    </Button>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n\r\n              {/* Estat√≠sticas */}\r\n              <Card>\r\n                <CardHeader>\r\n                  <CardTitle>Estat√≠sticas</CardTitle>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <div className=\"space-y-4\">\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-muted-foreground\">DFDs Criados</span>\r\n                      <span className=\"font-semibold\">23</span>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-muted-foreground\">ETPs Elaborados</span>\r\n                      <span className=\"font-semibold\">15</span>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-muted-foreground\">Editais Gerados</span>\r\n                      <span className=\"font-semibold\">8</span>\r\n                    </div>\r\n                    <div className=\"flex items-center justify-between\">\r\n                      <span className=\"text-sm text-muted-foreground\">√öltimo Acesso</span>\r\n                      <span className=\"font-semibold\">Hoje</span>\r\n                    </div>\r\n                  </div>\r\n                </CardContent>\r\n              </Card>\r\n            </div>\r\n          </div>\r\n        </TabsContent>\r\n\r\n        {(userData.isGestor || user?.role === 'admin' || user?.role === 'super_admin') && (\r\n          <>\r\n            <TabsContent value=\"usuarios\">\r\n              <UserManagement />\r\n            </TabsContent>\r\n\r\n            <TabsContent value=\"secretarias\">\r\n              <SecretariaManagement />\r\n            </TabsContent>\r\n          </>\r\n        )}\r\n      </Tabs>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Perfil;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\pages\\TermoReferencia.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1507,1510],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1507,1510],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":165,"column":99,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":102,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5845,5848],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5845,5848],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":183,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":183,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6297,6300],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6297,6300],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport {\r\n  Plus,\r\n  FileText,\r\n  Edit,\r\n  CheckCircle,\r\n  Eye,\r\n  Download,\r\n  Filter,\r\n  Loader2,\r\n  Calendar,\r\n  X\r\n} from 'lucide-react';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\r\nimport {\r\n  Pagination,\r\n  PaginationContent,\r\n  PaginationItem,\r\n  PaginationLink,\r\n  PaginationNext,\r\n  PaginationPrevious,\r\n} from \"@/components/ui/pagination\";\r\nimport TRCreationWizard from '../components/TermoReferencia/TRCreationWizard';\r\nimport TRSelectionModal from '../components/TermoReferencia/TRSelectionModal';\r\nimport { termoReferenciaService } from '@/services/termoReferenciaService';\r\nimport { useAuth } from '@/contexts/AuthContext';\r\nimport { DbTermoReferencia } from '@/types/database';\r\n\r\nconst TermoReferencia = () => {\r\n  const { user } = useAuth();\r\n  const [showWizard, setShowWizard] = useState(false);\r\n  const [showSelectionModal, setShowSelectionModal] = useState(false);\r\n  const [selectedOrigin, setSelectedOrigin] = useState<'cronograma' | 'dfds-livres' | 'itens-especificos' | null>(null);\r\n  const [selectedData, setSelectedData] = useState<any>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [termosData, setTermosData] = useState<DbTermoReferencia[]>([]);\r\n  const [counts, setCounts] = useState({ total: 0, elaboracao: 0, prontos: 0 });\r\n  const [filters, setFilters] = useState({\r\n    secretaria: 'all',\r\n    status: 'all',\r\n    ano: '2025'\r\n  });\r\n  const [currentFilter, setCurrentFilter] = useState<string>('all');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const { toast } = useToast();\r\n  const itemsPerPage = 5;\r\n\r\n  useEffect(() => {\r\n    loadData();\r\n  }, [user?.prefeituraId]);\r\n\r\n  const loadData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const [list, stats] = await Promise.all([\r\n        termoReferenciaService.fetchTermosReferencia(user?.prefeituraId || undefined),\r\n        termoReferenciaService.getCountsByStatus(user?.prefeituraId || undefined)\r\n      ]);\r\n      setTermosData(list);\r\n      setCounts(stats);\r\n    } catch (error) {\r\n      console.error('Erro ao carregar Termos de Refer√™ncia:', error);\r\n      toast({\r\n        title: \"Erro ao carregar\",\r\n        description: \"N√£o foi poss√≠vel carregar os dados dos Termos de Refer√™ncia.\",\r\n        variant: \"destructive\"\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const secretarias = [...new Set(termosData.map(termo => termo.secretaria_id || 'N√£o informada'))];\r\n\r\n  const filteredTermos = termosData.filter(termo => {\r\n    const matchesSecretaria = filters.secretaria === 'all' || (termo.secretaria_id === filters.secretaria);\r\n    const matchesStatus = filters.status === 'all' || termo.status === filters.status;\r\n    const matchesAno = filters.ano === 'all' || (termo.created_at && termo.created_at.startsWith(filters.ano));\r\n\r\n    return matchesSecretaria && matchesStatus && matchesAno;\r\n  });\r\n\r\n  const statusFilteredTermos = filteredTermos.filter(termo => {\r\n    switch (currentFilter) {\r\n      case 'em-elaboracao':\r\n        return termo.status === 'Em Elabora√ß√£o' || termo.status === 'Rascunho';\r\n      case 'prontos':\r\n        return termo.status === 'Pronto' || termo.status === 'Conclu√≠do';\r\n      default:\r\n        return true;\r\n    }\r\n  });\r\n\r\n  const totalPages = Math.ceil(statusFilteredTermos.length / itemsPerPage);\r\n  const startIndex = (currentPage - 1) * itemsPerPage;\r\n  const paginatedTermos = statusFilteredTermos.slice(startIndex, startIndex + itemsPerPage);\r\n\r\n  const handleFilterChange = (filter: string) => {\r\n    setCurrentFilter(filter);\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const handlePageChange = (page: number) => {\r\n    setCurrentPage(page);\r\n  };\r\n\r\n  const updateFilter = (key: string, value: string) => {\r\n    setFilters(prev => ({ ...prev, [key]: value }));\r\n    setCurrentPage(1);\r\n  };\r\n\r\n  const formatCurrency = (value: number | null) => {\r\n    if (value === null) return 'R$ 0,00';\r\n    return new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value);\r\n  };\r\n\r\n  const formatDate = (dateString: string | undefined) => {\r\n    if (!dateString) return '-';\r\n    return new Date(dateString).toLocaleDateString('pt-BR');\r\n  };\r\n\r\n  const getStatusBadge = (status: string | null) => {\r\n    switch (status) {\r\n      case 'Em Elabora√ß√£o':\r\n      case 'Rascunho':\r\n        return <Badge className=\"bg-yellow-100 text-yellow-800 border-yellow-200\">Em Elabora√ß√£o</Badge>;\r\n      case 'Pronto':\r\n      case 'Conclu√≠do':\r\n        return <Badge className=\"bg-green-100 text-green-800 border-green-200\">Pronto</Badge>;\r\n      default:\r\n        return <Badge variant=\"outline\">{status || 'N/A'}</Badge>;\r\n    }\r\n  };\r\n\r\n  const handleViewTR = (tr: DbTermoReferencia) => {\r\n    toast({\r\n      title: \"Visualizando TR\",\r\n      description: `Abrindo detalhes do TR: ${tr.objeto?.substring(0, 30)}...`,\r\n    });\r\n  };\r\n\r\n  const handleEditTR = (tr: DbTermoReferencia) => {\r\n    toast({\r\n      title: \"Editando TR\",\r\n      description: `Abrindo editor para: ${tr.objeto?.substring(0, 30)}...`,\r\n    });\r\n  };\r\n\r\n  const handleDownloadTR = (tr: DbTermoReferencia) => {\r\n    toast({\r\n      title: \"Download iniciado\",\r\n      description: `Baixando TR: ${tr.objeto?.substring(0, 30)}...`,\r\n    });\r\n  };\r\n\r\n  const handleNovoTR = () => {\r\n    setShowSelectionModal(true);\r\n  };\r\n\r\n  const handleOriginSelected = (origin: 'cronograma' | 'dfds-livres' | 'itens-especificos', data: any) => {\r\n    setSelectedOrigin(origin);\r\n    setSelectedData(data);\r\n    setShowSelectionModal(false);\r\n    setShowWizard(true);\r\n  };\r\n\r\n  const handleCloseSelectionModal = () => {\r\n    setShowSelectionModal(false);\r\n  };\r\n\r\n  const handleCloseTRWizard = () => {\r\n    setShowWizard(false);\r\n    setSelectedOrigin(null);\r\n    setSelectedData(null);\r\n    loadData(); // Refresh list after closing wizard\r\n  };\r\n\r\n  const handleSaveTR = async (trData: any) => {\r\n    try {\r\n      // Logic for saving already inside wizard, here we just handle UI\r\n      toast({\r\n        title: \"TR Salvo\",\r\n        description: \"Termo de Refer√™ncia foi salvo com sucesso.\",\r\n      });\r\n      setShowWizard(false);\r\n      setSelectedOrigin(null);\r\n      setSelectedData(null);\r\n      loadData();\r\n    } catch (error) {\r\n      console.error('Erro ao salvar TR:', error);\r\n    }\r\n  };\r\n\r\n  if (showWizard && selectedOrigin) {\r\n    return (\r\n      <TRCreationWizard\r\n        origin={selectedOrigin}\r\n        selectedData={selectedData}\r\n        onClose={handleCloseTRWizard}\r\n        onSave={handleSaveTR}\r\n      />\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold text-gray-900\">Termos de Refer√™ncia</h1>\r\n          <p className=\"text-gray-600\">\r\n            Gerencie os termos de refer√™ncia para licita√ß√µes\r\n          </p>\r\n        </div>\r\n        <Button onClick={handleNovoTR} className=\"bg-orange-500 hover:bg-orange-600 shadow-md\">\r\n          <Plus size={16} className=\"mr-2\" />\r\n          Novo TR\r\n        </Button>\r\n      </div>\r\n\r\n      {/* Statistics Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md border-b-4 ${currentFilter === 'all' ? 'border-b-blue-500 shadow-sm' : 'border-b-transparent hover:border-b-blue-200'\r\n            }`}\r\n          onClick={() => handleFilterChange('all')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-blue-50 rounded-lg\">\r\n                <FileText size={20} className=\"text-blue-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 font-medium\">Total de TRs</p>\r\n                <p className=\"text-xl font-bold text-gray-900\">{counts.total}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md border-b-4 ${currentFilter === 'em-elaboracao' ? 'border-b-yellow-500 shadow-sm' : 'border-b-transparent hover:border-b-yellow-200'\r\n            }`}\r\n          onClick={() => handleFilterChange('em-elaboracao')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-yellow-50 rounded-lg\">\r\n                <Edit size={20} className=\"text-yellow-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 font-medium\">Em Elabora√ß√£o</p>\r\n                <p className=\"text-xl font-bold text-gray-900\">{counts.elaboracao}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n\r\n        <Card\r\n          className={`cursor-pointer transition-all hover:shadow-md border-b-4 ${currentFilter === 'prontos' ? 'border-b-green-500 shadow-sm' : 'border-b-transparent hover:border-b-green-200'\r\n            }`}\r\n          onClick={() => handleFilterChange('prontos')}\r\n        >\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"flex items-center space-x-3\">\r\n              <div className=\"p-2 bg-green-50 rounded-lg\">\r\n                <CheckCircle size={20} className=\"text-green-600\" />\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 font-medium\">Prontos</p>\r\n                <p className=\"text-xl font-bold text-gray-900\">{counts.prontos}</p>\r\n              </div>\r\n            </div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n\r\n      {/* Filters Table */}\r\n      <Card className=\"border-none shadow-sm bg-gray-50/50\">\r\n        <CardContent className=\"p-4\">\r\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n            <div className=\"md:col-span-2\">\r\n              <label className=\"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block ml-1\">\r\n                Ano de Refer√™ncia\r\n              </label>\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Select value={filters.ano} onValueChange={(value) => updateFilter('ano', value)}>\r\n                  <SelectTrigger className=\"bg-white\">\r\n                    <SelectValue placeholder=\"Selecione o ano\" />\r\n                  </SelectTrigger>\r\n                  <SelectContent>\r\n                    <SelectItem value=\"all\">Todos os anos</SelectItem>\r\n                    <SelectItem value=\"2024\">2024</SelectItem>\r\n                    <SelectItem value=\"2025\">2025</SelectItem>\r\n                  </SelectContent>\r\n                </Select>\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={() => updateFilter('ano', 'all')} className=\"text-gray-400\">\r\n                  <X size={14} />\r\n                </Button>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"md:col-span-2\">\r\n              <label className=\"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block ml-1\">\r\n                Filtrar por Status\r\n              </label>\r\n              <Select value={filters.status} onValueChange={(value) => updateFilter('status', value)}>\r\n                <SelectTrigger className=\"bg-white\">\r\n                  <SelectValue placeholder=\"Todos os status\" />\r\n                </SelectTrigger>\r\n                <SelectContent>\r\n                  <SelectItem value=\"all\">Todos os status</SelectItem>\r\n                  <SelectItem value=\"Em Elabora√ß√£o\">Em Elabora√ß√£o</SelectItem>\r\n                  <SelectItem value=\"Rascunho\">Rascunho</SelectItem>\r\n                  <SelectItem value=\"Pronto\">Pronto</SelectItem>\r\n                  <SelectItem value=\"Conclu√≠do\">Conclu√≠do</SelectItem>\r\n                </SelectContent>\r\n              </Select>\r\n            </div>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Terms List */}\r\n      <Card className=\"shadow-sm border-gray-100 overflow-hidden\">\r\n        <CardHeader className=\"bg-white pb-2 flex flex-row items-center justify-between\">\r\n          <CardTitle className=\"text-lg font-bold flex items-center space-x-2\">\r\n            <FileText size={20} className=\"text-orange-500\" />\r\n            <span>Documentos ({statusFilteredTermos.length})</span>\r\n          </CardTitle>\r\n          {loading && <Loader2 className=\"w-5 h-5 animate-spin text-orange-500\" />}\r\n        </CardHeader>\r\n        <CardContent className=\"p-0\">\r\n          {loading ? (\r\n            <div className=\"py-20 text-center\">\r\n              <Loader2 className=\"w-10 h-10 animate-spin mx-auto mb-4 text-orange-500\" />\r\n              <p className=\"text-gray-500\">Carregando termos de refer√™ncia...</p>\r\n            </div>\r\n          ) : statusFilteredTermos.length === 0 ? (\r\n            <div className=\"text-center py-20 bg-gray-50/30\">\r\n              <FileText size={48} className=\"mx-auto text-gray-200 mb-4\" />\r\n              <p className=\"text-gray-500 font-medium\">\r\n                Nenhum termo de refer√™ncia encontrado.\r\n              </p>\r\n              <Button variant=\"outline\" size=\"sm\" className=\"mt-4\" onClick={handleNovoTR}>\r\n                Criar Primeiro TR\r\n              </Button>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              <div className=\"overflow-x-auto\">\r\n                <Table>\r\n                  <TableHeader className=\"bg-gray-50\">\r\n                    <TableRow>\r\n                      <TableHead className=\"font-bold\">N√∫mero / Objeto</TableHead>\r\n                      <TableHead className=\"font-bold\">Informa√ß√µes</TableHead>\r\n                      <TableHead className=\"font-bold\">Valor Estimado</TableHead>\r\n                      <TableHead className=\"font-bold\">Status</TableHead>\r\n                      <TableHead className=\"font-bold text-right\">A√ß√µes</TableHead>\r\n                    </TableRow>\r\n                  </TableHeader>\r\n                  <TableBody>\r\n                    {paginatedTermos.map((termo) => (\r\n                      <TableRow key={termo.id} className=\"hover:bg-gray-50/50\">\r\n                        <TableCell className=\"max-w-md\">\r\n                          <div className=\"font-bold text-blue-600 text-sm mb-1\">{termo.numero_tr || 'S/N'}</div>\r\n                          <div className=\"text-sm font-medium text-gray-900 line-clamp-2\">{termo.objeto}</div>\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <div className=\"flex flex-col space-y-1 text-xs text-gray-500\">\r\n                            <div className=\"flex items-center\">\r\n                              <Calendar size={12} className=\"mr-1\" />\r\n                              <span>{formatDate(termo.created_at)}</span>\r\n                            </div>\r\n                            <div className=\"flex items-center uppercase font-bold text-[10px]\">\r\n                              {termo.tipo || 'TR COMUM'}\r\n                            </div>\r\n                          </div>\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          <div className=\"font-bold text-gray-900 border-l-4 border-green-500 pl-2 py-1\">\r\n                            {formatCurrency(termo.valor_estimado)}\r\n                          </div>\r\n                        </TableCell>\r\n                        <TableCell>\r\n                          {getStatusBadge(termo.status)}\r\n                        </TableCell>\r\n                        <TableCell className=\"text-right\">\r\n                          <div className=\"flex items-center justify-end space-x-2\">\r\n                            <Button\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              onClick={() => handleViewTR(termo)}\r\n                              className=\"h-8 w-8 p-0\"\r\n                              title=\"Visualizar\"\r\n                            >\r\n                              <Eye size={16} className=\"text-gray-500\" />\r\n                            </Button>\r\n                            {(termo.status === 'Em Elabora√ß√£o' || termo.status === 'Rascunho') ? (\r\n                              <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleEditTR(termo)}\r\n                                className=\"h-8 w-8 p-0\"\r\n                                title=\"Editar\"\r\n                              >\r\n                                <Edit size={16} className=\"text-orange-600\" />\r\n                              </Button>\r\n                            ) : (\r\n                              <Button\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                onClick={() => handleDownloadTR(termo)}\r\n                                className=\"h-8 w-8 p-0\"\r\n                                title=\"Download PDF\"\r\n                              >\r\n                                <Download size={16} className=\"text-green-600\" />\r\n                              </Button>\r\n                            )}\r\n                          </div>\r\n                        </TableCell>\r\n                      </TableRow>\r\n                    ))}\r\n                  </TableBody>\r\n                </Table>\r\n              </div>\r\n\r\n              {/* Enhanced Pagination */}\r\n              {totalPages > 1 && (\r\n                <div className=\"py-4 border-t px-6 flex items-center justify-between bg-white\">\r\n                  <p className=\"text-xs text-gray-500\">\r\n                    Mostrando {startIndex + 1} a {Math.min(startIndex + itemsPerPage, statusFilteredTermos.length)} de {statusFilteredTermos.length} registros\r\n                  </p>\r\n                  <Pagination className=\"w-auto\">\r\n                    <PaginationContent>\r\n                      <PaginationItem>\r\n                        <PaginationPrevious\r\n                          onClick={() => handlePageChange(Math.max(1, currentPage - 1))}\r\n                          className={currentPage === 1 ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                        />\r\n                      </PaginationItem>\r\n\r\n                      {Array.from({ length: totalPages }, (_, i) => i + 1).map((page) => (\r\n                        <PaginationItem key={page} className=\"hidden md:block\">\r\n                          <PaginationLink\r\n                            onClick={() => handlePageChange(page)}\r\n                            isActive={currentPage === page}\r\n                            className=\"cursor-pointer\"\r\n                          >\r\n                            {page}\r\n                          </PaginationLink>\r\n                        </PaginationItem>\r\n                      ))}\r\n\r\n                      <PaginationItem>\r\n                        <PaginationNext\r\n                          onClick={() => handlePageChange(Math.min(totalPages, currentPage + 1))}\r\n                          className={currentPage === totalPages ? 'pointer-events-none opacity-50' : 'cursor-pointer'}\r\n                        />\r\n                      </PaginationItem>\r\n                    </PaginationContent>\r\n                  </Pagination>\r\n                </div>\r\n              )}\r\n            </>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Modal de sele√ß√£o de origem */}\r\n      <TRSelectionModal\r\n        open={showSelectionModal}\r\n        onClose={handleCloseSelectionModal}\r\n        onOriginSelected={handleOriginSelected}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TermoReferencia;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\services\\etpService.ts","messages":[{"ruleId":"prefer-const","severity":2,"message":"'query' is never reassigned. Use 'const' instead.","line":9,"column":13,"nodeType":"Identifier","messageId":"useConst","endLine":9,"endColumn":18,"fix":{"range":[257,483],"text":"const query = supabase\r\n            .from('etp')\r\n            .select(`\r\n        *,\r\n        etp_dfd (\r\n          dfd (\r\n            valor_estimado_total\r\n          )\r\n        )\r\n      `)\r\n            .eq('status', 'Conclu√≠do');"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1057,1060],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1057,1060],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { supabase } from '@/lib/supabase';\r\nimport { DbETP } from '@/types/database';\r\n\r\nexport const etpService = {\r\n    /**\r\n     * Busca ETPs conclu√≠dos para sele√ß√£o no Mapa de Riscos\r\n     */\r\n    async fetchConcluidos(prefeituraId?: string) {\r\n        let query = supabase\r\n            .from('etp')\r\n            .select(`\r\n        *,\r\n        etp_dfd (\r\n          dfd (\r\n            valor_estimado_total\r\n          )\r\n        )\r\n      `)\r\n            .eq('status', 'Conclu√≠do');\r\n\r\n        if (prefeituraId) {\r\n            // Assumindo que ETP tem prefeitura_id ou passamos via created_by filter se necess√°rio\r\n            // Por enquanto, filtros por prefeitura_id se a coluna existir\r\n            // Se n√£o existir, buscamos todos do contexto (etp table costuma ter prefeitura_id em sistemas multi-tenant)\r\n        }\r\n\r\n        const { data, error } = await query.order('created_at', { ascending: false });\r\n\r\n        if (error) throw error;\r\n\r\n        return data.map(etp => {\r\n            const totalValue = etp.etp_dfd?.reduce((acc: number, item: any) => {\r\n                return acc + (item.dfd?.valor_estimado_total || 0);\r\n            }, 0) || 0;\r\n\r\n            return {\r\n                id: etp.id,\r\n                titulo: etp.descricao_demanda?.substring(0, 50) + '...' || 'ETP sem t√≠tulo',\r\n                numeroETP: etp.numero_etp || 'N/A',\r\n                secretaria: etp.secretaria || 'N√£o informada',\r\n                dataCriacao: etp.created_at,\r\n                valorTotal: new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(totalValue),\r\n                descricaoDemanda: etp.descricao_demanda || '',\r\n                status: etp.status\r\n            };\r\n        });\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\services\\mapaRiscosService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[602,605],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[602,605],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from '@/lib/supabase';\r\nimport { DbMapaRiscos, DbMapaRiscosItem } from '@/types/database';\r\n\r\nexport const mapaRiscosService = {\r\n    async fetchMapasRiscos(prefeituraId?: string) {\r\n        let query = supabase\r\n            .from('mapa_riscos')\r\n            .select('*, mapa_riscos_itens(count)')\r\n            .order('created_at', { ascending: false });\r\n\r\n        if (prefeituraId) {\r\n            query = query.eq('prefeitura_id', prefeituraId);\r\n        }\r\n\r\n        const { data, error } = await query;\r\n        if (error) throw error;\r\n\r\n        return (data || []).map((mapa: any) => ({\r\n            ...mapa,\r\n            totalRiscos: mapa.mapa_riscos_itens?.[0]?.count || 0,\r\n        }));\r\n    },\r\n\r\n    async fetchMapaRisco(id: string) {\r\n        const { data, error } = await supabase\r\n            .from('mapa_riscos')\r\n            .select('*, mapa_riscos_itens(*)')\r\n            .eq('id', id)\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    async createMapaRiscos(mapa: Omit<DbMapaRiscos, 'id' | 'created_at' | 'updated_at'>, itens?: Omit<DbMapaRiscosItem, 'id' | 'mapa_riscos_id'>[]) {\r\n        const { data: mapaData, error: mapaError } = await supabase\r\n            .from('mapa_riscos')\r\n            .insert({\r\n                titulo: mapa.titulo,\r\n                etp_id: mapa.etp_id,\r\n                etp_numero: mapa.etp_numero,\r\n                etp_titulo: mapa.etp_titulo,\r\n                secretaria: mapa.secretaria,\r\n                status: mapa.status || 'elaboracao',\r\n                created_by: mapa.created_by,\r\n                prefeitura_id: mapa.prefeitura_id,\r\n            })\r\n            .select()\r\n            .single();\r\n\r\n        if (mapaError) throw mapaError;\r\n\r\n        if (itens && itens.length > 0) {\r\n            const itensWithMapaId = itens.map(item => ({\r\n                ...item,\r\n                mapa_riscos_id: mapaData.id,\r\n            }));\r\n\r\n            const { error: itensError } = await supabase\r\n                .from('mapa_riscos_itens')\r\n                .insert(itensWithMapaId);\r\n\r\n            if (itensError) {\r\n                // Rollback: delete the mapa if items failed\r\n                await supabase.from('mapa_riscos').delete().eq('id', mapaData.id);\r\n                throw itensError;\r\n            }\r\n        }\r\n\r\n        return mapaData;\r\n    },\r\n\r\n    async updateMapaRiscos(id: string, data: Partial<DbMapaRiscos>) {\r\n        const { error } = await supabase\r\n            .from('mapa_riscos')\r\n            .update({ ...data, updated_at: new Date().toISOString() })\r\n            .eq('id', id);\r\n\r\n        if (error) throw error;\r\n    },\r\n\r\n    async addRiscoItem(mapaId: string, item: Omit<DbMapaRiscosItem, 'id' | 'mapa_riscos_id'>) {\r\n        const { data, error } = await supabase\r\n            .from('mapa_riscos_itens')\r\n            .insert({ ...item, mapa_riscos_id: mapaId })\r\n            .select()\r\n            .single();\r\n\r\n        if (error) throw error;\r\n        return data;\r\n    },\r\n\r\n    async updateRiscoItem(id: string, data: Partial<DbMapaRiscosItem>) {\r\n        const { error } = await supabase\r\n            .from('mapa_riscos_itens')\r\n            .update(data)\r\n            .eq('id', id);\r\n\r\n        if (error) throw error;\r\n    },\r\n\r\n    async deleteRiscoItem(id: string) {\r\n        const { error } = await supabase\r\n            .from('mapa_riscos_itens')\r\n            .delete()\r\n            .eq('id', id);\r\n\r\n        if (error) throw error;\r\n    },\r\n\r\n    async deleteMapaRiscos(id: string) {\r\n        const { error } = await supabase\r\n            .from('mapa_riscos')\r\n            .delete()\r\n            .eq('id', id);\r\n\r\n        if (error) throw error;\r\n    },\r\n\r\n    async finalizeMapaRiscos(id: string) {\r\n        const { error } = await supabase\r\n            .from('mapa_riscos')\r\n            .update({ status: 'concluido', updated_at: new Date().toISOString() })\r\n            .eq('id', id);\r\n\r\n        if (error) throw error;\r\n    },\r\n\r\n    async getCountsByStatus(prefeituraId?: string) {\r\n        let queryConcluidos = supabase\r\n            .from('mapa_riscos')\r\n            .select('id', { count: 'exact', head: true })\r\n            .eq('status', 'concluido');\r\n\r\n        let queryElaboracao = supabase\r\n            .from('mapa_riscos')\r\n            .select('id', { count: 'exact', head: true })\r\n            .eq('status', 'elaboracao');\r\n\r\n        if (prefeituraId) {\r\n            queryConcluidos = queryConcluidos.eq('prefeitura_id', prefeituraId);\r\n            queryElaboracao = queryElaboracao.eq('prefeitura_id', prefeituraId);\r\n        }\r\n\r\n        const [concluidos, elaboracao] = await Promise.all([queryConcluidos, queryElaboracao]);\r\n\r\n        return {\r\n            concluidos: concluidos.count || 0,\r\n            elaboracao: elaboracao.count || 0,\r\n            total: (concluidos.count || 0) + (elaboracao.count || 0),\r\n        };\r\n    },\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\services\\referenciaService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[236,239],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[236,239],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { externalSupabase } from '@/lib/externalSupabase';\r\n\r\nexport interface ReferenciaItem {\r\n    id: string;\r\n    codigo: string;\r\n    descricao: string;\r\n    unidade: string;\r\n    valor: number;\r\n    fonte: string;\r\n    detalhes?: any;\r\n}\r\n\r\nexport const referenciaService = {\r\n    async searchPNCP(term: string): Promise<ReferenciaItem[]> {\r\n        const { data, error } = await externalSupabase\r\n            .from('referencia_pncp')\r\n            .select('*')\r\n            .or(`item_nome.ilike.%${term}%,municipio.ilike.%${term}%`)\r\n            .limit(20);\r\n\r\n        if (error) throw error;\r\n\r\n        return (data || []).map(item => ({\r\n            id: item.id,\r\n            codigo: item.sequencial_compra?.toString() || item.id.substring(0, 8),\r\n            descricao: item.item_nome,\r\n            unidade: item.unidade || 'Unidade',\r\n            valor: parseFloat(item.valor_unitario) || 0,\r\n            fonte: 'PNCP',\r\n            detalhes: item\r\n        }));\r\n    },\r\n\r\n    async searchSINAPI(term: string): Promise<ReferenciaItem[]> {\r\n        const { data, error } = await externalSupabase\r\n            .from('referencia_sinapi')\r\n            .select('*')\r\n            .ilike('descricao', `%${term}%`)\r\n            .limit(20);\r\n\r\n        if (error) throw error;\r\n\r\n        return (data || []).map(item => ({\r\n            id: item.id,\r\n            codigo: item.codigo,\r\n            descricao: item.descricao,\r\n            unidade: item.unidade || 'M2',\r\n            valor: parseFloat(item.preco_base) || 0,\r\n            fonte: 'SINAPI',\r\n            detalhes: item\r\n        }));\r\n    },\r\n\r\n    async searchCMED(term: string): Promise<ReferenciaItem[]> {\r\n        const { data, error } = await externalSupabase\r\n            .from('referencia_cmed')\r\n            .select('*')\r\n            .or(`produto.ilike.%${term}%,substancia.ilike.%${term}%`)\r\n            .limit(20);\r\n\r\n        if (error) throw error;\r\n\r\n        return (data || []).map(item => ({\r\n            id: item.id,\r\n            codigo: item.ean || 'N/A',\r\n            descricao: `${item.substancia} - ${item.produto}`,\r\n            unidade: 'Unidade',\r\n            valor: parseFloat(item.pmvg) || 0,\r\n            fonte: 'CMED',\r\n            detalhes: item\r\n        }));\r\n    },\r\n\r\n    async searchCATSER(term: string): Promise<ReferenciaItem[]> {\r\n        const { data, error } = await externalSupabase\r\n            .from('referencia_catser')\r\n            .select('*')\r\n            .ilike('descricao', `%${term}%`)\r\n            .limit(20);\r\n\r\n        if (error) throw error;\r\n\r\n        return (data || []).map(item => ({\r\n            id: item.id,\r\n            codigo: item.codigo,\r\n            descricao: item.descricao,\r\n            unidade: 'N/A',\r\n            valor: 0,\r\n            fonte: 'CATSER',\r\n            detalhes: item\r\n        }));\r\n    },\r\n\r\n    async searchAll(term: string, tab: string): Promise<ReferenciaItem[]> {\r\n        switch (tab) {\r\n            case 'PNCP': return this.searchPNCP(term);\r\n            case 'SINAPI': return this.searchSINAPI(term);\r\n            case 'CMED': return this.searchCMED(term);\r\n            case 'CATSER': return this.searchCATSER(term);\r\n            case 'BPS': return this.searchCATSER(term); // Usando CATSER como fallback se BPS n√£o tiver tabela espec√≠fica\r\n            default: return [];\r\n        }\r\n    }\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\services\\systemConfigService.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1556,1559],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1556,1559],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { supabase } from '@/lib/supabase';\r\n\r\nexport const systemConfigService = {\r\n    async getConfig(chave: string, prefeituraId?: string) {\r\n        let query = supabase\r\n            .from('system_config')\r\n            .select('*')\r\n            .eq('chave', chave);\r\n\r\n        if (prefeituraId) {\r\n            query = query.eq('prefeitura_id', prefeituraId);\r\n        } else {\r\n            query = query.is('prefeitura_id', null);\r\n        }\r\n\r\n        const { data, error } = await query.maybeSingle();\r\n        if (error) throw error;\r\n        return data?.valor || null;\r\n    },\r\n\r\n    async setConfig(chave: string, valor: string, prefeituraId?: string | null) {\r\n        const { error } = await supabase\r\n            .from('system_config')\r\n            .upsert(\r\n                {\r\n                    chave,\r\n                    valor,\r\n                    prefeitura_id: prefeituraId || null,\r\n                    updated_at: new Date().toISOString(),\r\n                },\r\n                { onConflict: 'chave,prefeitura_id' }\r\n            );\r\n\r\n        if (error) throw error;\r\n    },\r\n\r\n    async getAllConfigs(prefeituraId?: string) {\r\n        let query = supabase\r\n            .from('system_config')\r\n            .select('*');\r\n\r\n        if (prefeituraId) {\r\n            query = query.eq('prefeitura_id', prefeituraId);\r\n        }\r\n\r\n        const { data, error } = await query;\r\n        if (error) throw error;\r\n\r\n        // Convert to key-value map\r\n        const configs: Record<string, string> = {};\r\n        (data || []).forEach((item: any) => {\r\n            configs[item.chave] = item.valor;\r\n        });\r\n        return configs;\r\n    },\r\n\r\n    async deleteConfig(chave: string, prefeituraId?: string) {\r\n        let query = supabase\r\n            .from('system_config')\r\n            .delete()\r\n            .eq('chave', chave);\r\n\r\n        if (prefeituraId) {\r\n            query = query.eq('prefeitura_id', prefeituraId);\r\n        }\r\n\r\n        const { error } = await query;\r\n        if (error) throw error;\r\n    },\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\types\\database.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":181,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4773,4776],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4773,4776],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":200,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5330,5333],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5330,5333],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":218,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":218,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5723,5726],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5723,5726],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport { ModulePermissions, UserRole } from './auth';\r\n\r\n// Tabela: usuarios_acesso\r\nexport interface DbUser {\r\n    id: string; // uuid\r\n    created_at: string; // timestamp with time zone\r\n    email: string;\r\n    senha?: string;\r\n    nome: string;\r\n    tipo_perfil: UserRole;\r\n    prefeitura_id: string | null;\r\n    secretaria_id: string | null;\r\n    modulos_acesso: ModulePermissions;\r\n    status: 'ativo' | 'inativo';\r\n    // Novos campos\r\n    telefone?: string | null;\r\n    cpf?: string | null;\r\n    matricula?: string | null;\r\n    cargo_funcional?: string | null;\r\n    unidade?: string | null;\r\n}\r\n\r\n// Tabela: prefeituras\r\nexport interface DbPrefeitura {\r\n    id: string;\r\n    created_at: string;\r\n    nome: string;\r\n    cnpj: string;\r\n    uf: string;\r\n    municipio: string;\r\n    logo_url?: string | null;\r\n    gestor_principal?: string | null;\r\n    email?: string | null;\r\n    telefone?: string | null;\r\n    cargo?: string | null;\r\n    status: 'ativa' | 'inativa';\r\n}\r\n\r\n// Tabela: secretarias\r\nexport interface DbSecretaria {\r\n    id: string;\r\n    created_at?: string;\r\n    nome: string;\r\n    prefeitura_id: string;\r\n    // Novos campos\r\n    responsavel?: string | null;\r\n    cargo?: string | null;\r\n    email?: string | null;\r\n    telefone?: string | null;\r\n    status?: string | null;\r\n}\r\n\r\n// --- TABELAS DFD/PCA/ETP ---\r\n\r\n// Tabela: dfd\r\nexport interface DbDFD {\r\n    id: string;\r\n    created_at: string;\r\n    numero_dfd?: string;\r\n    objeto: string;\r\n    tipo_dfd: string;\r\n    descricao_sucinta?: string;\r\n    descricao_demanda?: string;\r\n    justificativa?: string;\r\n    justificativa_quantidade?: string;\r\n    data_prevista_contratacao?: string;\r\n    prioridade?: 'Baixo' | 'M√©dio' | 'Alto';\r\n    justificativa_prioridade?: string;\r\n    status: 'Rascunho' | 'Pendente' | 'Aprovado' | 'Reprovado' | 'Cancelado';\r\n    ano_contratacao: number;\r\n    valor_estimado_total: number;\r\n    created_by?: string;\r\n    secretaria_id?: string;\r\n    prefeitura_id?: string;\r\n    solicitacao_cancelamento?: boolean;\r\n    justificativa_cancelamento?: string;\r\n}\r\n\r\n// Tabela: dfd_items\r\nexport interface DbDFDItem {\r\n    id: string;\r\n    dfd_id: string;\r\n    codigo_item?: string;\r\n    descricao_item: string;\r\n    unidade?: string;\r\n    quantidade: number;\r\n    valor_unitario?: number;\r\n    valor_total: number;\r\n    tabela_referencia?: string;\r\n}\r\n\r\n// Tabela: pca_config\r\nexport interface DbPCAConfig {\r\n    id: string;\r\n    ano: number;\r\n    prefeitura_id?: string;\r\n    status: 'Rascunho' | 'Publicado';\r\n    data_publicacao?: string;\r\n    publicado_por?: string;\r\n    created_at: string;\r\n}\r\n\r\n// Tabela: etp\r\nexport interface DbETP {\r\n    id: string;\r\n    created_at: string;\r\n    numero_etp?: string;\r\n    status: 'Em Elabora√ß√£o' | 'Conclu√≠do';\r\n    descricao_demanda?: string;\r\n    requisitos_contratacao?: string;\r\n    alternativas_existem?: boolean;\r\n    alternativas_descricao?: string;\r\n    descricao_solucao?: string;\r\n    justificativa_parcelamento?: string;\r\n    resultados_pretendidos?: string;\r\n    providencias_existem?: boolean;\r\n    providencias_descricao?: string;\r\n    contratacoes_correlatas?: boolean;\r\n    contratacoes_descricao?: string;\r\n    impactos_ambientais?: boolean;\r\n    impactos_descricao?: string;\r\n    observacoes_gerais?: string;\r\n    conclusao_tecnica?: string;\r\n    created_by?: string;\r\n    prefeitura_id?: string;\r\n}\r\n\r\n// Tabela: etp_dfd (Jun√ß√£o)\r\nexport interface DbETPDFD {\r\n    etp_id: string;\r\n    dfd_id: string;\r\n}\r\n\r\n// --- NOVAS TABELAS ---\r\n\r\n// Tabela: mapa_riscos\r\nexport interface DbMapaRiscos {\r\n    id: string;\r\n    etp_id?: string | null;\r\n    titulo: string;\r\n    etp_numero?: string | null;\r\n    etp_titulo?: string | null;\r\n    secretaria?: string | null;\r\n    status: 'elaboracao' | 'concluido';\r\n    created_by?: string | null;\r\n    prefeitura_id?: string | null;\r\n    created_at: string;\r\n    updated_at: string;\r\n    // Campos computados (join)\r\n    mapa_riscos_itens?: DbMapaRiscosItem[];\r\n}\r\n\r\n// Tabela: mapa_riscos_itens\r\nexport interface DbMapaRiscosItem {\r\n    id: string;\r\n    mapa_riscos_id: string;\r\n    categoria: string;\r\n    descricao: string;\r\n    causa_provavel?: string | null;\r\n    consequencia?: string | null;\r\n    probabilidade: string;\r\n    impacto: string;\r\n    nivel: string;\r\n    mitigacao: string;\r\n    plano_contingencia?: string | null;\r\n    responsavel?: string | null;\r\n}\r\n\r\n// Tabela: termos_referencia\r\nexport interface DbTermoReferencia {\r\n    id: string;\r\n    numero_tr?: string | null;\r\n    etp_id?: string | null;\r\n    objeto: string;\r\n    status: 'Rascunho' | 'Em Elabora√ß√£o' | 'Em Revis√£o' | 'Conclu√≠do' | 'Publicado';\r\n    tipo?: string | null;\r\n    valor_estimado: number;\r\n    secretaria_id?: string | null;\r\n    prefeitura_id?: string | null;\r\n    dados_json?: any;\r\n    created_by?: string | null;\r\n    created_at: string;\r\n    updated_at: string;\r\n}\r\n\r\n// Tabela: editais\r\nexport interface DbEdital {\r\n    id: string;\r\n    numero_edital?: string | null;\r\n    tr_id?: string | null;\r\n    objeto: string;\r\n    status: 'Rascunho' | 'Em Elabora√ß√£o' | 'Em Revis√£o' | 'Conclu√≠do' | 'Publicado';\r\n    modalidade?: string | null;\r\n    tipo_licitacao?: string | null;\r\n    valor_estimado: number;\r\n    data_publicacao?: string | null;\r\n    secretaria_id?: string | null;\r\n    prefeitura_id?: string | null;\r\n    dados_json?: any;\r\n    created_by?: string | null;\r\n    created_at: string;\r\n    updated_at: string;\r\n}\r\n\r\n// Tabela: system_config\r\nexport interface DbSystemConfig {\r\n    id: string;\r\n    chave: string;\r\n    valor?: string | null;\r\n    prefeitura_id?: string | null;\r\n    updated_at: string;\r\n}\r\n\r\n// Helper para respostas do Supabase\r\nexport type SupabaseResponse<T> = {\r\n    data: T | null;\r\n    error: any | null;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\freir\\OneDrive\\√Årea de Trabalho\\Sistemas 2026\\PreparaGov\\src\\utils\\pcaConsolidation.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":96,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2762,2765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2762,2765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\ninterface DFDItem {\r\n  id: string;\r\n  descricao: string;\r\n  quantidade: number;\r\n  valor: number;\r\n  unidadeMedida: string;\r\n  detalhamentoTecnico?: string;\r\n  secretaria: string;\r\n  prioridade: 'Alta' | 'M√©dia' | 'Baixa';\r\n  dataContratacao: string;\r\n  dfdId: string;\r\n  tipoDFD: string;\r\n}\r\n\r\ninterface ConsolidatedItemByType {\r\n  id: string;\r\n  descricao: string;\r\n  unidadeMedida: string;\r\n  detalhamentoTecnico?: string;\r\n  quantidadeTotal: number;\r\n  valorTotal: number;\r\n  dataContratacaoOficial: string;\r\n  prioridadeOficial: 'Alta' | 'M√©dia' | 'Baixa';\r\n  tipoDFD: string;\r\n  secretarias: Record<string, {\r\n    quantidade: number;\r\n    valor: number;\r\n    prioridade: 'Alta' | 'M√©dia' | 'Baixa';\r\n    dataInformada: string;\r\n    dfdId: string;\r\n  }>;\r\n}\r\n\r\ninterface ConsolidatedItem {\r\n  id: string;\r\n  descricao: string;\r\n  unidadeMedida: string;\r\n  detalhamentoTecnico?: string;\r\n  quantidadeTotal: number;\r\n  valorTotal: number;\r\n  dataContratacaoOficial: string;\r\n  prioridadeOficial: 'Alta' | 'M√©dia' | 'Baixa';\r\n  secretarias: {\r\n    nome: string;\r\n    quantidade: number;\r\n    valor: number;\r\n    prioridade: 'Alta' | 'M√©dia' | 'Baixa';\r\n    dataInformada: string;\r\n    dfdId: string;\r\n  }[];\r\n}\r\n\r\nconst PRIORIDADE_PESO = {\r\n  'Alta': 3,\r\n  'M√©dia': 2,\r\n  'Baixa': 1\r\n};\r\n\r\nexport const consolidateItemsByType = (items: DFDItem[]): Record<string, ConsolidatedItemByType[]> => {\r\n  const grouped = new Map<string, DFDItem[]>();\r\n\r\n  // Agrupar itens por chave √∫nica (descri√ß√£o + unidade + detalhamento + tipo)\r\n  items.forEach(item => {\r\n    const key = `${item.descricao.toLowerCase().trim()}_${item.unidadeMedida.toLowerCase().trim()}_${item.detalhamentoTecnico?.toLowerCase().trim() || ''}_${item.tipoDFD}`;\r\n    \r\n    if (!grouped.has(key)) {\r\n      grouped.set(key, []);\r\n    }\r\n    grouped.get(key)!.push(item);\r\n  });\r\n\r\n  // Consolidar cada grupo\r\n  const consolidated = Array.from(grouped.entries()).map(([key, groupItems]) => {\r\n    const firstItem = groupItems[0];\r\n    \r\n    // Calcular totais\r\n    const quantidadeTotal = groupItems.reduce((sum, item) => sum + item.quantidade, 0);\r\n    const valorTotal = groupItems.reduce((sum, item) => sum + item.valor, 0);\r\n    \r\n    // Encontrar data mais pr√≥xima\r\n    const dataContratacaoOficial = groupItems\r\n      .map(item => item.dataContratacao)\r\n      .sort()[0]; // Primeira data cronologicamente\r\n    \r\n    // Encontrar maior prioridade\r\n    const prioridadeOficial = groupItems\r\n      .reduce((maxPrior, item) => \r\n        PRIORIDADE_PESO[item.prioridade] > PRIORIDADE_PESO[maxPrior] \r\n          ? item.prioridade \r\n          : maxPrior, \r\n        'Baixa' as 'Alta' | 'M√©dia' | 'Baixa'\r\n      );\r\n    \r\n    // Mapear secretarias como Record\r\n    const secretarias: Record<string, any> = {};\r\n    groupItems.forEach(item => {\r\n      secretarias[item.secretaria] = {\r\n        quantidade: item.quantidade,\r\n        valor: item.valor,\r\n        prioridade: item.prioridade,\r\n        dataInformada: item.dataContratacao,\r\n        dfdId: item.dfdId\r\n      };\r\n    });\r\n\r\n    return {\r\n      id: key,\r\n      descricao: firstItem.descricao,\r\n      unidadeMedida: firstItem.unidadeMedida,\r\n      detalhamentoTecnico: firstItem.detalhamentoTecnico,\r\n      quantidadeTotal,\r\n      valorTotal,\r\n      dataContratacaoOficial,\r\n      prioridadeOficial,\r\n      tipoDFD: firstItem.tipoDFD,\r\n      secretarias\r\n    };\r\n  });\r\n\r\n  // Agrupar por tipo de DFD\r\n  const groupedByType: Record<string, ConsolidatedItemByType[]> = {};\r\n  consolidated.forEach(item => {\r\n    if (!groupedByType[item.tipoDFD]) {\r\n      groupedByType[item.tipoDFD] = [];\r\n    }\r\n    groupedByType[item.tipoDFD].push(item);\r\n  });\r\n\r\n  return groupedByType;\r\n};\r\n\r\nexport const consolidateItems = (items: DFDItem[]): ConsolidatedItem[] => {\r\n  const grouped = new Map<string, DFDItem[]>();\r\n\r\n  // Agrupar itens por chave √∫nica (descri√ß√£o + unidade + detalhamento)\r\n  items.forEach(item => {\r\n    const key = `${item.descricao.toLowerCase().trim()}_${item.unidadeMedida.toLowerCase().trim()}_${item.detalhamentoTecnico?.toLowerCase().trim() || ''}`;\r\n    \r\n    if (!grouped.has(key)) {\r\n      grouped.set(key, []);\r\n    }\r\n    grouped.get(key)!.push(item);\r\n  });\r\n\r\n  // Consolidar cada grupo\r\n  return Array.from(grouped.entries()).map(([key, groupItems]) => {\r\n    const firstItem = groupItems[0];\r\n    \r\n    // Calcular totais\r\n    const quantidadeTotal = groupItems.reduce((sum, item) => sum + item.quantidade, 0);\r\n    const valorTotal = groupItems.reduce((sum, item) => sum + item.valor, 0);\r\n    \r\n    // Encontrar data mais pr√≥xima\r\n    const dataContratacaoOficial = groupItems\r\n      .map(item => item.dataContratacao)\r\n      .sort()[0]; // Primeira data cronologicamente\r\n    \r\n    // Encontrar maior prioridade\r\n    const prioridadeOficial = groupItems\r\n      .reduce((maxPrior, item) => \r\n        PRIORIDADE_PESO[item.prioridade] > PRIORIDADE_PESO[maxPrior] \r\n          ? item.prioridade \r\n          : maxPrior, \r\n        'Baixa' as 'Alta' | 'M√©dia' | 'Baixa'\r\n      );\r\n    \r\n    // Mapear secretarias\r\n    const secretarias = groupItems.map(item => ({\r\n      nome: item.secretaria,\r\n      quantidade: item.quantidade,\r\n      valor: item.valor,\r\n      prioridade: item.prioridade,\r\n      dataInformada: item.dataContratacao,\r\n      dfdId: item.dfdId\r\n    }));\r\n\r\n    return {\r\n      id: key,\r\n      descricao: firstItem.descricao,\r\n      unidadeMedida: firstItem.unidadeMedida,\r\n      detalhamentoTecnico: firstItem.detalhamentoTecnico,\r\n      quantidadeTotal,\r\n      valorTotal,\r\n      dataContratacaoOficial,\r\n      prioridadeOficial,\r\n      secretarias\r\n    };\r\n  });\r\n};\r\n\r\nexport const getAllSecretarias = (itemsByType: Record<string, ConsolidatedItemByType[]>): string[] => {\r\n  const secretariasSet = new Set<string>();\r\n  \r\n  Object.values(itemsByType).forEach(items => {\r\n    items.forEach(item => {\r\n      Object.keys(item.secretarias).forEach(secretaria => {\r\n        secretariasSet.add(secretaria);\r\n      });\r\n    });\r\n  });\r\n  \r\n  return Array.from(secretariasSet).sort();\r\n};\r\n\r\nexport const formatCurrency = (value: number): string => {\r\n  return new Intl.NumberFormat('pt-BR', {\r\n    style: 'currency',\r\n    currency: 'BRL'\r\n  }).format(value);\r\n};\r\n\r\nexport const formatDate = (dateString: string): string => {\r\n  return new Date(dateString).toLocaleDateString('pt-BR');\r\n};\r\n\r\nexport const getPriorityColor = (priority: string): string => {\r\n  switch (priority) {\r\n    case 'Alta':\r\n      return 'bg-red-100 text-red-800';\r\n    case 'M√©dia':\r\n      return 'bg-yellow-100 text-yellow-800';\r\n    case 'Baixa':\r\n      return 'bg-green-100 text-green-800';\r\n    default:\r\n      return 'bg-gray-100 text-gray-800';\r\n  }\r\n};\r\n","usedDeprecatedRules":[]}]